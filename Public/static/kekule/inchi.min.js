(function(){var c=Kekule.EmscriptenUtils;var a={usingModulaize:true,moduleName:"InChIModule"};Kekule.InChI={_autoEnabled:true,_scriptLoadedBySelf:false,_module:null,_enableFuncs:[],SCRIPT_FILE:"inchi.js",isScriptLoaded:function(){return c.isSupported(a.moduleName)},getModule:function(){if(!b._module){b._module=c.getRootModule(a.moduleName)}return b._module},getInChIPath:function(){var e=Kekule.scriptSrcInfo.useMinFile;var d=e?"extra/":"_extras/InChI/";d=Kekule.scriptSrcInfo.path+d;return d},getInChIScriptUrl:function(){var d=b.getInChIPath()+b.SCRIPT_FILE;var e=Kekule.scriptSrcInfo.useMinFile;if(!e){d+=".dev"}return d},loadInChIScript:function(e,f){if(!e){e=document}if(!b.isScriptLoaded()&&!b._scriptLoadedBySelf){var d=b.getInChIScriptUrl();c.loadScript(d,f,e);b._scriptLoadedBySelf=true}else{b._scriptLoadedBySelf=true;if(f){f()}}},molDataToInChI:function(f,e){var g=b._molToInChI;if(!g){g=b.getModule().cwrap("molToInchiJson","string",["string","string"])}var d=g(f,e);return JSON.parse(d)},getInChIInfo:function(d){var e=Kekule.IO.saveFormatData(d,Kekule.IO.DataFormat.MOL);var f=b.molDataToInChI(e);return f},enable:function(d){if(!b.isScriptLoaded()){b.loadInChIScript(document,function(){b._enableAllFunctions();if(d){d()}})}else{b._enableAllFunctions();if(d){d()}}},_enableAllFunctions:function(){if(b.isScriptLoaded()){var e=b._enableFuncs;for(var f=0,d=e.length;f<d;++f){var g=e[f];if(g){g()}}}}};var b=Kekule.InChI;Kekule.IO.InChIWriter=Class.create(Kekule.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.InChIWriter",doWriteData:function(h,e,g){var f=b.getInChIInfo(h);if(f&&f.inchi){var d=f.inchi;if(f.auxInfo){d+="\n"+f.auxInfo}return d}else{return null}},isAllowedObj:function(e){var d=Kekule.IO.InChIWriter.ALLOWED_CLASSES;return Kekule.ObjUtils.isInstanceOf(e,d)}});Kekule.IO.InChIWriter.ALLOWED_CLASSES=[Kekule.StructureFragment,Kekule.Reaction,Kekule.ChemObjList,Kekule.ChemStructureObjectGroup,Kekule.ChemSpaceElement,Kekule.ChemSpace];Kekule.IO.registerAllInChIFormats=function(){if(b.isScriptLoaded()){var d="inchi";Kekule.IO.DataFormat.INCHI=d;Kekule.IO.MimeType.INCHI="chemical/x-inchi";Kekule.IO.DataFormatsManager.register(d,Kekule.IO.MimeType.INCHI,"inchi",Kekule.IO.ChemDataType.TEXT,"InChI format");Kekule.IO.ChemDataWriterManager.register("inchi",Kekule.IO.InChIWriter,Kekule.IO.InChIWriter.ALLOWED_CLASSES,d)}};Kekule.IO.enableInChIFormats=function(){b.enable()};b._enableFuncs.push(Kekule.IO.registerAllInChIFormats);Kekule._registerAfterLoadProc(function(){if(b._autoEnabled){b._enableAllFunctions()}})})();