<!doctype html>
<!-- The DOCTYPE declaration above will set the     -->
<!-- browser's rendering engine into                -->
<!-- "Standards Mode". Replacing this declaration   -->
<!-- with a "Quirks Mode" doctype is not supported. -->

<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<link rel="icon" type="image/png" sizes="32x32" href="https://dl.dropboxusercontent.com/s/r0gjpgxp8byjbzr/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="https://dl.dropboxusercontent.com/s/k0kyp30ale2pkod/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://dl.dropboxusercontent.com/s/0l0w2wk9wfxt4el/favicon-16x16.png">

<title>Tiny Arrows</title>

<!-- Alternative location for ace editor -->
<!-- script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.3.1/ace.js" type="text/javascript" charset="utf-8"></script> -->
<!--script src="https://unpkg.com/ace-builds@1.3.1/src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script-->


<!-- Location scripts for jexcel spreasheet -->
<!--script src="https://bossanova.uk/jexcel/v3/jexcel.js"></script-->
<!--script src="https://bossanova.uk/jsuites/v2/jsuites.js"></script-->
<!--link rel="stylesheet" href="https://bossanova.uk/jexcel/v3/jexcel.css" type="text/css" /-->
<!--link rel="stylesheet" href="https://bossanova.uk/jsuites/v2/jsuites.css" type="text/css" /-->

<!--script src="{{ url_for('static', filename='jexcel/v3new/jexcel.js')}}"></script>
<script src="{{ url_for('static', filename='jexcel/v3new/jsuites.js')}}"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='jexcel/v3new/jexcel.css')}}" type="text/css" />
<link rel="stylesheet" href="{{ url_for('static', filename='jexcel/v3new/jsuites.css')}}" type="text/css" /-->

<script src="{{ url_for('static', filename='jexcel/v4/jexcel.js')}}"></script>
<script src="{{ url_for('static', filename='jexcel/v4/jsuites.js')}}"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='jexcel/v4/jexcel.css')}}" type="text/css" />
<link rel="stylesheet" href="{{ url_for('static', filename='jexcel/v4/jsuites.css')}}" type="text/css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Material+Icons" />
<!--link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='jexcel/v3/materialicons.css')}}" /-->





<!-- Location scripts for debugging and development -->
<!--script src="/static/jexcel/v3/jexcel.js"></script-->
<!--script src="/static/jexcel/v3/jsuites.js"></script-->
<!--link rel="stylesheet" href="/static/jexcel/v3/jexcel.css" type="text/css" /-->
<!--link rel="stylesheet" href="/static/jexcel/v3/jsuites.css" type="text/css" /-->
<!--link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Material+Icons" /-->



<!-- Location scripts for jsme, jsmol, and ace -->
<script type="text/javascript" language="javascript" src="{{ url_for('static', filename='jsme-latest/jsme.nocache.js')}}"></script>
<script type="text/javascript" language="javascript" src="{{ url_for('static', filename='jsmol/JSmol.min.js')}}"></script>
<script src="https://unpkg.com/ace-builds@1.4.1/src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>

<!-- Location scripts for debugging and development -->
<!--script type="text/javascript" language="javascript" src="/static/jsme/jsme.nocache.js"></script-->
<!--script type="text/javascript" language="javascript" src="/static/jsmol/JSmol.min.js"></script-->
<!--script src="https://unpkg.com/ace-builds@1.4.1/src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script-->



<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
   blink, .blink {
   animation: blinker 1s linear infinite;
   }
   @keyframes blinker {
   50% { opacity: 0; }
   }

.linkbanner {
  position: relative;
  //display: inline-block;
  padding: 1px;
  // background-color: lightblue;
  //background-image: linear-gradient(blue,#FEFEFE,blue);
  //background-image: linear-gradient(blue,lightgreen,blue);
  background-image: linear-gradient(#4286f4,lightgreen,#4286f4);
  //background-image: linear-gradient(#4286f4,#599a3e,#4286f4);
  //background-image: linear-gradient(#2f61ce,lightgreen,#2f61ce);
  //background-image: linear-gradient(#2f61ce,gold,#2f61ce);
  //background-image: linear-gradient(#4286f4,gold,#4286f4);
  font-size: 18px;
  font-weight: bold;
  font-family: times;
  color: white;
}

</style>

<!--style>
   blink, .blink {
   animation: blinker 1s linear infinite;
   }
   @keyframes blinker {
   50% { opacity: 0; }
   }
</style-->


<style type="text/css" media="screen">
    #editor {
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
    }
   .button2 {width:110px;text-align: left;}
   .button3 {width:110px;text-align: left;}
   .button4 {width:150px;text-align: left;}

/* Style the tab */
.tab {
    //overflow: hidden;
    //border: 2px solid #ccc;
   // background-color: #f1f1f1;
   // margin: auto;

background-image: linear-gradient(#FEFEFE, #F1F1F1);
    position: relative;
    margin: auto;
    overflow: hidden;
    border-radius: 6px;
    border-color: #DEDEDE;
}

.tabBlock {
  margin: 0 0 2.5rem;
}
/* Style the buttons that are used to open the tab content */
.tab button {
    display: inline-block;
    list-style-type: none;
    background-color: inherit;
    display: block;
    position: relative;
    float: left;
    border: none;
    border-style: solid;
    border-width: 1px;
    border-color: #DEDEDE;
    outline: none;
    //outline: 2px solid #ccc;
    cursor: pointer;
    padding: 14px 16px;
    transition: 0.3s;
    font-size: 15px;
    font-weight: bold;
    font-family: times;
}


/* Change background color of buttons on hover */
.tab button:hover {
    background-color: #cfc;
}

/* Create an active/current tablink class */
.tab button.active {
    color: black;
    background-color: #add;
}

/* Style the tab content */
.tabcontent {
    display: none;
    padding: 6px 12px;
    //border: 1px solid #ccc;
    border-top: none;
}

.tabcontent {
    animation: fadeEffect 1s; /* Fading effect takes 1 second */
}

/* Go from zero to full opacity */
@keyframes fadeEffect {
    from {opacity: 0;}
    to {opacity: 1;}
}

.collapsible {
  background-color: #add;
  color: black;
  cursor: pointer;
  padding: 2px;
  width: 100%;
  text-align: center;
  outline: none;
  font-size: 15px;
  font-weight: bold;
  font-family: times;
  border-style: solid;
  border-width: 1px;
  border-color: white;
}

.active, .collapsible:hover {
  color: white;
  background-color: #4286f4;
}

.content {
  padding: 0 18px;
  display: none;
  overflow: hidden;
  background-color: white;
}


</style>


<script type="text/javascript">

	//this function will be called after the JavaScriptApplet code has been loaded.
	function jsmeOnLoad() {

		//Instantiate a new JSME: 380px  340px
		//arguments: HTML id, width, height (must be string not number!)
		//jsmeApplet = new JSApplet.JSME("appletContainer", "700px", "467px", {

		jsmeApplet = new JSApplet.JSME("appletContainer", "850px", "567px", {
			//optional parameters
			"options" : "query,hydrogens,canonize,removehs"
		});

		//Alternative method: the size is not specified: the applet will use 100% of the space of its parent container "appletContainer".
		//Be sure that the parent container size > 0, otherwise the applet will not be visible

		/*    	jsmeApplet = new JSApplet.JSME("appletContainer",  {
		 //optional parameters
		 "options" : "query,hydrogens",
		 "jme" : startingStructure
		 });
		 */

		//Opera patch: if some applet elements are not displayed, force repaint
		//jsmeApplet.deferredRepaint(); //the applet will be repainted after the browser event loop returns
		//it is recommended to use it if the JSME is created outside this jsmeOnLoad() function

		//jsmeApplet has the same API as the original Java applet
		//One can mimic the JME Java applet access to simplify the adaptation of HTML and JavaScript code:
		document.JME = jsmeApplet;

		//suggestion 
		//all buttons that access the jsme variable were disabled in the html
		//Now enable all buttons that can access the jsme variable since the applet is ready
		//example:
		//document.getElementById("button").disabled=false;

	}
        function jsmereaction() {
           jsmeApplet.options("query,hydrogens,canonize,removehs,reaction");
           //jsmeApplet.reset();
        }
        function jsmenoreaction() {
           jsmeApplet.options("query,hydrogens,canonize,removehs,noreaction");
           //jsmeApplet.reset();
        }

     delete Jmol._tracker;
     function jmolOnLoad() {
            Info = {
            width: 750,
            height: 500,
            debug: false,
            //File location for Tiny Arrows API
            j2sPath: "{{ url_for('static', filename='jsmol/j2s')}}",

            //File location for debugging and development
            //j2sPath: "/static/jsmol/j2s",
            
            //color: "0x3BBC52",
            //color: "0x3BBC52",
            //color: "0xc6ed80",
            color: "0x4286f4",
            disableJ2SLoadMonitor: true,
            disableInitialConsole: true,
            addSelectionOptions: true,

            //File location for Tiny Arrows API
            serverURL: "{{ url_for('static', filename='jsmol/jsmol.php')}}",

            //File location for debugging and development
            //serverURL: "/static/jsmol/jsmol.php",

            use: "HTML5",
            readyFunction: null,
            //script: "load  /static/jjj.xyz ; set modelKitMode "
            script: "set modelKitMode "
         };
         $("#jsmoldiv").html(Jmol.getAppletHtml("jmolApplet0", Info));
         $("#jsmolbtns").html(Jmol.jmolButton(jmolApplet0,"select *;spacefill 75%" ,"Space Fill") + Jmol.jmolButton(jmolApplet0, "select *; wireframe 0.15; spacefill 23%;","Ball and Stick") +  Jmol.jmolButton(jmolApplet0, "select *; wireframe 0.03; spacefill 1%;","Stick") ); 

         //jm_cmdlist_add();
      }

        function convertMOL2XYZ(str) {
           var i,n,x,data;
           var lines = str.split("\n");
           if (str.includes("V2000")) {
              data = lines[3].trim().split(" ")[0];
              n = eval(data);
              data += "\n\n";
              n += 4;
              for (i=4; i<n; i++) {
                 x = lines[i].trim().split(/[ ,]+/);
                 data += x[3] + " "; 
                 data += x[0] + " ";
                 data += x[1] + " ";
                 data += x[2] + "\n";
              }
           } 
           else { 
              data=str;
           }
           return data;
        } 

        function gennum(v) {
           var x;
           if (v=='') {
               x = 1.0;
           } else {
              var vv = v.split('/');
              x = parseFloat(vv[0]);
              if (vv.length>1) {
                 x = x/parseFloat(vv[1]);
              }
           }
           return x;
        }

        function opmatrix(xyzstr) {
           var xs,pp,pm,pi,sgn,i,ii,v;
           var op = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
           for (var ijk=0; ijk<3; ++ijk) {
              xs = xyzstr.split(',')[ijk]
              pp = xs.split('+');
              pm = [];
              for (i=0; i<pp.length; ++i) {
                 pm.push(pp[i].split('-'));
              }
              for (i=0; i<pm.length; ++i) {
                 pi = pm[i];
                 sgn = +1;
                 for (ii=0; ii<pi.length; ++ii) {
                    if (pi[ii].indexOf('x')!=-1) {
                       v = pi[ii].split('x')[0];
                       op[ijk] += sgn*gennum(v);
                    } else if (pi[ii].indexOf('y')!=-1) {
                       v = pi[ii].split('y')[0];
                       op[ijk+3] += sgn*gennum(v);
                    } else if (pi[ii].indexOf('z')!=-1) {
                       v = pi[ii].split('z')[0];
                       op[ijk+6] += sgn*gennum(v);
                    } else {
                       v = pi[ii];
                       if (v!='') {
                          op[ijk+9] += sgn*gennum(v);
                       }
                    }
                    sgn = -1;
                 }
              }
           }
           return op;
        }

        function compare_ops(ops1,ops2) {
           var i1,i2,m1,m2,j,msame;
           var same=false;
           if (ops1.length==ops2.length) {
              for (i1=0; i1<ops1.length; ++i1) {
                 m1 = opmatrix(ops1[i1]);
                 same = false;
                 for (i2=0; i2<ops2.length; ++i2) {
                    m2 = opmatrix(ops2[i2]);
                    msame = true;
                    for (j=0; j<12; ++j) {
                       msame = msame && (Math.abs(m1[j]-m2[j])<1.0e-6);
                    }
                    same = same || msame;
                 }
                 if (!same) { break; }
              }
           }
           return same;
        }

        function symmetry_genfracgeom(symops,symb,x,y,z) {
           var fracgeom2 = [];
           var op,x2,y2,z2;
           for (var i=0; i<symops.length; ++i) {
              op = opmatrix(symops[i]);
              x2 = op[0]*x + op[3]*y + op[6]*z + op[9];
              y2 = op[1]*x + op[4]*y + op[7]*z + op[10];
              z2 = op[2]*x + op[5]*y + op[8]*z + op[11];
              fracgeom2.push([symb,x2,y2,z2]);
           }
           for (var j=0; j<fracgeom2.length; ++j) {
              fracgeom2[j][1] = fracgeom2[j][1] - Math.round(fracgeom2[j][1]);
              fracgeom2[j][2] = fracgeom2[j][2] - Math.round(fracgeom2[j][2]);
              fracgeom2[j][3] = fracgeom2[j][3] - Math.round(fracgeom2[j][3]);
           }
           return fracgeom2;
        }

        function jsUcfirst(string) 
        {
            return string.charAt(0).toUpperCase() + string.slice(1);
        }
        function isLetter(str) {
           return str.length === 1 && str.match(/[a-z]/i);
        }


        // ****************************
        // *                          *
        // *    loadinput2editor      *
        // *                          *
        // ****************************
        var inputframes_ntotal = 1;
        var inputframes_cur = 0;
        var inputframes = [];
        function loadinput2editor(addmodel) {
           var data  = editor.getValue(); // or session.getValue
           if (addmodel) {
              window.inputframes_ntotal += 1;
              window.inputframes.push(data);
           }

           var nframes = window.inputframes.length;
           if (nframes<window.inputframes_ntotal) {
              window.inputframes.push(data);
              window.inputframes_cur = (window.inputframes_cur + 1) % window.inputframes_ntotal;
           } else {
                 window.inputframes[window.inputframes_cur] = data;
                 window.inputframes_cur = (window.inputframes_cur + 1) % window.inputframes_ntotal;
                 data = window.inputframes[window.inputframes_cur];
           }
           var i = window.inputframes_cur + 1;
           document.getElementById("input_label").innerHTML = "Input " + i + " out of " + window.inputframes_ntotal;
           editor.setValue(data); 
        }

        function previnput2editor() {
           if (window.inputframes_ntotal>1) {
              var data  = editor.getValue(); // or session.getValue
              window.inputframes[window.inputframes_cur] = data;
              window.inputframes_cur = (window.inputframes_cur - 1 + window.inputframes_ntotal) % window.inputframes_ntotal;
              data = window.inputframes[window.inputframes_cur];
              var i = window.inputframes_cur + 1;
              document.getElementById("input_label").innerHTML = "Input " + i + " out of " + window.inputframes_ntotal;
              editor.setValue(data); 
           }
        }

        // ****************************
        // *                          *
        // *       nwinputsplit       *
        // *                          *
        // ****************************
        function nwinputsplit() {
           var i;
           var data  = editor.getValue(); // or session.getValue
           var nwinputs = data.split("### restart here ###");
           var nwlen = nwinputs.length;
           console.log("nwlen=",nwlen);
           console.log("nwinputs=",nwinputs);
           if (nwlen>1) {
              editor.setValue(nwinputs[0]); // or session.getValue
              var header = nwinputs[0].split("title")[0];
              header += "\n";
              header += "title" + nwinputs[0].split("title")[1].split("\n")[0] + "\n\n"; 
              header += "echo\n\n";
              header += "restart " + nwinputs[0].split("start ")[1].split("\n")[0] + "\n\n";
              header += "memory "  + nwinputs[0].split("memory ")[1].split("\n")[0] + "\n\n";

              var nwin0 = nwinputs[0].split("nwchem_input")[1].split("\n")[0].trim();
              var nwin1 = nwin0.replace(".nw",".rs.nw");
              header = header.replace(nwin0,nwin1);

              var nwoutput = nwinputs[0].split("nwchem_output")[1].split("\n")[0].trim();
              var num = parseInt(nwoutput.split("out")[1]);
           
              for (i=window.inputframes_cur; i<(window.inputframes_cur+nwlen); ++i) {
                 if (i>window.inputframes_cur) {
                    num += 1;
                    nwinputs[i] = header.replace("00",("00"+num.toString()).slice(-2)) + nwinputs[i];
                 }
                 if (i>=window.inputframes_ntotal) {
                    window.inputframes_ntotal += 1;
                    window.inputframes.push(nwinputs[i]);
                 } else {
                    window.inputframes[i] = nwinputs[i];
                 }
              }
              var i = window.inputframes_cur + 1;
              document.getElementById("input_label").innerHTML = "Input " + i + " out of " + window.inputframes_ntotal;
           }
        }



        // ****************************
        // *                          *
        // *        parse_cif         *
        // *                          *
        // ****************************
        function parse_cif(data) {
           var a = parseFloat(data.split("_cell_length_a")[1].split("\n")[0].trim().split("(")[0]);
           var b = parseFloat(data.split("_cell_length_b")[1].split("\n")[0].trim().split("(")[0]);
           var c = parseFloat(data.split("_cell_length_c")[1].split("\n")[0].trim().split("(")[0]);
           var alpha = parseFloat(data.split("_cell_angle_alpha")[1].split("\n")[0].trim().split("(")[0]);
           var beta  = parseFloat(data.split("_cell_angle_beta")[1].split("\n")[0].trim().split("(")[0]);
           var gamma = parseFloat(data.split("_cell_angle_gamma")[1].split("\n")[0].trim().split("(")[0]);

           console.log("alpha=",alpha);
           console.log("beta=",beta);
           console.log("gamma=",gamma);

           // symmetry here
           var symops,nops,j,groupfound,setting,gname,cname,groupname,groupnumber;

           groupname = "P1";
           if (data.includes("_symmetry_space_group_name_H-M")) {
              groupname = data.split("_symmetry_space_group_name_H-M")[1].split("\n")[0].trim();
           }
           groupnumber = 1;
           if (data.includes("_space_group_IT_number")) {
              groupnumber = data.split("_space_group_IT_number")[1].split("\n")[0].trim();
           }
           cname = "Triclinic"
           if (data.includes("_symmetry_cell_setting")) {
              cname = jsUcfirst(data.split("_symmetry_cell_setting")[1].split("\n")[0].trim());
           }
           symops = ["x,y,z"];
           if (data.includes("_symmetry_equiv_pos_as_xyz") || data.includes("_space_group_symop_operation_xyz")) {
              if (data.includes("_symmetry_equiv_pos_as_xyz")) {
                 symops = data.split("_symmetry_equiv_pos_as_xyz")[1].split("loop_")[0].trim().replace(/'/g,"").replace(/ /g, "").split("\n");
              } else {
                 symops = data.split("_space_group_symop_operation_xyz")[1].split("loop_")[0].trim().replace(/'/g,"").replace(/ /g, "").split("\n");
              }
              nops   = symops.length-1;
           }

           // geometry here 
           var loops = data.split("loop_")
           j=0;
           var geomfound = false;
           while ((!geomfound) && (j<loops.length)) {
              geomfound = loops[j].includes("_atom_site_type_symbol");
              geomfound = geomfound || loops[j].includes("_atom_site_label");
              j += 1;
           }
           var looplines = loops[j-1].trim().split("\n");
           var isym,ix,iy,iz,istart,ss,symb;
           isym = -1; ix = -1; iy = -1; iz = -1; istart = -1;
           for (j=0; j<looplines.length; ++j) {
              if (looplines[j].includes("_atom_site_type_symbol")) {
                 isym = j;
              }
              if ((looplines[j].includes("_atom_site_label")) && (isym<0)) {
                 isym = j;
              }
              if (looplines[j].includes("_atom_site_fract_x")) {
                 ix = j;
              }
              if (looplines[j].includes("_atom_site_fract_y")) {
                 iy = j;
              }
              if (looplines[j].includes("_atom_site_fract_z")) {
                 iz = j;
              }
              if (looplines[j].includes("_")) {istart = j;}
           }
            console.log(isym);
            console.log(ix); console.log(iy); console.log(iz);
            istart += 1;
            var fracgeom2;
            var fracgeom = [] ;
            for (j=istart; j<looplines.length; ++j) {
               ss = looplines[j].trim().split(/[ ,]+/);
               if (ss[isym].length>1) {
                  symb = ss[isym].charAt(0);
                  if (isLetter(ss[isym].charAt(1))) { symb += ss[isym].charAt(1); }
               } else {
                  symb = ss[isym].charAt(0);
               }
               x = parseFloat(ss[ix].split("(")[0]);
               y = parseFloat(ss[iy].split("(")[0]);
               z = parseFloat(ss[iz].split("(")[0]);

               fracgeom2 = symmetry_genfracgeom(symops,symb,x,y,z);
               for (n=0; n<fracgeom2.length; ++n) {
                  m = 0;
                  geomfound = false;
                  while ((!geomfound) && (m<fracgeom.length)) {
                     geomfound = (fracgeom2[n][0]==fracgeom[m][0]);
                     geomfound = geomfound && (Math.abs(fracgeom2[n][1]-fracgeom[m][1])<1.0e-6);
                     geomfound = geomfound && (Math.abs(fracgeom2[n][2]-fracgeom[m][2])<1.0e-6);
                     geomfound = geomfound && (Math.abs(fracgeom2[n][3]-fracgeom[m][3])<1.0e-6);
                     m += 1;
                  }
                  if (!geomfound) {
                     fracgeom.push(fracgeom2[n]);
                  }
               }
            }

           var lattice = abcabg_to_lattice(a,b,c,alpha,beta,gamma);
           var symmetry = [groupnumber,groupname,symops,cname];
           return [fracgeom,lattice,symmetry];
        }



        // ****************************
        // *                          *
        // *     editor_fetchXYZ      *
        // *                          *
        // ****************************
        // fetches the xyz data from the editor
        function editor_fetchXYZ() {
           var i,n,m,x,y,z,nion;
           var data = editor.getValue(); // or session.getValue
           var lines = data.split("\n");
           var ucell = "";
           if (data.includes("V2000")) {
              data = lines[3].trim().split(" ")[0];
              n = eval(data);
              data += "\n\n";
              n += 4;
              for (i=4; i<n; i++) {
                 x = lines[i].trim().split(/[ ,]+/);
                 data += x[3] + " "; 
                 data += x[0] + " ";
                 data += x[1] + " ";
                 data += x[2] + "\n";
              }
           } 

           if (data.includes("geometry")) {
              n = lines.length;
              m = 0;
              x = false;
              data = "";
              for (i=0; i<n; i++) {
                 if (lines[i].includes("geometry")) {
                    x = true;
                 } else if (lines[i].includes("end")) {
                    x = false;
                 } else if (x) {
                    data += lines[i] + "\n";
                    m += 1;
                 }
              }
              data = m.toString() + "\n\n" + data;
           }
           if (data.includes("_cell_length_a")) {
              var a = parseFloat(data.split("_cell_length_a")[1].split("\n")[0].trim().split("(")[0]);
              var b = parseFloat(data.split("_cell_length_b")[1].split("\n")[0].trim().split("(")[0]);
              var c = parseFloat(data.split("_cell_length_c")[1].split("\n")[0].trim().split("(")[0]);
              var alpha = parseFloat(data.split("_cell_angle_alpha")[1].split("\n")[0].trim().split("(")[0]);
              var beta  = parseFloat(data.split("_cell_angle_beta")[1].split("\n")[0].trim().split("(")[0]);
              var gamma = parseFloat(data.split("_cell_angle_gamma")[1].split("\n")[0].trim().split("(")[0]);
              document.getElementById("cell_a").value = a;
              document.getElementById("cell_b").value = b;
              document.getElementById("cell_c").value = c;
              document.getElementById("cell_alpha").value = alpha;
              document.getElementById("cell_beta").value  = beta;
              document.getElementById("cell_gamma").value = gamma;
              document.getElementById("showcell").value = "Unit cell on";
              document.getElementById("centercell").value = "Centered";
              console.log("alpha=",alpha);
              console.log("beta=",beta);
              console.log("gamma=",gamma);
              jsmcellchange(true,false);



              var symall= [[1, 1, '        P1', 'Triclinic', '+x,+y,+z'], [2, 1, '       P-1', 'Triclinic', '+x,+y,+z', '-x,-y,-z'], [3, 1, '        P2', 'Monoclinic', '+x,+y,+z', '-x,+y,-z'], [4, 1, '      P2_1', 'Monoclinic', '+x,+y,+z', '-x,+y+1/2,-z'], [5, 1, '        C2', 'Monoclinic', '+x,+y,+z', '-x,+y,-z', '+x+1/2,+y+1/2,+z', '-x+1/2,+y+1/2,-z'], [6, 1, '        Pm', 'Monoclinic', '+x,+y,+z', '+x,-y,+z'], [7, 1, '        Pc', 'Monoclinic', '+x,+y,+z', '+x,-y,+z+1/2'], [8, 1, '        Cm', 'Monoclinic', '+x,+y,+z', '+x,-y,+z', '+x+1/2,+y+1/2,+z', '+x+1/2,-y+1/2,+z'], [9, 1, '        Cc', 'Monoclinic', '+x,+y,+z', '+x,-y,+z+1/2', '+x+1/2,+y+1/2,+z', '+x+1/2,-y+1/2,+z+1/2'], [10, 1, '      P2/m', 'Monoclinic', '+x,+y,+z', '-x,+y,-z', '-x,-y,-z', '+x,-y,+z'], [11, 1, '    P2_1/m', 'Monoclinic', '+x,+y,+z', '-x,+y+1/2,-z', '-x,-y,-z', '+x,-y+1/2,+z'], [12, 1, '      C2/m', 'Monoclinic', '+x,+y,+z', '-x,+y,-z', '-x,-y,-z', '+x,-y,+z', '+x+1/2,+y+1/2,+z', '-x+1/2,+y+1/2,-z', '-x+1/2,-y+1/2,-z', '+x+1/2,-y+1/2,+z'], [13, 1, '      P2/c', 'Monoclinic', '+x,+y,+z', '-x,+y,-z+1/2', '-x,-y,-z', '+x,-y,+z+1/2'], [14, 1, '    P2_1/c', 'Monoclinic', '+x,+y,+z', '-x,+y+1/2,-z+1/2', '-x,-y,-z', '+x,-y+1/2,+z+1/2'], [15, 1, '      C2/c', 'Monoclinic', '+x,+y,+z', '-x,+y,-z+1/2', '-x,-y,-z', '+x,-y,+z+1/2', '+x+1/2,+y+1/2,+z', '-x+1/2,+y+1/2,-z+1/2', '-x+1/2,-y+1/2,-z', '+x+1/2,-y+1/2,+z+1/2'], [16, 1, '      P222', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z'], [17, 1, '    P222_1', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z+1/2', '-x,+y,-z+1/2', '+x,-y,-z'], [18, 1, '  P2_12_12', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z'], [19, 1, 'P2_12_12_1', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z'], [20, 1, '    C222_1', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z+1/2', '-x,+y,-z+1/2', '+x,-y,-z', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z'], [21, 1, '      C222', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z'], [22, 1, '      F222', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y+1/2,-z+1/2', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '-x+1/2,+y,-z+1/2', '+x+1/2,-y,-z+1/2', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z'], [23, 1, '      I222', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2'], [24, 1, 'I2_12_12_1', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1/2,+z+1', '-x+1/2,+y+1,-z+1', '+x+1,-y+1,-z+1/2'], [25, 1, '      Pmm2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x,-y,+z', '-x,+y,+z'], [26, 1, '    Pmc2_1', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z+1/2', '+x,-y,+z+1/2', '-x,+y,+z'], [27, 1, '      Pcc2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x,-y,+z+1/2', '-x,+y,+z+1/2'], [28, 1, '      Pma2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x+1/2,-y,+z', '-x+1/2,+y,+z'], [29, 1, '    Pca2_1', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z+1/2', '+x+1/2,-y,+z', '-x+1/2,+y,+z+1/2'], [30, 1, '      Pnc2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x,-y+1/2,+z+1/2', '-x,+y+1/2,+z+1/2'], [31, 1, '    Pmn2_1', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '+x+1/2,-y,+z+1/2', '-x,+y,+z'], [32, 1, '      Pba2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z'], [33, 1, '    Pna2_1', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z+1/2', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z+1/2'], [34, 1, '      Pnn2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2'], [35, 1, '      Cmm2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x,-y,+z', '-x,+y,+z', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z'], [36, 1, '    Cmc2_1', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z+1/2', '+x,-y,+z+1/2', '-x,+y,+z', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z'], [37, 1, '      Ccc2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x,-y,+z+1/2', '-x,+y,+z+1/2', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2'], [38, 1, '      Amm2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x,-y,+z', '-x,+y,+z', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '+x,-y+1/2,+z+1/2', '-x,+y+1/2,+z+1/2'], [39, 1, '      Abm2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x,-y+1/2,+z', '-x,+y+1/2,+z', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '+x,-y+1,+z+1/2', '-x,+y+1,+z+1/2'], [40, 1, '      Ama2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x+1/2,-y,+z', '-x+1/2,+y,+z', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2'], [41, 1, '      Aba2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '+x+1/2,-y+1,+z+1/2', '-x+1/2,+y+1,+z+1/2'], [42, 1, '      Fmm2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x,-y,+z', '-x,+y,+z', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '+x,-y+1/2,+z+1/2', '-x,+y+1/2,+z+1/2', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '+x+1/2,-y,+z+1/2', '-x+1/2,+y,+z+1/2', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z'], [43, 1, '      Fdd2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x+1/4,-y+1/4,+z+1/4', '-x+1/4,+y+1/4,+z+1/4', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '+x+1/4,-y+3/4,+z+3/4', '-x+1/4,+y+3/4,+z+3/4', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '+x+3/4,-y+1/4,+z+3/4', '-x+3/4,+y+1/4,+z+3/4', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '+x+3/4,-y+3/4,+z+1/4', '-x+3/4,+y+3/4,+z+1/4'], [44, 1, '      Imm2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x,-y,+z', '-x,+y,+z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2'], [45, 1, '      Iba2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '+x+1,-y+1,+z+1/2', '-x+1,+y+1,+z+1/2'], [46, 1, '      Ima2', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '+x+1/2,-y,+z', '-x+1/2,+y,+z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '+x+1,-y+1/2,+z+1/2', '-x+1,+y+1/2,+z+1/2'], [47, 1, '      Pmmm', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z', '-x,+y,+z'], [48, 1, '      Pnnn', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2'], [49, 1, '      Pccm', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z+1/2', '+x,-y,-z+1/2', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z+1/2', '-x,+y,+z+1/2'], [50, 1, '      Pban', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z'], [51, 1, '      Pmma', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y,+z', '-x,+y,-z', '+x+1/2,-y,-z', '-x,-y,-z', '+x+1/2,+y,-z', '+x,-y,+z', '-x+1/2,+y,+z'], [52, 1, '      Pnna', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y,+z', '-x+1/2,+y+1/2,-z+1/2', '+x,-y+1/2,-z+1/2', '-x,-y,-z', '+x+1/2,+y,-z', '+x+1/2,-y+1/2,+z+1/2', '-x,+y+1/2,+z+1/2'], [53, 1, '      Pmna', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x+1/2,+y,-z+1/2', '+x,-y,-z', '-x,-y,-z', '+x+1/2,+y,-z+1/2', '+x+1/2,-y,+z+1/2', '-x,+y,+z'], [54, 1, '      Pcca', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y,+z', '-x,+y,-z+1/2', '+x+1/2,-y,-z+1/2', '-x,-y,-z', '+x+1/2,+y,-z', '+x,-y,+z+1/2', '-x+1/2,+y,+z+1/2'], [55, 1, '      Pbam', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '-x,-y,-z', '+x,+y,-z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z'], [56, 1, '      Pccn', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y+1/2,+z', '-x,+y+1/2,-z+1/2', '+x+1/2,-y,-z+1/2', '-x,-y,-z', '+x+1/2,+y+1/2,-z', '+x,-y+1/2,+z+1/2', '-x+1/2,+y,+z+1/2'], [57, 1, '      Pbcm', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y+1/2,-z', '-x,-y,-z', '+x,+y,-z+1/2', '+x,-y+1/2,+z+1/2', '-x,+y+1/2,+z'], [58, 1, '      Pnnm', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '-x,-y,-z', '+x,+y,-z', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2'], [59, 1, '      Pmmn', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z', '+x,-y,+z', '-x,+y,+z'], [60, 1, '      Pbcn', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y+1/2,+z+1/2', '-x,+y,-z+1/2', '+x+1/2,-y+1/2,-z', '-x,-y,-z', '+x+1/2,+y+1/2,-z+1/2', '+x,-y,+z+1/2', '-x+1/2,+y+1/2,+z'], [61, 1, '      Pbca', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '-x,-y,-z', '+x+1/2,+y,-z+1/2', '+x,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z'], [62, 1, '      Pnma', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z', '+x+1/2,-y+1/2,-z+1/2', '-x,-y,-z', '+x+1/2,+y,-z+1/2', '+x,-y+1/2,+z', '-x+1/2,+y+1/2,+z+1/2'], [63, 1, '      Cmcm', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z+1/2', '-x,+y,-z+1/2', '+x,-y,-z', '-x,-y,-z', '+x,+y,-z+1/2', '+x,-y,+z+1/2', '-x,+y,+z', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z'], [64, 1, '      Cmca', 'Orthorhombic', '+x,+y,+z', '-x,-y+1/2,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y,-z', '-x,-y,-z', '+x,+y+1/2,-z+1/2', '+x,-y+1/2,+z+1/2', '-x,+y,+z', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1,+z+1/2', '-x+1/2,+y+1,-z+1/2', '+x+1/2,-y+1/2,-z', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1,-z+1/2', '+x+1/2,-y+1,+z+1/2', '-x+1/2,+y+1/2,+z'], [65, 1, '      Cmmm', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z', '-x,+y,+z', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z'], [66, 1, '      Cccm', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z+1/2', '+x,-y,-z+1/2', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z+1/2', '-x,+y,+z+1/2', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2'], [67, 1, '      Cmma', 'Orthorhombic', '+x,+y,+z', '-x,-y+1/2,+z', '-x,+y+1/2,-z', '+x,-y,-z', '-x,-y,-z', '+x,+y+1/2,-z', '+x,-y+1/2,+z', '-x,+y,+z', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1,+z', '-x+1/2,+y+1,-z', '+x+1/2,-y+1/2,-z', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1,-z', '+x+1/2,-y+1,+z', '-x+1/2,+y+1/2,+z'], [68, 1, '      Ccca', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y+1/2,+z', '-x,+y,-z', '+x+1/2,-y+1/2,-z', '-x,-y+1/2,-z+1/2', '+x+1/2,+y,-z+1/2', '+x,-y+1/2,+z+1/2', '-x+1/2,+y,+z+1/2', '+x+1/2,+y+1/2,+z', '-x+1,-y+1,+z', '-x+1/2,+y+1/2,-z', '+x+1,-y+1,-z', '-x+1/2,-y+1,-z+1/2', '+x+1,+y+1/2,-z+1/2', '+x+1/2,-y+1,+z+1/2', '-x+1,+y+1/2,+z+1/2'], [69, 1, '      Fmmm', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z', '-x,+y,+z', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y+1/2,-z+1/2', '-x,-y+1/2,-z+1/2', '+x,+y+1/2,-z+1/2', '+x,-y+1/2,+z+1/2', '-x,+y+1/2,+z+1/2', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '-x+1/2,+y,-z+1/2', '+x+1/2,-y,-z+1/2', '-x+1/2,-y,-z+1/2', '+x+1/2,+y,-z+1/2', '+x+1/2,-y,+z+1/2', '-x+1/2,+y,+z+1/2', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z'], [70, 1, '      Fddd', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '-x+1/4,-y+1/4,-z+1/4', '+x+1/4,+y+1/4,-z+1/4', '+x+1/4,-y+1/4,+z+1/4', '-x+1/4,+y+1/4,+z+1/4', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y+1/2,-z+1/2', '-x+1/4,-y+3/4,-z+3/4', '+x+1/4,+y+3/4,-z+3/4', '+x+1/4,-y+3/4,+z+3/4', '-x+1/4,+y+3/4,+z+3/4', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '-x+1/2,+y,-z+1/2', '+x+1/2,-y,-z+1/2', '-x+3/4,-y+1/4,-z+3/4', '+x+3/4,+y+1/4,-z+3/4', '+x+3/4,-y+1/4,+z+3/4', '-x+3/4,+y+1/4,+z+3/4', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '-x+3/4,-y+3/4,-z+1/4', '+x+3/4,+y+3/4,-z+1/4', '+x+3/4,-y+3/4,+z+1/4', '-x+3/4,+y+3/4,+z+1/4'], [71, 1, '      Immm', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z', '-x,+y,+z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2'], [72, 1, '      Ibam', 'Orthorhombic', '+x,+y,+z', '-x,-y,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '-x,-y,-z', '+x,+y,-z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-x+1,+y+1,-z+1/2', '+x+1,-y+1,-z+1/2', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+x+1,-y+1,+z+1/2', '-x+1,+y+1,+z+1/2'], [73, 1, '      Ibca', 'Orthorhombic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '-x,-y,-z', '+x+1/2,+y,-z+1/2', '+x,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1/2,+z+1', '-x+1/2,+y+1,-z+1', '+x+1,-y+1,-z+1/2', '-x+1/2,-y+1/2,-z+1/2', '+x+1,+y+1/2,-z+1', '+x+1/2,-y+1,+z+1', '-x+1,+y+1,+z+1/2'], [74, 1, '      Imma', 'Orthorhombic', '+x,+y,+z', '-x,-y+1/2,+z', '-x,+y+1/2,-z', '+x,-y,-z', '-x,-y,-z', '+x,+y+1/2,-z', '+x,-y+1/2,+z', '-x,+y,+z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1,+z+1/2', '-x+1/2,+y+1,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1,-z+1/2', '+x+1/2,-y+1,+z+1/2', '-x+1/2,+y+1/2,+z+1/2'], [75, 1, '        P4', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z'], [76, 1, '      P4_1', 'Tetragonal', '+x,+y,+z', '-x,-y,+z+1/2', '-y,+x,+z+1/4', '+y,-x,+z+3/4'], [77, 1, '      P4_2', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z+1/2', '+y,-x,+z+1/2'], [78, 1, '      P4_3', 'Tetragonal', '+x,+y,+z', '-x,-y,+z+1/2', '-y,+x,+z+3/4', '+y,-x,+z+1/4'], [79, 1, '        I4', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2'], [80, 1, '      I4_1', 'Tetragonal', '+x,+y,+z', '-x+1/2,-y+1/2,+z+1/2', '-y,+x+1/2,+z+1/4', '+y+1/2,-x,+z+3/4', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1,+z+1', '-y+1/2,+x+1,+z+3/4', '+y+1,-x+1/2,+z+5/4'], [81, 1, '       P-4', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z'], [82, 1, '       I-4', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2'], [83, 1, '      P4/m', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '-x,-y,-z', '+x,+y,-z', '+y,-x,-z', '-y,+x,-z'], [84, 1, '    P4_2/m', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z+1/2', '+y,-x,+z+1/2', '-x,-y,-z', '+x,+y,-z', '+y,-x,-z+1/2', '-y,+x,-z+1/2'], [85, 1, '      P4/n', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y+1/2,+x+1/2,+z', '+y+1/2,-x+1/2,+z', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z', '+y,-x,-z', '-y,+x,-z'], [86, 1, '    P4_2/n', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+y,-x,-z', '-y,+x,-z'], [87, 1, '      I4/m', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '-x,-y,-z', '+x,+y,-z', '+y,-x,-z', '-y,+x,-z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2'], [88, 1, '    I4_1/a', 'Tetragonal', '+x,+y,+z', '-x+1/2,-y+1/2,+z+1/2', '-y,+x+1/2,+z+1/4', '+y+1/2,-x,+z+3/4', '-x,-y+1/2,-z+1/4', '+x+1/2,+y,-z+3/4', '+y,-x,-z', '-y+1/2,+x+1/2,-z+1/2', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1,+z+1', '-y+1/2,+x+1,+z+3/4', '+y+1,-x+1/2,+z+5/4', '-x+1/2,-y+1,-z+3/4', '+x+1,+y+1/2,-z+5/4', '+y+1/2,-x+1/2,-z+1/2', '-y+1,+x+1,-z+1'], [89, 1, '      P422', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '-x,+y,-z', '+x,-y,-z', '+y,+x,-z', '-y,-x,-z'], [90, 1, '    P42_12', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y+1/2,+x+1/2,+z', '+y+1/2,-x+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+y,+x,-z', '-y,-x,-z'], [91, 1, '    P4_122', 'Tetragonal', '+x,+y,+z', '-x,-y,+z+1/2', '-y,+x,+z+1/4', '+y,-x,+z+3/4', '-x,+y,-z', '+x,-y,-z+1/2', '+y,+x,-z+3/4', '-y,-x,-z+1/4'], [92, 1, '  P4_12_12', 'Tetragonal', '+x,+y,+z', '-x,-y,+z+1/2', '-y+1/2,+x+1/2,+z+1/4', '+y+1/2,-x+1/2,+z+3/4', '-x+1/2,+y+1/2,-z+1/4', '+x+1/2,-y+1/2,-z+3/4', '+y,+x,-z', '-y,-x,-z+1/2'], [93, 1, '    P4_222', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z+1/2', '+y,-x,+z+1/2', '-x,+y,-z', '+x,-y,-z', '+y,+x,-z+1/2', '-y,-x,-z+1/2'], [94, 1, '  P4_22_12', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '+y,+x,-z', '-y,-x,-z'], [95, 1, '    P4_322', 'Tetragonal', '+x,+y,+z', '-x,-y,+z+1/2', '-y,+x,+z+3/4', '+y,-x,+z+1/4', '-x,+y,-z', '+x,-y,-z+1/2', '+y,+x,-z+1/4', '-y,-x,-z+3/4'], [96, 1, '  P4_32_12', 'Tetragonal', '+x,+y,+z', '-x,-y,+z+1/2', '-y+1/2,+x+1/2,+z+3/4', '+y+1/2,-x+1/2,+z+1/4', '-x+1/2,+y+1/2,-z+3/4', '+x+1/2,-y+1/2,-z+1/4', '+y,+x,-z', '-y,-x,-z+1/2'], [97, 1, '      I422', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '-x,+y,-z', '+x,-y,-z', '+y,+x,-z', '-y,-x,-z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2'], [98, 1, '    I4_122', 'Tetragonal', '+x,+y,+z', '-x+1/2,-y+1/2,+z+1/2', '-y,+x+1/2,+z+1/4', '+y+1/2,-x,+z+3/4', '-x+1/2,+y,-z+3/4', '+x,-y+1/2,-z+1/4', '+y+1/2,+x+1/2,-z+1/2', '-y,-x,-z', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1,+z+1', '-y+1/2,+x+1,+z+3/4', '+y+1,-x+1/2,+z+5/4', '-x+1,+y+1/2,-z+5/4', '+x+1/2,-y+1,-z+3/4', '+y+1,+x+1,-z+1', '-y+1/2,-x+1/2,-z+1/2'], [99, 1, '      P4mm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '+x,-y,+z', '-x,+y,+z', '-y,-x,+z', '+y,+x,+z'], [100, 1, '      P4bm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '-y+1/2,-x+1/2,+z', '+y+1/2,+x+1/2,+z'], [101, 1, '    P4_2cm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z+1/2', '+y,-x,+z+1/2', '+x,-y,+z+1/2', '-x,+y,+z+1/2', '-y,-x,+z', '+y,+x,+z'], [102, 1, '    P4_2nm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-y,-x,+z', '+y,+x,+z'], [103, 1, '      P4cc', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '+x,-y,+z+1/2', '-x,+y,+z+1/2', '-y,-x,+z+1/2', '+y,+x,+z+1/2'], [104, 1, '      P4nc', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2'], [105, 1, '    P4_2mc', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z+1/2', '+y,-x,+z+1/2', '+x,-y,+z', '-x,+y,+z', '-y,-x,+z+1/2', '+y,+x,+z+1/2'], [106, 1, '    P4_2bc', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z+1/2', '+y,-x,+z+1/2', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2'], [107, 1, '      I4mm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '+x,-y,+z', '-x,+y,+z', '-y,-x,+z', '+y,+x,+z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2'], [108, 1, '      I4cm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '+x,-y,+z+1/2', '-x,+y,+z+1/2', '-y,-x,+z+1/2', '+y,+x,+z+1/2', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '+x+1/2,-y+1/2,+z+1', '-x+1/2,+y+1/2,+z+1', '-y+1/2,-x+1/2,+z+1', '+y+1/2,+x+1/2,+z+1'], [109, 1, '    I4_1md', 'Tetragonal', '+x,+y,+z', '-x+1/2,-y+1/2,+z+1/2', '-y,+x+1/2,+z+1/4', '+y+1/2,-x,+z+3/4', '+x,-y,+z', '-x+1/2,+y+1/2,+z+1/2', '-y,-x+1/2,+z+1/4', '+y+1/2,+x,+z+3/4', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1,+z+1', '-y+1/2,+x+1,+z+3/4', '+y+1,-x+1/2,+z+5/4', '+x+1/2,-y+1/2,+z+1/2', '-x+1,+y+1,+z+1', '-y+1/2,-x+1,+z+3/4', '+y+1,+x+1/2,+z+5/4'], [110, 1, '    I4_1cd', 'Tetragonal', '+x,+y,+z', '-x+1/2,-y+1/2,+z+1/2', '-y,+x+1/2,+z+1/4', '+y+1/2,-x,+z+3/4', '+x,-y,+z+1/2', '-x+1/2,+y+1/2,+z', '-y,-x+1/2,+z+3/4', '+y+1/2,+x,+z+1/4', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1,+z+1', '-y+1/2,+x+1,+z+3/4', '+y+1,-x+1/2,+z+5/4', '+x+1/2,-y+1/2,+z+1', '-x+1,+y+1,+z+1/2', '-y+1/2,-x+1,+z+5/4', '+y+1,+x+1/2,+z+3/4'], [111, 1, '     P-42m', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '-x,+y,-z', '+x,-y,-z', '-y,-x,+z', '+y,+x,+z'], [112, 1, '     P-42c', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '-x,+y,-z+1/2', '+x,-y,-z+1/2', '-y,-x,+z+1/2', '+y,+x,+z+1/2'], [113, 1, '   P-42_1m', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '-y+1/2,-x+1/2,+z', '+y+1/2,+x+1/2,+z'], [114, 1, '   P-42_1c', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2'], [115, 1, '     P-4m2', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '+x,-y,+z', '-x,+y,+z', '+y,+x,-z', '-y,-x,-z'], [116, 1, '     P-4c2', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '+x,-y,+z+1/2', '-x,+y,+z+1/2', '+y,+x,-z+1/2', '-y,-x,-z+1/2'], [117, 1, '     P-4b2', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '+y+1/2,+x+1/2,-z', '-y+1/2,-x+1/2,-z'], [118, 1, '     P-4n2', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2'], [119, 1, '     I-4m2', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '+x,-y,+z', '-x,+y,+z', '+y,+x,-z', '-y,-x,-z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2'], [120, 1, '     I-4c2', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '+x,-y,+z+1/2', '-x,+y,+z+1/2', '+y,+x,-z+1/2', '-y,-x,-z+1/2', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1', '-x+1/2,+y+1/2,+z+1', '+y+1/2,+x+1/2,-z+1', '-y+1/2,-x+1/2,-z+1'], [121, 1, '     I-42m', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '-x,+y,-z', '+x,-y,-z', '-y,-x,+z', '+y,+x,+z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2'], [122, 1, '     I-42d', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '+y,-x,-z', '-y,+x,-z', '-x+1/2,+y,-z+3/4', '+x+1/2,-y,-z+3/4', '-y+1/2,-x,+z+3/4', '+y+1/2,+x,+z+3/4', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2', '-x+1,+y+1/2,-z+5/4', '+x+1,-y+1/2,-z+5/4', '-y+1,-x+1/2,+z+5/4', '+y+1,+x+1/2,+z+5/4'], [123, 1, '    P4/mmm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '-x,+y,-z', '+x,-y,-z', '+y,+x,-z', '-y,-x,-z', '-x,-y,-z', '+x,+y,-z', '+y,-x,-z', '-y,+x,-z', '+x,-y,+z', '-x,+y,+z', '-y,-x,+z', '+y,+x,+z'], [124, 1, '    P4/mcc', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '-x,+y,-z+1/2', '+x,-y,-z+1/2', '+y,+x,-z+1/2', '-y,-x,-z+1/2', '-x,-y,-z', '+x,+y,-z', '+y,-x,-z', '-y,+x,-z', '+x,-y,+z+1/2', '-x,+y,+z+1/2', '-y,-x,+z+1/2', '+y,+x,+z+1/2'], [125, 1, '    P4/nbm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '-x,+y,-z', '+x,-y,-z', '+y,+x,-z', '-y,-x,-z', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z', '+y+1/2,-x+1/2,-z', '-y+1/2,+x+1/2,-z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '-y+1/2,-x+1/2,+z', '+y+1/2,+x+1/2,+z'], [126, 1, '    P4/nnc', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '-x,+y,-z', '+x,-y,-z', '+y,+x,-z', '-y,-x,-z', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2'], [127, 1, '    P4/mbm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+y+1/2,+x+1/2,-z', '-y+1/2,-x+1/2,-z', '-x,-y,-z', '+x,+y,-z', '+y,-x,-z', '-y,+x,-z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '-y+1/2,-x+1/2,+z', '+y+1/2,+x+1/2,+z'], [128, 1, '    P4/mnc', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2', '-x,-y,-z', '+x,+y,-z', '+y,-x,-z', '-y,+x,-z', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2'], [129, 1, '    P4/nmm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y+1/2,+x+1/2,+z', '+y+1/2,-x+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+y,+x,-z', '-y,-x,-z', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z', '+y,-x,-z', '-y,+x,-z', '+x,-y,+z', '-x,+y,+z', '-y+1/2,-x+1/2,+z', '+y+1/2,+x+1/2,+z'], [130, 1, '    P4/ncc', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y+1/2,+x+1/2,+z', '+y+1/2,-x+1/2,+z', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '+y,+x,-z+1/2', '-y,-x,-z+1/2', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z', '+y,-x,-z', '-y,+x,-z', '+x,-y,+z+1/2', '-x,+y,+z+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2'], [131, 1, '  P4_2/mmc', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z+1/2', '+y,-x,+z+1/2', '-x,+y,-z', '+x,-y,-z', '+y,+x,-z+1/2', '-y,-x,-z+1/2', '-x,-y,-z', '+x,+y,-z', '+y,-x,-z+1/2', '-y,+x,-z+1/2', '+x,-y,+z', '-x,+y,+z', '-y,-x,+z+1/2', '+y,+x,+z+1/2'], [132, 1, '  P4_2/mcm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z+1/2', '+y,-x,+z+1/2', '-x,+y,-z+1/2', '+x,-y,-z+1/2', '+y,+x,-z', '-y,-x,-z', '-x,-y,-z', '+x,+y,-z', '+y,-x,-z+1/2', '-y,+x,-z+1/2', '+x,-y,+z+1/2', '-x,+y,+z+1/2', '-y,-x,+z', '+y,+x,+z'], [133, 1, '  P4_2/nbc', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-x,+y,-z+1/2', '+x,-y,-z+1/2', '+y+1/2,+x+1/2,-z', '-y+1/2,-x+1/2,-z', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+y,-x,-z', '-y,+x,-z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '-y,-x,+z+1/2', '+y,+x,+z+1/2'], [134, 1, '  P4_2/nnm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-x,+y,-z', '+x,-y,-z', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+y,-x,-z', '-y,+x,-z', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-y,-x,+z', '+y,+x,+z'], [135, 1, '  P4_2/mbc', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z+1/2', '+y,-x,+z+1/2', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2', '-x,-y,-z', '+x,+y,-z', '+y,-x,-z+1/2', '-y,+x,-z+1/2', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2'], [136, 1, '  P4_2/mnm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '+y,+x,-z', '-y,-x,-z', '-x,-y,-z', '+x,+y,-z', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-y,-x,+z', '+y,+x,+z'], [137, 1, '  P4_2/nmc', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '+y,+x,-z', '-y,-x,-z', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+y,-x,-z', '-y,+x,-z', '+x,-y,+z', '-x,+y,+z', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2'], [138, 1, '  P4_2/ncm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+y,+x,-z+1/2', '-y,-x,-z+1/2', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+y,-x,-z', '-y,+x,-z', '+x,-y,+z+1/2', '-x,+y,+z+1/2', '-y+1/2,-x+1/2,+z', '+y+1/2,+x+1/2,+z'], [139, 1, '    I4/mmm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '-x,+y,-z', '+x,-y,-z', '+y,+x,-z', '-y,-x,-z', '-x,-y,-z', '+x,+y,-z', '+y,-x,-z', '-y,+x,-z', '+x,-y,+z', '-x,+y,+z', '-y,-x,+z', '+y,+x,+z', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2'], [140, 1, '    I4/mcm', 'Tetragonal', '+x,+y,+z', '-x,-y,+z', '-y,+x,+z', '+y,-x,+z', '-x,+y,-z+1/2', '+x,-y,-z+1/2', '+y,+x,-z+1/2', '-y,-x,-z+1/2', '-x,-y,-z', '+x,+y,-z', '+y,-x,-z', '-y,+x,-z', '+x,-y,+z+1/2', '-x,+y,+z+1/2', '-y,-x,+z+1/2', '+y,+x,+z+1/2', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1', '+x+1/2,-y+1/2,-z+1', '+y+1/2,+x+1/2,-z+1', '-y+1/2,-x+1/2,-z+1', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1', '-x+1/2,+y+1/2,+z+1', '-y+1/2,-x+1/2,+z+1', '+y+1/2,+x+1/2,+z+1'], [141, 1, '  I4_1/amd', 'Tetragonal', '+x,+y,+z', '-x+1/2,-y+1/2,+z+1/2', '-y,+x+1/2,+z+1/4', '+y+1/2,-x,+z+3/4', '-x+1/2,+y,-z+3/4', '+x,-y+1/2,-z+1/4', '+y+1/2,+x+1/2,-z+1/2', '-y,-x,-z', '-x,-y+1/2,-z+1/4', '+x+1/2,+y,-z+3/4', '+y,-x,-z', '-y+1/2,+x+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x,+y,+z', '-y+1/2,-x,+z+3/4', '+y,+x+1/2,+z+1/4', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1,+z+1', '-y+1/2,+x+1,+z+3/4', '+y+1,-x+1/2,+z+5/4', '-x+1,+y+1/2,-z+5/4', '+x+1/2,-y+1,-z+3/4', '+y+1,+x+1,-z+1', '-y+1/2,-x+1/2,-z+1/2', '-x+1/2,-y+1,-z+3/4', '+x+1,+y+1/2,-z+5/4', '+y+1/2,-x+1/2,-z+1/2', '-y+1,+x+1,-z+1', '+x+1,-y+1,+z+1', '-x+1/2,+y+1/2,+z+1/2', '-y+1,-x+1/2,+z+5/4', '+y+1/2,+x+1,+z+3/4'], [142, 1, '  I4_1/acd', 'Tetragonal', '+x,+y,+z', '-x+1/2,-y+1/2,+z+1/2', '-y,+x+1/2,+z+1/4', '+y+1/2,-x,+z+3/4', '-x+1/2,+y,-z+1/4', '+x,-y+1/2,-z+3/4', '+y+1/2,+x+1/2,-z', '-y,-x,-z+1/2', '-x,-y+1/2,-z+1/4', '+x+1/2,+y,-z+3/4', '+y,-x,-z', '-y+1/2,+x+1/2,-z+1/2', '+x+1/2,-y+1/2,+z', '-x,+y,+z+1/2', '-y+1/2,-x,+z+1/4', '+y,+x+1/2,+z+3/4', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1,+z+1', '-y+1/2,+x+1,+z+3/4', '+y+1,-x+1/2,+z+5/4', '-x+1,+y+1/2,-z+3/4', '+x+1/2,-y+1,-z+5/4', '+y+1,+x+1,-z+1/2', '-y+1/2,-x+1/2,-z+1', '-x+1/2,-y+1,-z+3/4', '+x+1,+y+1/2,-z+5/4', '+y+1/2,-x+1/2,-z+1/2', '-y+1,+x+1,-z+1', '+x+1,-y+1,+z+1/2', '-x+1/2,+y+1/2,+z+1', '-y+1,-x+1/2,+z+3/4', '+y+1/2,+x+1,+z+5/4'], [143, 1, '        P3', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z'], [144, 1, '      P3_1', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z+1/3', '-x+y,-x,+z+2/3'], [145, 1, '      P3_2', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z+2/3', '-x+y,-x,+z+1/3'], [146, 1, '        R3', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+x+2/3,+y+1/3,+z+1/3', '-y+2/3,+x-y+1/3,+z+1/3', '-x+y+2/3,-x+1/3,+z+1/3', '+x+1/3,+y+2/3,+z+2/3', '-y+1/3,+x-y+2/3,+z+2/3', '-x+y+1/3,-x+2/3,+z+2/3'], [147, 1, '       P-3', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z'], [148, 1, '       R-3', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '+x+2/3,+y+1/3,+z+1/3', '-y+2/3,+x-y+1/3,+z+1/3', '-x+y+2/3,-x+1/3,+z+1/3', '-x+2/3,-y+1/3,-z+1/3', '+y+2/3,-x+y+1/3,-z+1/3', '+x-y+2/3,+x+1/3,-z+1/3', '+x+1/3,+y+2/3,+z+2/3', '-y+1/3,+x-y+2/3,+z+2/3', '-x+y+1/3,-x+2/3,+z+2/3', '-x+1/3,-y+2/3,-z+2/3', '+y+1/3,-x+y+2/3,-z+2/3', '+x-y+1/3,+x+2/3,-z+2/3'], [149, 1, '      P312', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-y,-x,-z', '-x+y,+y,-z', '+x,+x-y,-z'], [150, 1, '      P321', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+y,+x,-z', '+x-y,-y,-z', '-x,-x+y,-z'], [151, 1, '    P3_112', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z+1/3', '-x+y,-x,+z+2/3', '-y,-x,-z+2/3', '-x+y,+y,-z+1/3', '+x,+x-y,-z'], [152, 1, '    P3_121', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z+1/3', '-x+y,-x,+z+2/3', '+y,+x,-z', '+x-y,-y,-z+2/3', '-x,-x+y,-z+1/3'], [153, 1, '    P3_212', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z+2/3', '-x+y,-x,+z+1/3', '-y,-x,-z+1/3', '-x+y,+y,-z+2/3', '+x,+x-y,-z'], [154, 1, '    P3_221', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z+2/3', '-x+y,-x,+z+1/3', '+y,+x,-z', '+x-y,-y,-z+1/3', '-x,-x+y,-z+2/3'], [155, 1, '       R32', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+y,+x,-z', '+x-y,-y,-z', '-x,-x+y,-z', '+x+2/3,+y+1/3,+z+1/3', '-y+2/3,+x-y+1/3,+z+1/3', '-x+y+2/3,-x+1/3,+z+1/3', '+y+2/3,+x+1/3,-z+1/3', '+x-y+2/3,-y+1/3,-z+1/3', '-x+2/3,-x+y+1/3,-z+1/3', '+x+1/3,+y+2/3,+z+2/3', '-y+1/3,+x-y+2/3,+z+2/3', '-x+y+1/3,-x+2/3,+z+2/3', '+y+1/3,+x+2/3,-z+2/3', '+x-y+1/3,-y+2/3,-z+2/3', '-x+1/3,-x+y+2/3,-z+2/3'], [156, 1, '      P3m1', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-y,-x,+z', '-x+y,+y,+z', '+x,+x-y,+z'], [157, 1, '      P31m', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+y,+x,+z', '+x-y,-y,+z', '-x,-x+y,+z'], [158, 1, '      P3c1', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-y,-x,+z+1/2', '-x+y,+y,+z+1/2', '+x,+x-y,+z+1/2'], [159, 1, '      P31c', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+y,+x,+z+1/2', '+x-y,-y,+z+1/2', '-x,-x+y,+z+1/2'], [160, 1, '       R3m', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-y,-x,+z', '-x+y,+y,+z', '+x,+x-y,+z', '+x+2/3,+y+1/3,+z+1/3', '-y+2/3,+x-y+1/3,+z+1/3', '-x+y+2/3,-x+1/3,+z+1/3', '-y+2/3,-x+1/3,+z+1/3', '-x+y+2/3,+y+1/3,+z+1/3', '+x+2/3,+x-y+1/3,+z+1/3', '+x+1/3,+y+2/3,+z+2/3', '-y+1/3,+x-y+2/3,+z+2/3', '-x+y+1/3,-x+2/3,+z+2/3', '-y+1/3,-x+2/3,+z+2/3', '-x+y+1/3,+y+2/3,+z+2/3', '+x+1/3,+x-y+2/3,+z+2/3'], [161, 1, '       R3c', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-y,-x,+z+1/2', '-x+y,+y,+z+1/2', '+x,+x-y,+z+1/2', '+x+2/3,+y+1/3,+z+1/3', '-y+2/3,+x-y+1/3,+z+1/3', '-x+y+2/3,-x+1/3,+z+1/3', '-y+2/3,-x+1/3,+z+5/6', '-x+y+2/3,+y+1/3,+z+5/6', '+x+2/3,+x-y+1/3,+z+5/6', '+x+1/3,+y+2/3,+z+2/3', '-y+1/3,+x-y+2/3,+z+2/3', '-x+y+1/3,-x+2/3,+z+2/3', '-y+1/3,-x+2/3,+z+7/6', '-x+y+1/3,+y+2/3,+z+7/6', '+x+1/3,+x-y+2/3,+z+7/6'], [162, 1, '     P-31m', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-y,-x,-z', '-x+y,+y,-z', '+x,+x-y,-z', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '+y,+x,+z', '+x-y,-y,+z', '-x,-x+y,+z'], [163, 1, '     P-31c', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-y,-x,-z+1/2', '-x+y,+y,-z+1/2', '+x,+x-y,-z+1/2', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '+y,+x,+z+1/2', '+x-y,-y,+z+1/2', '-x,-x+y,+z+1/2'], [164, 1, '     P-3m1', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+y,+x,-z', '+x-y,-y,-z', '-x,-x+y,-z', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '-y,-x,+z', '-x+y,+y,+z', '+x,+x-y,+z'], [165, 1, '     P-3c1', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+y,+x,-z+1/2', '+x-y,-y,-z+1/2', '-x,-x+y,-z+1/2', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '-y,-x,+z+1/2', '-x+y,+y,+z+1/2', '+x,+x-y,+z+1/2'], [166, 1, '      R-3m', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+y,+x,-z', '+x-y,-y,-z', '-x,-x+y,-z', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '-y,-x,+z', '-x+y,+y,+z', '+x,+x-y,+z', '+x+2/3,+y+1/3,+z+1/3', '-y+2/3,+x-y+1/3,+z+1/3', '-x+y+2/3,-x+1/3,+z+1/3', '+y+2/3,+x+1/3,-z+1/3', '+x-y+2/3,-y+1/3,-z+1/3', '-x+2/3,-x+y+1/3,-z+1/3', '-x+2/3,-y+1/3,-z+1/3', '+y+2/3,-x+y+1/3,-z+1/3', '+x-y+2/3,+x+1/3,-z+1/3', '-y+2/3,-x+1/3,+z+1/3', '-x+y+2/3,+y+1/3,+z+1/3', '+x+2/3,+x-y+1/3,+z+1/3', '+x+1/3,+y+2/3,+z+2/3', '-y+1/3,+x-y+2/3,+z+2/3', '-x+y+1/3,-x+2/3,+z+2/3', '+y+1/3,+x+2/3,-z+2/3', '+x-y+1/3,-y+2/3,-z+2/3', '-x+1/3,-x+y+2/3,-z+2/3', '-x+1/3,-y+2/3,-z+2/3', '+y+1/3,-x+y+2/3,-z+2/3', '+x-y+1/3,+x+2/3,-z+2/3', '-y+1/3,-x+2/3,+z+2/3', '-x+y+1/3,+y+2/3,+z+2/3', '+x+1/3,+x-y+2/3,+z+2/3'], [167, 1, '      R-3c', 'Trigonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+y,+x,-z+1/2', '+x-y,-y,-z+1/2', '-x,-x+y,-z+1/2', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '-y,-x,+z+1/2', '-x+y,+y,+z+1/2', '+x,+x-y,+z+1/2', '+x+2/3,+y+1/3,+z+1/3', '-y+2/3,+x-y+1/3,+z+1/3', '-x+y+2/3,-x+1/3,+z+1/3', '+y+2/3,+x+1/3,-z+5/6', '+x-y+2/3,-y+1/3,-z+5/6', '-x+2/3,-x+y+1/3,-z+5/6', '-x+2/3,-y+1/3,-z+1/3', '+y+2/3,-x+y+1/3,-z+1/3', '+x-y+2/3,+x+1/3,-z+1/3', '-y+2/3,-x+1/3,+z+5/6', '-x+y+2/3,+y+1/3,+z+5/6', '+x+2/3,+x-y+1/3,+z+5/6', '+x+1/3,+y+2/3,+z+2/3', '-y+1/3,+x-y+2/3,+z+2/3', '-x+y+1/3,-x+2/3,+z+2/3', '+y+1/3,+x+2/3,-z+7/6', '+x-y+1/3,-y+2/3,-z+7/6', '-x+1/3,-x+y+2/3,-z+7/6', '-x+1/3,-y+2/3,-z+2/3', '+y+1/3,-x+y+2/3,-z+2/3', '+x-y+1/3,+x+2/3,-z+2/3', '-y+1/3,-x+2/3,+z+7/6', '-x+y+1/3,+y+2/3,+z+7/6', '+x+1/3,+x-y+2/3,+z+7/6'], [168, 1, '        P6', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z', '+y,-x+y,+z', '+x-y,+x,+z'], [169, 1, '      P6_1', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z+1/3', '-x+y,-x,+z+2/3', '-x,-y,+z+1/2', '+y,-x+y,+z+5/6', '+x-y,+x,+z+1/6'], [170, 1, '      P6_5', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z+2/3', '-x+y,-x,+z+1/3', '-x,-y,+z+1/2', '+y,-x+y,+z+1/6', '+x-y,+x,+z+5/6'], [171, 1, '      P6_2', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z+2/3', '-x+y,-x,+z+1/3', '-x,-y,+z', '+y,-x+y,+z+2/3', '+x-y,+x,+z+1/3'], [172, 1, '      P6_4', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z+1/3', '-x+y,-x,+z+2/3', '-x,-y,+z', '+y,-x+y,+z+1/3', '+x-y,+x,+z+2/3'], [173, 1, '      P6_3', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z+1/2', '+y,-x+y,+z+1/2', '+x-y,+x,+z+1/2'], [174, 1, '       P-6', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+x,+y,-z', '-y,+x-y,-z', '-x+y,-x,-z'], [175, 1, '      P6/m', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z', '+y,-x+y,+z', '+x-y,+x,+z', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '+x,+y,-z', '-y,+x-y,-z', '-x+y,-x,-z'], [176, 1, '    P6_3/m', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z+1/2', '+y,-x+y,+z+1/2', '+x-y,+x,+z+1/2', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '+x,+y,-z+1/2', '-y,+x-y,-z+1/2', '-x+y,-x,-z+1/2'], [177, 1, '      P622', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z', '+y,-x+y,+z', '+x-y,+x,+z', '+y,+x,-z', '+x-y,-y,-z', '-x,-x+y,-z', '-y,-x,-z', '-x+y,+y,-z', '+x,+x-y,-z'], [178, 1, '    P6_122', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z+1/3', '-x+y,-x,+z+2/3', '-x,-y,+z+1/2', '+y,-x+y,+z+5/6', '+x-y,+x,+z+1/6', '+y,+x,-z+1/3', '+x-y,-y,-z', '-x,-x+y,-z+2/3', '-y,-x,-z+5/6', '-x+y,+y,-z+1/2', '+x,+x-y,-z+1/6'], [179, 1, '    P6_522', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z+2/3', '-x+y,-x,+z+1/3', '-x,-y,+z+1/2', '+y,-x+y,+z+1/6', '+x-y,+x,+z+5/6', '+y,+x,-z+2/3', '+x-y,-y,-z', '-x,-x+y,-z+1/3', '-y,-x,-z+1/6', '-x+y,+y,-z+1/2', '+x,+x-y,-z+5/6'], [180, 1, '    P6_222', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z+2/3', '-x+y,-x,+z+1/3', '-x,-y,+z', '+y,-x+y,+z+2/3', '+x-y,+x,+z+1/3', '+y,+x,-z+2/3', '+x-y,-y,-z', '-x,-x+y,-z+1/3', '-y,-x,-z+2/3', '-x+y,+y,-z', '+x,+x-y,-z+1/3'], [181, 1, '    P6_422', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z+1/3', '-x+y,-x,+z+2/3', '-x,-y,+z', '+y,-x+y,+z+1/3', '+x-y,+x,+z+2/3', '+y,+x,-z+1/3', '+x-y,-y,-z', '-x,-x+y,-z+2/3', '-y,-x,-z+1/3', '-x+y,+y,-z', '+x,+x-y,-z+2/3'], [182, 1, '    P6_322', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z+1/2', '+y,-x+y,+z+1/2', '+x-y,+x,+z+1/2', '+y,+x,-z', '+x-y,-y,-z', '-x,-x+y,-z', '-y,-x,-z+1/2', '-x+y,+y,-z+1/2', '+x,+x-y,-z+1/2'], [183, 1, '      P6mm', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z', '+y,-x+y,+z', '+x-y,+x,+z', '-y,-x,+z', '-x+y,+y,+z', '+x,+x-y,+z', '+y,+x,+z', '+x-y,-y,+z', '-x,-x+y,+z'], [184, 1, '      P6cc', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z', '+y,-x+y,+z', '+x-y,+x,+z', '-y,-x,+z+1/2', '-x+y,+y,+z+1/2', '+x,+x-y,+z+1/2', '+y,+x,+z+1/2', '+x-y,-y,+z+1/2', '-x,-x+y,+z+1/2'], [185, 1, '    P6_3cm', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z+1/2', '+y,-x+y,+z+1/2', '+x-y,+x,+z+1/2', '-y,-x,+z+1/2', '-x+y,+y,+z+1/2', '+x,+x-y,+z+1/2', '+y,+x,+z', '+x-y,-y,+z', '-x,-x+y,+z'], [186, 1, '    P6_3mc', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z+1/2', '+y,-x+y,+z+1/2', '+x-y,+x,+z+1/2', '-y,-x,+z', '-x+y,+y,+z', '+x,+x-y,+z', '+y,+x,+z+1/2', '+x-y,-y,+z+1/2', '-x,-x+y,+z+1/2'], [187, 1, '     P-6m2', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+x,+y,-z', '-y,+x-y,-z', '-x+y,-x,-z', '-y,-x,+z', '-x+y,+y,+z', '+x,+x-y,+z', '-y,-x,-z', '-x+y,+y,-z', '+x,+x-y,-z'], [188, 1, '     P-6c2', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+x,+y,-z+1/2', '-y,+x-y,-z+1/2', '-x+y,-x,-z+1/2', '-y,-x,+z+1/2', '-x+y,+y,+z+1/2', '+x,+x-y,+z+1/2', '-y,-x,-z', '-x+y,+y,-z', '+x,+x-y,-z'], [189, 1, '     P-62m', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+x,+y,-z', '-y,+x-y,-z', '-x+y,-x,-z', '+y,+x,-z', '+x-y,-y,-z', '-x,-x+y,-z', '+y,+x,+z', '+x-y,-y,+z', '-x,-x+y,+z'], [190, 1, '     P-62c', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '+x,+y,-z+1/2', '-y,+x-y,-z+1/2', '-x+y,-x,-z+1/2', '+y,+x,-z', '+x-y,-y,-z', '-x,-x+y,-z', '+y,+x,+z+1/2', '+x-y,-y,+z+1/2', '-x,-x+y,+z+1/2'], [191, 1, '    P6/mmm', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z', '+y,-x+y,+z', '+x-y,+x,+z', '+y,+x,-z', '+x-y,-y,-z', '-x,-x+y,-z', '-y,-x,-z', '-x+y,+y,-z', '+x,+x-y,-z', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '+x,+y,-z', '-y,+x-y,-z', '-x+y,-x,-z', '-y,-x,+z', '-x+y,+y,+z', '+x,+x-y,+z', '+y,+x,+z', '+x-y,-y,+z', '-x,-x+y,+z'], [192, 1, '    P6/mcc', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z', '+y,-x+y,+z', '+x-y,+x,+z', '+y,+x,-z+1/2', '+x-y,-y,-z+1/2', '-x,-x+y,-z+1/2', '-y,-x,-z+1/2', '-x+y,+y,-z+1/2', '+x,+x-y,-z+1/2', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '+x,+y,-z', '-y,+x-y,-z', '-x+y,-x,-z', '-y,-x,+z+1/2', '-x+y,+y,+z+1/2', '+x,+x-y,+z+1/2', '+y,+x,+z+1/2', '+x-y,-y,+z+1/2', '-x,-x+y,+z+1/2'], [193, 1, '  P6_3/mcm', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z+1/2', '+y,-x+y,+z+1/2', '+x-y,+x,+z+1/2', '+y,+x,-z+1/2', '+x-y,-y,-z+1/2', '-x,-x+y,-z+1/2', '-y,-x,-z', '-x+y,+y,-z', '+x,+x-y,-z', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '+x,+y,-z+1/2', '-y,+x-y,-z+1/2', '-x+y,-x,-z+1/2', '-y,-x,+z+1/2', '-x+y,+y,+z+1/2', '+x,+x-y,+z+1/2', '+y,+x,+z', '+x-y,-y,+z', '-x,-x+y,+z'], [194, 1, '  P6_3/mmc', 'Hexagonal', '+x,+y,+z', '-y,+x-y,+z', '-x+y,-x,+z', '-x,-y,+z+1/2', '+y,-x+y,+z+1/2', '+x-y,+x,+z+1/2', '+y,+x,-z', '+x-y,-y,-z', '-x,-x+y,-z', '-y,-x,-z+1/2', '-x+y,+y,-z+1/2', '+x,+x-y,-z+1/2', '-x,-y,-z', '+y,-x+y,-z', '+x-y,+x,-z', '+x,+y,-z+1/2', '-y,+x-y,-z+1/2', '-x+y,-x,-z+1/2', '-y,-x,+z', '-x+y,+y,+z', '+x,+x-y,+z', '+y,+x,+z+1/2', '+x-y,-y,+z+1/2', '-x,-x+y,+z+1/2'], [195, 1, '       P23', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x'], [196, 1, '       F23', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y+1/2,-z+1/2', '+z,+x+1/2,+y+1/2', '+z,-x+1/2,-y+1/2', '-z,-x+1/2,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z+1/2,+x+1/2', '-y,+z+1/2,-x+1/2', '+y,-z+1/2,-x+1/2', '-y,-z+1/2,+x+1/2', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '-x+1/2,+y,-z+1/2', '+x+1/2,-y,-z+1/2', '+z+1/2,+x,+y+1/2', '+z+1/2,-x,-y+1/2', '-z+1/2,-x,+y+1/2', '-z+1/2,+x,-y+1/2', '+y+1/2,+z,+x+1/2', '-y+1/2,+z,-x+1/2', '+y+1/2,-z,-x+1/2', '-y+1/2,-z,+x+1/2', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+z+1/2,+x+1/2,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x+1/2,+y', '-z+1/2,+x+1/2,-y', '+y+1/2,+z+1/2,+x', '-y+1/2,+z+1/2,-x', '+y+1/2,-z+1/2,-x', '-y+1/2,-z+1/2,+x'], [197, 1, '       I23', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '+z+1/2,+x+1/2,+y+1/2', '+z+1/2,-x+1/2,-y+1/2', '-z+1/2,-x+1/2,+y+1/2', '-z+1/2,+x+1/2,-y+1/2', '+y+1/2,+z+1/2,+x+1/2', '-y+1/2,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x+1/2', '-y+1/2,-z+1/2,+x+1/2'], [198, 1, '     P2_13', 'Cubic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '+z,+x,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z,+x', '-y,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x', '-y+1/2,-z,+x+1/2'], [199, 1, '     I2_13', 'Cubic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '+z,+x,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z,+x', '-y,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x', '-y+1/2,-z,+x+1/2', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1/2,+z+1', '-x+1/2,+y+1,-z+1', '+x+1,-y+1,-z+1/2', '+z+1/2,+x+1/2,+y+1/2', '+z+1,-x+1,-y+1/2', '-z+1,-x+1/2,+y+1', '-z+1/2,+x+1,-y+1', '+y+1/2,+z+1/2,+x+1/2', '-y+1/2,+z+1,-x+1', '+y+1,-z+1,-x+1/2', '-y+1,-z+1/2,+x+1'], [200, 1, '      Pm-3', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z', '-x,+y,+z', '-z,-x,-y', '-z,+x,+y', '+z,+x,-y', '+z,-x,+y', '-y,-z,-x', '+y,-z,+x', '-y,+z,+x', '+y,+z,-x'], [201, 1, '      Pn-3', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-z+1/2,-x+1/2,-y+1/2', '-z+1/2,+x+1/2,+y+1/2', '+z+1/2,+x+1/2,-y+1/2', '+z+1/2,-x+1/2,+y+1/2', '-y+1/2,-z+1/2,-x+1/2', '+y+1/2,-z+1/2,+x+1/2', '-y+1/2,+z+1/2,+x+1/2', '+y+1/2,+z+1/2,-x+1/2'], [202, 1, '      Fm-3', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z', '-x,+y,+z', '-z,-x,-y', '-z,+x,+y', '+z,+x,-y', '+z,-x,+y', '-y,-z,-x', '+y,-z,+x', '-y,+z,+x', '+y,+z,-x', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y+1/2,-z+1/2', '+z,+x+1/2,+y+1/2', '+z,-x+1/2,-y+1/2', '-z,-x+1/2,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z+1/2,+x+1/2', '-y,+z+1/2,-x+1/2', '+y,-z+1/2,-x+1/2', '-y,-z+1/2,+x+1/2', '-x,-y+1/2,-z+1/2', '+x,+y+1/2,-z+1/2', '+x,-y+1/2,+z+1/2', '-x,+y+1/2,+z+1/2', '-z,-x+1/2,-y+1/2', '-z,+x+1/2,+y+1/2', '+z,+x+1/2,-y+1/2', '+z,-x+1/2,+y+1/2', '-y,-z+1/2,-x+1/2', '+y,-z+1/2,+x+1/2', '-y,+z+1/2,+x+1/2', '+y,+z+1/2,-x+1/2', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '-x+1/2,+y,-z+1/2', '+x+1/2,-y,-z+1/2', '+z+1/2,+x,+y+1/2', '+z+1/2,-x,-y+1/2', '-z+1/2,-x,+y+1/2', '-z+1/2,+x,-y+1/2', '+y+1/2,+z,+x+1/2', '-y+1/2,+z,-x+1/2', '+y+1/2,-z,-x+1/2', '-y+1/2,-z,+x+1/2', '-x+1/2,-y,-z+1/2', '+x+1/2,+y,-z+1/2', '+x+1/2,-y,+z+1/2', '-x+1/2,+y,+z+1/2', '-z+1/2,-x,-y+1/2', '-z+1/2,+x,+y+1/2', '+z+1/2,+x,-y+1/2', '+z+1/2,-x,+y+1/2', '-y+1/2,-z,-x+1/2', '+y+1/2,-z,+x+1/2', '-y+1/2,+z,+x+1/2', '+y+1/2,+z,-x+1/2', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+z+1/2,+x+1/2,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x+1/2,+y', '-z+1/2,+x+1/2,-y', '+y+1/2,+z+1/2,+x', '-y+1/2,+z+1/2,-x', '+y+1/2,-z+1/2,-x', '-y+1/2,-z+1/2,+x', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '-z+1/2,-x+1/2,-y', '-z+1/2,+x+1/2,+y', '+z+1/2,+x+1/2,-y', '+z+1/2,-x+1/2,+y', '-y+1/2,-z+1/2,-x', '+y+1/2,-z+1/2,+x', '-y+1/2,+z+1/2,+x', '+y+1/2,+z+1/2,-x'], [203, 1, '      Fd-3', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '-x+1/4,-y+1/4,-z+1/4', '+x+1/4,+y+1/4,-z+1/4', '+x+1/4,-y+1/4,+z+1/4', '-x+1/4,+y+1/4,+z+1/4', '-z+1/4,-x+1/4,-y+1/4', '-z+1/4,+x+1/4,+y+1/4', '+z+1/4,+x+1/4,-y+1/4', '+z+1/4,-x+1/4,+y+1/4', '-y+1/4,-z+1/4,-x+1/4', '+y+1/4,-z+1/4,+x+1/4', '-y+1/4,+z+1/4,+x+1/4', '+y+1/4,+z+1/4,-x+1/4', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y+1/2,-z+1/2', '+z,+x+1/2,+y+1/2', '+z,-x+1/2,-y+1/2', '-z,-x+1/2,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z+1/2,+x+1/2', '-y,+z+1/2,-x+1/2', '+y,-z+1/2,-x+1/2', '-y,-z+1/2,+x+1/2', '-x+1/4,-y+3/4,-z+3/4', '+x+1/4,+y+3/4,-z+3/4', '+x+1/4,-y+3/4,+z+3/4', '-x+1/4,+y+3/4,+z+3/4', '-z+1/4,-x+3/4,-y+3/4', '-z+1/4,+x+3/4,+y+3/4', '+z+1/4,+x+3/4,-y+3/4', '+z+1/4,-x+3/4,+y+3/4', '-y+1/4,-z+3/4,-x+3/4', '+y+1/4,-z+3/4,+x+3/4', '-y+1/4,+z+3/4,+x+3/4', '+y+1/4,+z+3/4,-x+3/4', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '-x+1/2,+y,-z+1/2', '+x+1/2,-y,-z+1/2', '+z+1/2,+x,+y+1/2', '+z+1/2,-x,-y+1/2', '-z+1/2,-x,+y+1/2', '-z+1/2,+x,-y+1/2', '+y+1/2,+z,+x+1/2', '-y+1/2,+z,-x+1/2', '+y+1/2,-z,-x+1/2', '-y+1/2,-z,+x+1/2', '-x+3/4,-y+1/4,-z+3/4', '+x+3/4,+y+1/4,-z+3/4', '+x+3/4,-y+1/4,+z+3/4', '-x+3/4,+y+1/4,+z+3/4', '-z+3/4,-x+1/4,-y+3/4', '-z+3/4,+x+1/4,+y+3/4', '+z+3/4,+x+1/4,-y+3/4', '+z+3/4,-x+1/4,+y+3/4', '-y+3/4,-z+1/4,-x+3/4', '+y+3/4,-z+1/4,+x+3/4', '-y+3/4,+z+1/4,+x+3/4', '+y+3/4,+z+1/4,-x+3/4', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+z+1/2,+x+1/2,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x+1/2,+y', '-z+1/2,+x+1/2,-y', '+y+1/2,+z+1/2,+x', '-y+1/2,+z+1/2,-x', '+y+1/2,-z+1/2,-x', '-y+1/2,-z+1/2,+x', '-x+3/4,-y+3/4,-z+1/4', '+x+3/4,+y+3/4,-z+1/4', '+x+3/4,-y+3/4,+z+1/4', '-x+3/4,+y+3/4,+z+1/4', '-z+3/4,-x+3/4,-y+1/4', '-z+3/4,+x+3/4,+y+1/4', '+z+3/4,+x+3/4,-y+1/4', '+z+3/4,-x+3/4,+y+1/4', '-y+3/4,-z+3/4,-x+1/4', '+y+3/4,-z+3/4,+x+1/4', '-y+3/4,+z+3/4,+x+1/4', '+y+3/4,+z+3/4,-x+1/4'], [204, 1, '      Im-3', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z', '-x,+y,+z', '-z,-x,-y', '-z,+x,+y', '+z,+x,-y', '+z,-x,+y', '-y,-z,-x', '+y,-z,+x', '-y,+z,+x', '+y,+z,-x', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '+z+1/2,+x+1/2,+y+1/2', '+z+1/2,-x+1/2,-y+1/2', '-z+1/2,-x+1/2,+y+1/2', '-z+1/2,+x+1/2,-y+1/2', '+y+1/2,+z+1/2,+x+1/2', '-y+1/2,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x+1/2', '-y+1/2,-z+1/2,+x+1/2', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-z+1/2,-x+1/2,-y+1/2', '-z+1/2,+x+1/2,+y+1/2', '+z+1/2,+x+1/2,-y+1/2', '+z+1/2,-x+1/2,+y+1/2', '-y+1/2,-z+1/2,-x+1/2', '+y+1/2,-z+1/2,+x+1/2', '-y+1/2,+z+1/2,+x+1/2', '+y+1/2,+z+1/2,-x+1/2'], [205, 1, '      Pa-3', 'Cubic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '+z,+x,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z,+x', '-y,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x', '-y+1/2,-z,+x+1/2', '-x,-y,-z', '+x+1/2,+y,-z+1/2', '+x,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z', '-z,-x,-y', '-z+1/2,+x+1/2,+y', '+z+1/2,+x,-y+1/2', '+z,-x+1/2,+y+1/2', '-y,-z,-x', '+y,-z+1/2,+x+1/2', '-y+1/2,+z+1/2,+x', '+y+1/2,+z,-x+1/2'], [206, 1, '      Ia-3', 'Cubic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '+z,+x,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z,+x', '-y,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x', '-y+1/2,-z,+x+1/2', '-x,-y,-z', '+x+1/2,+y,-z+1/2', '+x,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z', '-z,-x,-y', '-z+1/2,+x+1/2,+y', '+z+1/2,+x,-y+1/2', '+z,-x+1/2,+y+1/2', '-y,-z,-x', '+y,-z+1/2,+x+1/2', '-y+1/2,+z+1/2,+x', '+y+1/2,+z,-x+1/2', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1/2,+z+1', '-x+1/2,+y+1,-z+1', '+x+1,-y+1,-z+1/2', '+z+1/2,+x+1/2,+y+1/2', '+z+1,-x+1,-y+1/2', '-z+1,-x+1/2,+y+1', '-z+1/2,+x+1,-y+1', '+y+1/2,+z+1/2,+x+1/2', '-y+1/2,+z+1,-x+1', '+y+1,-z+1,-x+1/2', '-y+1,-z+1/2,+x+1', '-x+1/2,-y+1/2,-z+1/2', '+x+1,+y+1/2,-z+1', '+x+1/2,-y+1,+z+1', '-x+1,+y+1,+z+1/2', '-z+1/2,-x+1/2,-y+1/2', '-z+1,+x+1,+y+1/2', '+z+1,+x+1/2,-y+1', '+z+1/2,-x+1,+y+1', '-y+1/2,-z+1/2,-x+1/2', '+y+1/2,-z+1,+x+1', '-y+1,+z+1,+x+1/2', '+y+1,+z+1/2,-x+1'], [207, 1, '      P432', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y,+x,-z', '-y,-x,-z', '+y,-x,+z', '-y,+x,+z', '+x,+z,-y', '-x,+z,+y', '-x,-z,-y', '+x,-z,+y', '+z,+y,-x', '+z,-y,+x', '-z,+y,+x', '-z,-y,-x'], [208, 1, '    P4_232', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+x+1/2,+z+1/2,-y+1/2', '-x+1/2,+z+1/2,+y+1/2', '-x+1/2,-z+1/2,-y+1/2', '+x+1/2,-z+1/2,+y+1/2', '+z+1/2,+y+1/2,-x+1/2', '+z+1/2,-y+1/2,+x+1/2', '-z+1/2,+y+1/2,+x+1/2', '-z+1/2,-y+1/2,-x+1/2'], [209, 1, '      F432', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y,+x,-z', '-y,-x,-z', '+y,-x,+z', '-y,+x,+z', '+x,+z,-y', '-x,+z,+y', '-x,-z,-y', '+x,-z,+y', '+z,+y,-x', '+z,-y,+x', '-z,+y,+x', '-z,-y,-x', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y+1/2,-z+1/2', '+z,+x+1/2,+y+1/2', '+z,-x+1/2,-y+1/2', '-z,-x+1/2,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z+1/2,+x+1/2', '-y,+z+1/2,-x+1/2', '+y,-z+1/2,-x+1/2', '-y,-z+1/2,+x+1/2', '+y,+x+1/2,-z+1/2', '-y,-x+1/2,-z+1/2', '+y,-x+1/2,+z+1/2', '-y,+x+1/2,+z+1/2', '+x,+z+1/2,-y+1/2', '-x,+z+1/2,+y+1/2', '-x,-z+1/2,-y+1/2', '+x,-z+1/2,+y+1/2', '+z,+y+1/2,-x+1/2', '+z,-y+1/2,+x+1/2', '-z,+y+1/2,+x+1/2', '-z,-y+1/2,-x+1/2', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '-x+1/2,+y,-z+1/2', '+x+1/2,-y,-z+1/2', '+z+1/2,+x,+y+1/2', '+z+1/2,-x,-y+1/2', '-z+1/2,-x,+y+1/2', '-z+1/2,+x,-y+1/2', '+y+1/2,+z,+x+1/2', '-y+1/2,+z,-x+1/2', '+y+1/2,-z,-x+1/2', '-y+1/2,-z,+x+1/2', '+y+1/2,+x,-z+1/2', '-y+1/2,-x,-z+1/2', '+y+1/2,-x,+z+1/2', '-y+1/2,+x,+z+1/2', '+x+1/2,+z,-y+1/2', '-x+1/2,+z,+y+1/2', '-x+1/2,-z,-y+1/2', '+x+1/2,-z,+y+1/2', '+z+1/2,+y,-x+1/2', '+z+1/2,-y,+x+1/2', '-z+1/2,+y,+x+1/2', '-z+1/2,-y,-x+1/2', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+z+1/2,+x+1/2,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x+1/2,+y', '-z+1/2,+x+1/2,-y', '+y+1/2,+z+1/2,+x', '-y+1/2,+z+1/2,-x', '+y+1/2,-z+1/2,-x', '-y+1/2,-z+1/2,+x', '+y+1/2,+x+1/2,-z', '-y+1/2,-x+1/2,-z', '+y+1/2,-x+1/2,+z', '-y+1/2,+x+1/2,+z', '+x+1/2,+z+1/2,-y', '-x+1/2,+z+1/2,+y', '-x+1/2,-z+1/2,-y', '+x+1/2,-z+1/2,+y', '+z+1/2,+y+1/2,-x', '+z+1/2,-y+1/2,+x', '-z+1/2,+y+1/2,+x', '-z+1/2,-y+1/2,-x'], [210, 1, '    F4_132', 'Cubic', '+x,+y,+z', '-x,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,-z', '+x+1/2,-y,-z+1/2', '+z,+x,+y', '+z+1/2,-x,-y+1/2', '-z,-x+1/2,+y+1/2', '-z+1/2,+x+1/2,-y', '+y,+z,+x', '-y+1/2,+z+1/2,-x', '+y+1/2,-z,-x+1/2', '-y,-z+1/2,+x+1/2', '+y+3/4,+x+1/4,-z+3/4', '-y+1/4,-x+1/4,-z+1/4', '+y+1/4,-x+3/4,+z+3/4', '-y+3/4,+x+3/4,+z+1/4', '+x+3/4,+z+1/4,-y+3/4', '-x+3/4,+z+3/4,+y+1/4', '-x+1/4,-z+1/4,-y+1/4', '+x+1/4,-z+3/4,+y+3/4', '+z+3/4,+y+1/4,-x+3/4', '+z+1/4,-y+3/4,+x+3/4', '-z+3/4,+y+3/4,+x+1/4', '-z+1/4,-y+1/4,-x+1/4', '+x,+y+1/2,+z+1/2', '-x,-y+1,+z+1', '-x+1/2,+y+1,-z+1/2', '+x+1/2,-y+1/2,-z+1', '+z,+x+1/2,+y+1/2', '+z+1/2,-x+1/2,-y+1', '-z,-x+1,+y+1', '-z+1/2,+x+1,-y+1/2', '+y,+z+1/2,+x+1/2', '-y+1/2,+z+1,-x+1/2', '+y+1/2,-z+1/2,-x+1', '-y,-z+1,+x+1', '+y+3/4,+x+3/4,-z+5/4', '-y+1/4,-x+3/4,-z+3/4', '+y+1/4,-x+5/4,+z+5/4', '-y+3/4,+x+5/4,+z+3/4', '+x+3/4,+z+3/4,-y+5/4', '-x+3/4,+z+5/4,+y+3/4', '-x+1/4,-z+3/4,-y+3/4', '+x+1/4,-z+5/4,+y+5/4', '+z+3/4,+y+3/4,-x+5/4', '+z+1/4,-y+5/4,+x+5/4', '-z+3/4,+y+5/4,+x+3/4', '-z+1/4,-y+3/4,-x+3/4', '+x+1/2,+y,+z+1/2', '-x+1/2,-y+1/2,+z+1', '-x+1,+y+1/2,-z+1/2', '+x+1,-y,-z+1', '+z+1/2,+x,+y+1/2', '+z+1,-x,-y+1', '-z+1/2,-x+1/2,+y+1', '-z+1,+x+1/2,-y+1/2', '+y+1/2,+z,+x+1/2', '-y+1,+z+1/2,-x+1/2', '+y+1,-z,-x+1', '-y+1/2,-z+1/2,+x+1', '+y+5/4,+x+1/4,-z+5/4', '-y+3/4,-x+1/4,-z+3/4', '+y+3/4,-x+3/4,+z+5/4', '-y+5/4,+x+3/4,+z+3/4', '+x+5/4,+z+1/4,-y+5/4', '-x+5/4,+z+3/4,+y+3/4', '-x+3/4,-z+1/4,-y+3/4', '+x+3/4,-z+3/4,+y+5/4', '+z+5/4,+y+1/4,-x+5/4', '+z+3/4,-y+3/4,+x+5/4', '-z+5/4,+y+3/4,+x+3/4', '-z+3/4,-y+1/4,-x+3/4', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1,+z+1/2', '-x+1,+y+1,-z', '+x+1,-y+1/2,-z+1/2', '+z+1/2,+x+1/2,+y', '+z+1,-x+1/2,-y+1/2', '-z+1/2,-x+1,+y+1/2', '-z+1,+x+1,-y', '+y+1/2,+z+1/2,+x', '-y+1,+z+1,-x', '+y+1,-z+1/2,-x+1/2', '-y+1/2,-z+1,+x+1/2', '+y+5/4,+x+3/4,-z+3/4', '-y+3/4,-x+3/4,-z+1/4', '+y+3/4,-x+5/4,+z+3/4', '-y+5/4,+x+5/4,+z+1/4', '+x+5/4,+z+3/4,-y+3/4', '-x+5/4,+z+5/4,+y+1/4', '-x+3/4,-z+3/4,-y+1/4', '+x+3/4,-z+5/4,+y+3/4', '+z+5/4,+y+3/4,-x+3/4', '+z+3/4,-y+5/4,+x+3/4', '-z+5/4,+y+5/4,+x+1/4', '-z+3/4,-y+3/4,-x+1/4'], [211, 1, '      I432', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y,+x,-z', '-y,-x,-z', '+y,-x,+z', '-y,+x,+z', '+x,+z,-y', '-x,+z,+y', '-x,-z,-y', '+x,-z,+y', '+z,+y,-x', '+z,-y,+x', '-z,+y,+x', '-z,-y,-x', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '+z+1/2,+x+1/2,+y+1/2', '+z+1/2,-x+1/2,-y+1/2', '-z+1/2,-x+1/2,+y+1/2', '-z+1/2,+x+1/2,-y+1/2', '+y+1/2,+z+1/2,+x+1/2', '-y+1/2,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x+1/2', '-y+1/2,-z+1/2,+x+1/2', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+x+1/2,+z+1/2,-y+1/2', '-x+1/2,+z+1/2,+y+1/2', '-x+1/2,-z+1/2,-y+1/2', '+x+1/2,-z+1/2,+y+1/2', '+z+1/2,+y+1/2,-x+1/2', '+z+1/2,-y+1/2,+x+1/2', '-z+1/2,+y+1/2,+x+1/2', '-z+1/2,-y+1/2,-x+1/2'], [212, 1, '    P4_332', 'Cubic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '+z,+x,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z,+x', '-y,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x', '-y+1/2,-z,+x+1/2', '+y+1/4,+x+3/4,-z+3/4', '-y+1/4,-x+1/4,-z+1/4', '+y+3/4,-x+3/4,+z+1/4', '-y+3/4,+x+1/4,+z+3/4', '+x+1/4,+z+3/4,-y+3/4', '-x+3/4,+z+1/4,+y+3/4', '-x+1/4,-z+1/4,-y+1/4', '+x+3/4,-z+3/4,+y+1/4', '+z+1/4,+y+3/4,-x+3/4', '+z+3/4,-y+3/4,+x+1/4', '-z+3/4,+y+1/4,+x+3/4', '-z+1/4,-y+1/4,-x+1/4'], [213, 1, '    P4_132', 'Cubic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '+z,+x,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z,+x', '-y,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x', '-y+1/2,-z,+x+1/2', '+y+3/4,+x+1/4,-z+1/4', '-y+3/4,-x+3/4,-z+3/4', '+y+1/4,-x+1/4,+z+3/4', '-y+1/4,+x+3/4,+z+1/4', '+x+3/4,+z+1/4,-y+1/4', '-x+1/4,+z+3/4,+y+1/4', '-x+3/4,-z+3/4,-y+3/4', '+x+1/4,-z+1/4,+y+3/4', '+z+3/4,+y+1/4,-x+1/4', '+z+1/4,-y+1/4,+x+3/4', '-z+1/4,+y+3/4,+x+1/4', '-z+3/4,-y+3/4,-x+3/4'], [214, 1, '    I4_132', 'Cubic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '+z,+x,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z,+x', '-y,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x', '-y+1/2,-z,+x+1/2', '+y+3/4,+x+1/4,-z+1/4', '-y+3/4,-x+3/4,-z+3/4', '+y+1/4,-x+1/4,+z+3/4', '-y+1/4,+x+3/4,+z+1/4', '+x+3/4,+z+1/4,-y+1/4', '-x+1/4,+z+3/4,+y+1/4', '-x+3/4,-z+3/4,-y+3/4', '+x+1/4,-z+1/4,+y+3/4', '+z+3/4,+y+1/4,-x+1/4', '+z+1/4,-y+1/4,+x+3/4', '-z+1/4,+y+3/4,+x+1/4', '-z+3/4,-y+3/4,-x+3/4', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1/2,+z+1', '-x+1/2,+y+1,-z+1', '+x+1,-y+1,-z+1/2', '+z+1/2,+x+1/2,+y+1/2', '+z+1,-x+1,-y+1/2', '-z+1,-x+1/2,+y+1', '-z+1/2,+x+1,-y+1', '+y+1/2,+z+1/2,+x+1/2', '-y+1/2,+z+1,-x+1', '+y+1,-z+1,-x+1/2', '-y+1,-z+1/2,+x+1', '+y+5/4,+x+3/4,-z+3/4', '-y+5/4,-x+5/4,-z+5/4', '+y+3/4,-x+3/4,+z+5/4', '-y+3/4,+x+5/4,+z+3/4', '+x+5/4,+z+3/4,-y+3/4', '-x+3/4,+z+5/4,+y+3/4', '-x+5/4,-z+5/4,-y+5/4', '+x+3/4,-z+3/4,+y+5/4', '+z+5/4,+y+3/4,-x+3/4', '+z+3/4,-y+3/4,+x+5/4', '-z+3/4,+y+5/4,+x+3/4', '-z+5/4,-y+5/4,-x+5/4'], [215, 1, '     P-43m', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y,+x,+z', '-y,-x,+z', '+y,-x,-z', '-y,+x,-z', '+x,+z,+y', '-x,+z,-y', '-x,-z,+y', '+x,-z,-y', '+z,+y,+x', '+z,-y,-x', '-z,+y,-x', '-z,-y,+x'], [216, 1, '     F-43m', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y,+x,+z', '-y,-x,+z', '+y,-x,-z', '-y,+x,-z', '+x,+z,+y', '-x,+z,-y', '-x,-z,+y', '+x,-z,-y', '+z,+y,+x', '+z,-y,-x', '-z,+y,-x', '-z,-y,+x', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y+1/2,-z+1/2', '+z,+x+1/2,+y+1/2', '+z,-x+1/2,-y+1/2', '-z,-x+1/2,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z+1/2,+x+1/2', '-y,+z+1/2,-x+1/2', '+y,-z+1/2,-x+1/2', '-y,-z+1/2,+x+1/2', '+y,+x+1/2,+z+1/2', '-y,-x+1/2,+z+1/2', '+y,-x+1/2,-z+1/2', '-y,+x+1/2,-z+1/2', '+x,+z+1/2,+y+1/2', '-x,+z+1/2,-y+1/2', '-x,-z+1/2,+y+1/2', '+x,-z+1/2,-y+1/2', '+z,+y+1/2,+x+1/2', '+z,-y+1/2,-x+1/2', '-z,+y+1/2,-x+1/2', '-z,-y+1/2,+x+1/2', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '-x+1/2,+y,-z+1/2', '+x+1/2,-y,-z+1/2', '+z+1/2,+x,+y+1/2', '+z+1/2,-x,-y+1/2', '-z+1/2,-x,+y+1/2', '-z+1/2,+x,-y+1/2', '+y+1/2,+z,+x+1/2', '-y+1/2,+z,-x+1/2', '+y+1/2,-z,-x+1/2', '-y+1/2,-z,+x+1/2', '+y+1/2,+x,+z+1/2', '-y+1/2,-x,+z+1/2', '+y+1/2,-x,-z+1/2', '-y+1/2,+x,-z+1/2', '+x+1/2,+z,+y+1/2', '-x+1/2,+z,-y+1/2', '-x+1/2,-z,+y+1/2', '+x+1/2,-z,-y+1/2', '+z+1/2,+y,+x+1/2', '+z+1/2,-y,-x+1/2', '-z+1/2,+y,-x+1/2', '-z+1/2,-y,+x+1/2', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+z+1/2,+x+1/2,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x+1/2,+y', '-z+1/2,+x+1/2,-y', '+y+1/2,+z+1/2,+x', '-y+1/2,+z+1/2,-x', '+y+1/2,-z+1/2,-x', '-y+1/2,-z+1/2,+x', '+y+1/2,+x+1/2,+z', '-y+1/2,-x+1/2,+z', '+y+1/2,-x+1/2,-z', '-y+1/2,+x+1/2,-z', '+x+1/2,+z+1/2,+y', '-x+1/2,+z+1/2,-y', '-x+1/2,-z+1/2,+y', '+x+1/2,-z+1/2,-y', '+z+1/2,+y+1/2,+x', '+z+1/2,-y+1/2,-x', '-z+1/2,+y+1/2,-x', '-z+1/2,-y+1/2,+x'], [217, 1, '     I-43m', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y,+x,+z', '-y,-x,+z', '+y,-x,-z', '-y,+x,-z', '+x,+z,+y', '-x,+z,-y', '-x,-z,+y', '+x,-z,-y', '+z,+y,+x', '+z,-y,-x', '-z,+y,-x', '-z,-y,+x', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '+z+1/2,+x+1/2,+y+1/2', '+z+1/2,-x+1/2,-y+1/2', '-z+1/2,-x+1/2,+y+1/2', '-z+1/2,+x+1/2,-y+1/2', '+y+1/2,+z+1/2,+x+1/2', '-y+1/2,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x+1/2', '-y+1/2,-z+1/2,+x+1/2', '+y+1/2,+x+1/2,+z+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+x+1/2,+z+1/2,+y+1/2', '-x+1/2,+z+1/2,-y+1/2', '-x+1/2,-z+1/2,+y+1/2', '+x+1/2,-z+1/2,-y+1/2', '+z+1/2,+y+1/2,+x+1/2', '+z+1/2,-y+1/2,-x+1/2', '-z+1/2,+y+1/2,-x+1/2', '-z+1/2,-y+1/2,+x+1/2'], [218, 1, '     P-43n', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y+1/2,+x+1/2,+z+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+x+1/2,+z+1/2,+y+1/2', '-x+1/2,+z+1/2,-y+1/2', '-x+1/2,-z+1/2,+y+1/2', '+x+1/2,-z+1/2,-y+1/2', '+z+1/2,+y+1/2,+x+1/2', '+z+1/2,-y+1/2,-x+1/2', '-z+1/2,+y+1/2,-x+1/2', '-z+1/2,-y+1/2,+x+1/2'], [219, 1, '     F-43c', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y+1/2,+x+1/2,+z+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+x+1/2,+z+1/2,+y+1/2', '-x+1/2,+z+1/2,-y+1/2', '-x+1/2,-z+1/2,+y+1/2', '+x+1/2,-z+1/2,-y+1/2', '+z+1/2,+y+1/2,+x+1/2', '+z+1/2,-y+1/2,-x+1/2', '-z+1/2,+y+1/2,-x+1/2', '-z+1/2,-y+1/2,+x+1/2', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y+1/2,-z+1/2', '+z,+x+1/2,+y+1/2', '+z,-x+1/2,-y+1/2', '-z,-x+1/2,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z+1/2,+x+1/2', '-y,+z+1/2,-x+1/2', '+y,-z+1/2,-x+1/2', '-y,-z+1/2,+x+1/2', '+y+1/2,+x+1,+z+1', '-y+1/2,-x+1,+z+1', '+y+1/2,-x+1,-z+1', '-y+1/2,+x+1,-z+1', '+x+1/2,+z+1,+y+1', '-x+1/2,+z+1,-y+1', '-x+1/2,-z+1,+y+1', '+x+1/2,-z+1,-y+1', '+z+1/2,+y+1,+x+1', '+z+1/2,-y+1,-x+1', '-z+1/2,+y+1,-x+1', '-z+1/2,-y+1,+x+1', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '-x+1/2,+y,-z+1/2', '+x+1/2,-y,-z+1/2', '+z+1/2,+x,+y+1/2', '+z+1/2,-x,-y+1/2', '-z+1/2,-x,+y+1/2', '-z+1/2,+x,-y+1/2', '+y+1/2,+z,+x+1/2', '-y+1/2,+z,-x+1/2', '+y+1/2,-z,-x+1/2', '-y+1/2,-z,+x+1/2', '+y+1,+x+1/2,+z+1', '-y+1,-x+1/2,+z+1', '+y+1,-x+1/2,-z+1', '-y+1,+x+1/2,-z+1', '+x+1,+z+1/2,+y+1', '-x+1,+z+1/2,-y+1', '-x+1,-z+1/2,+y+1', '+x+1,-z+1/2,-y+1', '+z+1,+y+1/2,+x+1', '+z+1,-y+1/2,-x+1', '-z+1,+y+1/2,-x+1', '-z+1,-y+1/2,+x+1', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+z+1/2,+x+1/2,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x+1/2,+y', '-z+1/2,+x+1/2,-y', '+y+1/2,+z+1/2,+x', '-y+1/2,+z+1/2,-x', '+y+1/2,-z+1/2,-x', '-y+1/2,-z+1/2,+x', '+y+1,+x+1,+z+1/2', '-y+1,-x+1,+z+1/2', '+y+1,-x+1,-z+1/2', '-y+1,+x+1,-z+1/2', '+x+1,+z+1,+y+1/2', '-x+1,+z+1,-y+1/2', '-x+1,-z+1,+y+1/2', '+x+1,-z+1,-y+1/2', '+z+1,+y+1,+x+1/2', '+z+1,-y+1,-x+1/2', '-z+1,+y+1,-x+1/2', '-z+1,-y+1,+x+1/2'], [220, 1, '     I-43d', 'Cubic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '+z,+x,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z,+x', '-y,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x', '-y+1/2,-z,+x+1/2', '+y+1/4,+x+1/4,+z+1/4', '-y+1/4,-x+3/4,+z+3/4', '+y+3/4,-x+1/4,-z+3/4', '-y+3/4,+x+3/4,-z+1/4', '+x+1/4,+z+1/4,+y+1/4', '-x+3/4,+z+3/4,-y+1/4', '-x+1/4,-z+3/4,+y+3/4', '+x+3/4,-z+1/4,-y+3/4', '+z+1/4,+y+1/4,+x+1/4', '+z+3/4,-y+1/4,-x+3/4', '-z+3/4,+y+3/4,-x+1/4', '-z+1/4,-y+3/4,+x+3/4', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1/2,+z+1', '-x+1/2,+y+1,-z+1', '+x+1,-y+1,-z+1/2', '+z+1/2,+x+1/2,+y+1/2', '+z+1,-x+1,-y+1/2', '-z+1,-x+1/2,+y+1', '-z+1/2,+x+1,-y+1', '+y+1/2,+z+1/2,+x+1/2', '-y+1/2,+z+1,-x+1', '+y+1,-z+1,-x+1/2', '-y+1,-z+1/2,+x+1', '+y+3/4,+x+3/4,+z+3/4', '-y+3/4,-x+5/4,+z+5/4', '+y+5/4,-x+3/4,-z+5/4', '-y+5/4,+x+5/4,-z+3/4', '+x+3/4,+z+3/4,+y+3/4', '-x+5/4,+z+5/4,-y+3/4', '-x+3/4,-z+5/4,+y+5/4', '+x+5/4,-z+3/4,-y+5/4', '+z+3/4,+y+3/4,+x+3/4', '+z+5/4,-y+3/4,-x+5/4', '-z+5/4,+y+5/4,-x+3/4', '-z+3/4,-y+5/4,+x+5/4'], [221, 1, '     Pm-3m', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y,+x,-z', '-y,-x,-z', '+y,-x,+z', '-y,+x,+z', '+x,+z,-y', '-x,+z,+y', '-x,-z,-y', '+x,-z,+y', '+z,+y,-x', '+z,-y,+x', '-z,+y,+x', '-z,-y,-x', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z', '-x,+y,+z', '-z,-x,-y', '-z,+x,+y', '+z,+x,-y', '+z,-x,+y', '-y,-z,-x', '+y,-z,+x', '-y,+z,+x', '+y,+z,-x', '-y,-x,+z', '+y,+x,+z', '-y,+x,-z', '+y,-x,-z', '-x,-z,+y', '+x,-z,-y', '+x,+z,+y', '-x,+z,-y', '-z,-y,+x', '-z,+y,-x', '+z,-y,-x', '+z,+y,+x'], [222, 1, '     Pn-3n', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y,+x,-z', '-y,-x,-z', '+y,-x,+z', '-y,+x,+z', '+x,+z,-y', '-x,+z,+y', '-x,-z,-y', '+x,-z,+y', '+z,+y,-x', '+z,-y,+x', '-z,+y,+x', '-z,-y,-x', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-z+1/2,-x+1/2,-y+1/2', '-z+1/2,+x+1/2,+y+1/2', '+z+1/2,+x+1/2,-y+1/2', '+z+1/2,-x+1/2,+y+1/2', '-y+1/2,-z+1/2,-x+1/2', '+y+1/2,-z+1/2,+x+1/2', '-y+1/2,+z+1/2,+x+1/2', '+y+1/2,+z+1/2,-x+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-x+1/2,-z+1/2,+y+1/2', '+x+1/2,-z+1/2,-y+1/2', '+x+1/2,+z+1/2,+y+1/2', '-x+1/2,+z+1/2,-y+1/2', '-z+1/2,-y+1/2,+x+1/2', '-z+1/2,+y+1/2,-x+1/2', '+z+1/2,-y+1/2,-x+1/2', '+z+1/2,+y+1/2,+x+1/2'], [223, 1, '     Pm-3n', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+x+1/2,+z+1/2,-y+1/2', '-x+1/2,+z+1/2,+y+1/2', '-x+1/2,-z+1/2,-y+1/2', '+x+1/2,-z+1/2,+y+1/2', '+z+1/2,+y+1/2,-x+1/2', '+z+1/2,-y+1/2,+x+1/2', '-z+1/2,+y+1/2,+x+1/2', '-z+1/2,-y+1/2,-x+1/2', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z', '-x,+y,+z', '-z,-x,-y', '-z,+x,+y', '+z,+x,-y', '+z,-x,+y', '-y,-z,-x', '+y,-z,+x', '-y,+z,+x', '+y,+z,-x', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-x+1/2,-z+1/2,+y+1/2', '+x+1/2,-z+1/2,-y+1/2', '+x+1/2,+z+1/2,+y+1/2', '-x+1/2,+z+1/2,-y+1/2', '-z+1/2,-y+1/2,+x+1/2', '-z+1/2,+y+1/2,-x+1/2', '+z+1/2,-y+1/2,-x+1/2', '+z+1/2,+y+1/2,+x+1/2'], [224, 1, '     Pn-3m', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+x+1/2,+z+1/2,-y+1/2', '-x+1/2,+z+1/2,+y+1/2', '-x+1/2,-z+1/2,-y+1/2', '+x+1/2,-z+1/2,+y+1/2', '+z+1/2,+y+1/2,-x+1/2', '+z+1/2,-y+1/2,+x+1/2', '-z+1/2,+y+1/2,+x+1/2', '-z+1/2,-y+1/2,-x+1/2', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-z+1/2,-x+1/2,-y+1/2', '-z+1/2,+x+1/2,+y+1/2', '+z+1/2,+x+1/2,-y+1/2', '+z+1/2,-x+1/2,+y+1/2', '-y+1/2,-z+1/2,-x+1/2', '+y+1/2,-z+1/2,+x+1/2', '-y+1/2,+z+1/2,+x+1/2', '+y+1/2,+z+1/2,-x+1/2', '-y,-x,+z', '+y,+x,+z', '-y,+x,-z', '+y,-x,-z', '-x,-z,+y', '+x,-z,-y', '+x,+z,+y', '-x,+z,-y', '-z,-y,+x', '-z,+y,-x', '+z,-y,-x', '+z,+y,+x'], [225, 1, '     Fm-3m', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y,+x,-z', '-y,-x,-z', '+y,-x,+z', '-y,+x,+z', '+x,+z,-y', '-x,+z,+y', '-x,-z,-y', '+x,-z,+y', '+z,+y,-x', '+z,-y,+x', '-z,+y,+x', '-z,-y,-x', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z', '-x,+y,+z', '-z,-x,-y', '-z,+x,+y', '+z,+x,-y', '+z,-x,+y', '-y,-z,-x', '+y,-z,+x', '-y,+z,+x', '+y,+z,-x', '-y,-x,+z', '+y,+x,+z', '-y,+x,-z', '+y,-x,-z', '-x,-z,+y', '+x,-z,-y', '+x,+z,+y', '-x,+z,-y', '-z,-y,+x', '-z,+y,-x', '+z,-y,-x', '+z,+y,+x', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y+1/2,-z+1/2', '+z,+x+1/2,+y+1/2', '+z,-x+1/2,-y+1/2', '-z,-x+1/2,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z+1/2,+x+1/2', '-y,+z+1/2,-x+1/2', '+y,-z+1/2,-x+1/2', '-y,-z+1/2,+x+1/2', '+y,+x+1/2,-z+1/2', '-y,-x+1/2,-z+1/2', '+y,-x+1/2,+z+1/2', '-y,+x+1/2,+z+1/2', '+x,+z+1/2,-y+1/2', '-x,+z+1/2,+y+1/2', '-x,-z+1/2,-y+1/2', '+x,-z+1/2,+y+1/2', '+z,+y+1/2,-x+1/2', '+z,-y+1/2,+x+1/2', '-z,+y+1/2,+x+1/2', '-z,-y+1/2,-x+1/2', '-x,-y+1/2,-z+1/2', '+x,+y+1/2,-z+1/2', '+x,-y+1/2,+z+1/2', '-x,+y+1/2,+z+1/2', '-z,-x+1/2,-y+1/2', '-z,+x+1/2,+y+1/2', '+z,+x+1/2,-y+1/2', '+z,-x+1/2,+y+1/2', '-y,-z+1/2,-x+1/2', '+y,-z+1/2,+x+1/2', '-y,+z+1/2,+x+1/2', '+y,+z+1/2,-x+1/2', '-y,-x+1/2,+z+1/2', '+y,+x+1/2,+z+1/2', '-y,+x+1/2,-z+1/2', '+y,-x+1/2,-z+1/2', '-x,-z+1/2,+y+1/2', '+x,-z+1/2,-y+1/2', '+x,+z+1/2,+y+1/2', '-x,+z+1/2,-y+1/2', '-z,-y+1/2,+x+1/2', '-z,+y+1/2,-x+1/2', '+z,-y+1/2,-x+1/2', '+z,+y+1/2,+x+1/2', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '-x+1/2,+y,-z+1/2', '+x+1/2,-y,-z+1/2', '+z+1/2,+x,+y+1/2', '+z+1/2,-x,-y+1/2', '-z+1/2,-x,+y+1/2', '-z+1/2,+x,-y+1/2', '+y+1/2,+z,+x+1/2', '-y+1/2,+z,-x+1/2', '+y+1/2,-z,-x+1/2', '-y+1/2,-z,+x+1/2', '+y+1/2,+x,-z+1/2', '-y+1/2,-x,-z+1/2', '+y+1/2,-x,+z+1/2', '-y+1/2,+x,+z+1/2', '+x+1/2,+z,-y+1/2', '-x+1/2,+z,+y+1/2', '-x+1/2,-z,-y+1/2', '+x+1/2,-z,+y+1/2', '+z+1/2,+y,-x+1/2', '+z+1/2,-y,+x+1/2', '-z+1/2,+y,+x+1/2', '-z+1/2,-y,-x+1/2', '-x+1/2,-y,-z+1/2', '+x+1/2,+y,-z+1/2', '+x+1/2,-y,+z+1/2', '-x+1/2,+y,+z+1/2', '-z+1/2,-x,-y+1/2', '-z+1/2,+x,+y+1/2', '+z+1/2,+x,-y+1/2', '+z+1/2,-x,+y+1/2', '-y+1/2,-z,-x+1/2', '+y+1/2,-z,+x+1/2', '-y+1/2,+z,+x+1/2', '+y+1/2,+z,-x+1/2', '-y+1/2,-x,+z+1/2', '+y+1/2,+x,+z+1/2', '-y+1/2,+x,-z+1/2', '+y+1/2,-x,-z+1/2', '-x+1/2,-z,+y+1/2', '+x+1/2,-z,-y+1/2', '+x+1/2,+z,+y+1/2', '-x+1/2,+z,-y+1/2', '-z+1/2,-y,+x+1/2', '-z+1/2,+y,-x+1/2', '+z+1/2,-y,-x+1/2', '+z+1/2,+y,+x+1/2', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+z+1/2,+x+1/2,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x+1/2,+y', '-z+1/2,+x+1/2,-y', '+y+1/2,+z+1/2,+x', '-y+1/2,+z+1/2,-x', '+y+1/2,-z+1/2,-x', '-y+1/2,-z+1/2,+x', '+y+1/2,+x+1/2,-z', '-y+1/2,-x+1/2,-z', '+y+1/2,-x+1/2,+z', '-y+1/2,+x+1/2,+z', '+x+1/2,+z+1/2,-y', '-x+1/2,+z+1/2,+y', '-x+1/2,-z+1/2,-y', '+x+1/2,-z+1/2,+y', '+z+1/2,+y+1/2,-x', '+z+1/2,-y+1/2,+x', '-z+1/2,+y+1/2,+x', '-z+1/2,-y+1/2,-x', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '-z+1/2,-x+1/2,-y', '-z+1/2,+x+1/2,+y', '+z+1/2,+x+1/2,-y', '+z+1/2,-x+1/2,+y', '-y+1/2,-z+1/2,-x', '+y+1/2,-z+1/2,+x', '-y+1/2,+z+1/2,+x', '+y+1/2,+z+1/2,-x', '-y+1/2,-x+1/2,+z', '+y+1/2,+x+1/2,+z', '-y+1/2,+x+1/2,-z', '+y+1/2,-x+1/2,-z', '-x+1/2,-z+1/2,+y', '+x+1/2,-z+1/2,-y', '+x+1/2,+z+1/2,+y', '-x+1/2,+z+1/2,-y', '-z+1/2,-y+1/2,+x', '-z+1/2,+y+1/2,-x', '+z+1/2,-y+1/2,-x', '+z+1/2,+y+1/2,+x'], [226, 1, '     Fm-3c', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+x+1/2,+z+1/2,-y+1/2', '-x+1/2,+z+1/2,+y+1/2', '-x+1/2,-z+1/2,-y+1/2', '+x+1/2,-z+1/2,+y+1/2', '+z+1/2,+y+1/2,-x+1/2', '+z+1/2,-y+1/2,+x+1/2', '-z+1/2,+y+1/2,+x+1/2', '-z+1/2,-y+1/2,-x+1/2', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z', '-x,+y,+z', '-z,-x,-y', '-z,+x,+y', '+z,+x,-y', '+z,-x,+y', '-y,-z,-x', '+y,-z,+x', '-y,+z,+x', '+y,+z,-x', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-x+1/2,-z+1/2,+y+1/2', '+x+1/2,-z+1/2,-y+1/2', '+x+1/2,+z+1/2,+y+1/2', '-x+1/2,+z+1/2,-y+1/2', '-z+1/2,-y+1/2,+x+1/2', '-z+1/2,+y+1/2,-x+1/2', '+z+1/2,-y+1/2,-x+1/2', '+z+1/2,+y+1/2,+x+1/2', '+x,+y+1/2,+z+1/2', '-x,-y+1/2,+z+1/2', '-x,+y+1/2,-z+1/2', '+x,-y+1/2,-z+1/2', '+z,+x+1/2,+y+1/2', '+z,-x+1/2,-y+1/2', '-z,-x+1/2,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z+1/2,+x+1/2', '-y,+z+1/2,-x+1/2', '+y,-z+1/2,-x+1/2', '-y,-z+1/2,+x+1/2', '+y+1/2,+x+1,-z+1', '-y+1/2,-x+1,-z+1', '+y+1/2,-x+1,+z+1', '-y+1/2,+x+1,+z+1', '+x+1/2,+z+1,-y+1', '-x+1/2,+z+1,+y+1', '-x+1/2,-z+1,-y+1', '+x+1/2,-z+1,+y+1', '+z+1/2,+y+1,-x+1', '+z+1/2,-y+1,+x+1', '-z+1/2,+y+1,+x+1', '-z+1/2,-y+1,-x+1', '-x,-y+1/2,-z+1/2', '+x,+y+1/2,-z+1/2', '+x,-y+1/2,+z+1/2', '-x,+y+1/2,+z+1/2', '-z,-x+1/2,-y+1/2', '-z,+x+1/2,+y+1/2', '+z,+x+1/2,-y+1/2', '+z,-x+1/2,+y+1/2', '-y,-z+1/2,-x+1/2', '+y,-z+1/2,+x+1/2', '-y,+z+1/2,+x+1/2', '+y,+z+1/2,-x+1/2', '-y+1/2,-x+1,+z+1', '+y+1/2,+x+1,+z+1', '-y+1/2,+x+1,-z+1', '+y+1/2,-x+1,-z+1', '-x+1/2,-z+1,+y+1', '+x+1/2,-z+1,-y+1', '+x+1/2,+z+1,+y+1', '-x+1/2,+z+1,-y+1', '-z+1/2,-y+1,+x+1', '-z+1/2,+y+1,-x+1', '+z+1/2,-y+1,-x+1', '+z+1/2,+y+1,+x+1', '+x+1/2,+y,+z+1/2', '-x+1/2,-y,+z+1/2', '-x+1/2,+y,-z+1/2', '+x+1/2,-y,-z+1/2', '+z+1/2,+x,+y+1/2', '+z+1/2,-x,-y+1/2', '-z+1/2,-x,+y+1/2', '-z+1/2,+x,-y+1/2', '+y+1/2,+z,+x+1/2', '-y+1/2,+z,-x+1/2', '+y+1/2,-z,-x+1/2', '-y+1/2,-z,+x+1/2', '+y+1,+x+1/2,-z+1', '-y+1,-x+1/2,-z+1', '+y+1,-x+1/2,+z+1', '-y+1,+x+1/2,+z+1', '+x+1,+z+1/2,-y+1', '-x+1,+z+1/2,+y+1', '-x+1,-z+1/2,-y+1', '+x+1,-z+1/2,+y+1', '+z+1,+y+1/2,-x+1', '+z+1,-y+1/2,+x+1', '-z+1,+y+1/2,+x+1', '-z+1,-y+1/2,-x+1', '-x+1/2,-y,-z+1/2', '+x+1/2,+y,-z+1/2', '+x+1/2,-y,+z+1/2', '-x+1/2,+y,+z+1/2', '-z+1/2,-x,-y+1/2', '-z+1/2,+x,+y+1/2', '+z+1/2,+x,-y+1/2', '+z+1/2,-x,+y+1/2', '-y+1/2,-z,-x+1/2', '+y+1/2,-z,+x+1/2', '-y+1/2,+z,+x+1/2', '+y+1/2,+z,-x+1/2', '-y+1,-x+1/2,+z+1', '+y+1,+x+1/2,+z+1', '-y+1,+x+1/2,-z+1', '+y+1,-x+1/2,-z+1', '-x+1,-z+1/2,+y+1', '+x+1,-z+1/2,-y+1', '+x+1,+z+1/2,+y+1', '-x+1,+z+1/2,-y+1', '-z+1,-y+1/2,+x+1', '-z+1,+y+1/2,-x+1', '+z+1,-y+1/2,-x+1', '+z+1,+y+1/2,+x+1', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,-z', '+z+1/2,+x+1/2,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x+1/2,+y', '-z+1/2,+x+1/2,-y', '+y+1/2,+z+1/2,+x', '-y+1/2,+z+1/2,-x', '+y+1/2,-z+1/2,-x', '-y+1/2,-z+1/2,+x', '+y+1,+x+1,-z+1/2', '-y+1,-x+1,-z+1/2', '+y+1,-x+1,+z+1/2', '-y+1,+x+1,+z+1/2', '+x+1,+z+1,-y+1/2', '-x+1,+z+1,+y+1/2', '-x+1,-z+1,-y+1/2', '+x+1,-z+1,+y+1/2', '+z+1,+y+1,-x+1/2', '+z+1,-y+1,+x+1/2', '-z+1,+y+1,+x+1/2', '-z+1,-y+1,-x+1/2', '-x+1/2,-y+1/2,-z', '+x+1/2,+y+1/2,-z', '+x+1/2,-y+1/2,+z', '-x+1/2,+y+1/2,+z', '-z+1/2,-x+1/2,-y', '-z+1/2,+x+1/2,+y', '+z+1/2,+x+1/2,-y', '+z+1/2,-x+1/2,+y', '-y+1/2,-z+1/2,-x', '+y+1/2,-z+1/2,+x', '-y+1/2,+z+1/2,+x', '+y+1/2,+z+1/2,-x', '-y+1,-x+1,+z+1/2', '+y+1,+x+1,+z+1/2', '-y+1,+x+1,-z+1/2', '+y+1,-x+1,-z+1/2', '-x+1,-z+1,+y+1/2', '+x+1,-z+1,-y+1/2', '+x+1,+z+1,+y+1/2', '-x+1,+z+1,-y+1/2', '-z+1,-y+1,+x+1/2', '-z+1,+y+1,-x+1/2', '+z+1,-y+1,-x+1/2', '+z+1,+y+1,+x+1/2'], [227, 1, '     Fd-3m', 'Cubic', '+x,+y,+z', '-x,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,-z', '+x+1/2,-y,-z+1/2', '+z,+x,+y', '+z+1/2,-x,-y+1/2', '-z,-x+1/2,+y+1/2', '-z+1/2,+x+1/2,-y', '+y,+z,+x', '-y+1/2,+z+1/2,-x', '+y+1/2,-z,-x+1/2', '-y,-z+1/2,+x+1/2', '+y+3/4,+x+1/4,-z+3/4', '-y+1/4,-x+1/4,-z+1/4', '+y+1/4,-x+3/4,+z+3/4', '-y+3/4,+x+3/4,+z+1/4', '+x+3/4,+z+1/4,-y+3/4', '-x+3/4,+z+3/4,+y+1/4', '-x+1/4,-z+1/4,-y+1/4', '+x+1/4,-z+3/4,+y+3/4', '+z+3/4,+y+1/4,-x+3/4', '+z+1/4,-y+3/4,+x+3/4', '-z+3/4,+y+3/4,+x+1/4', '-z+1/4,-y+1/4,-x+1/4', '-x+1/4,-y+1/4,-z+1/4', '+x+1/4,+y+3/4,-z+3/4', '+x+3/4,-y+3/4,+z+1/4', '-x+3/4,+y+1/4,+z+3/4', '-z+1/4,-x+1/4,-y+1/4', '-z+3/4,+x+1/4,+y+3/4', '+z+1/4,+x+3/4,-y+3/4', '+z+3/4,-x+3/4,+y+1/4', '-y+1/4,-z+1/4,-x+1/4', '+y+3/4,-z+3/4,+x+1/4', '-y+3/4,+z+1/4,+x+3/4', '+y+1/4,+z+3/4,-x+3/4', '-y+1/2,-x,+z+1/2', '+y,+x,+z', '-y,+x+1/2,-z+1/2', '+y+1/2,-x+1/2,-z', '-x+1/2,-z,+y+1/2', '+x+1/2,-z+1/2,-y', '+x,+z,+y', '-x,+z+1/2,-y+1/2', '-z+1/2,-y,+x+1/2', '-z,+y+1/2,-x+1/2', '+z+1/2,-y+1/2,-x', '+z,+y,+x', '+x,+y+1/2,+z+1/2', '-x,-y+1,+z+1', '-x+1/2,+y+1,-z+1/2', '+x+1/2,-y+1/2,-z+1', '+z,+x+1/2,+y+1/2', '+z+1/2,-x+1/2,-y+1', '-z,-x+1,+y+1', '-z+1/2,+x+1,-y+1/2', '+y,+z+1/2,+x+1/2', '-y+1/2,+z+1,-x+1/2', '+y+1/2,-z+1/2,-x+1', '-y,-z+1,+x+1', '+y+3/4,+x+3/4,-z+5/4', '-y+1/4,-x+3/4,-z+3/4', '+y+1/4,-x+5/4,+z+5/4', '-y+3/4,+x+5/4,+z+3/4', '+x+3/4,+z+3/4,-y+5/4', '-x+3/4,+z+5/4,+y+3/4', '-x+1/4,-z+3/4,-y+3/4', '+x+1/4,-z+5/4,+y+5/4', '+z+3/4,+y+3/4,-x+5/4', '+z+1/4,-y+5/4,+x+5/4', '-z+3/4,+y+5/4,+x+3/4', '-z+1/4,-y+3/4,-x+3/4', '-x+1/4,-y+3/4,-z+3/4', '+x+1/4,+y+5/4,-z+5/4', '+x+3/4,-y+5/4,+z+3/4', '-x+3/4,+y+3/4,+z+5/4', '-z+1/4,-x+3/4,-y+3/4', '-z+3/4,+x+3/4,+y+5/4', '+z+1/4,+x+5/4,-y+5/4', '+z+3/4,-x+5/4,+y+3/4', '-y+1/4,-z+3/4,-x+3/4', '+y+3/4,-z+5/4,+x+3/4', '-y+3/4,+z+3/4,+x+5/4', '+y+1/4,+z+5/4,-x+5/4', '-y+1/2,-x+1/2,+z+1', '+y,+x+1/2,+z+1/2', '-y,+x+1,-z+1', '+y+1/2,-x+1,-z+1/2', '-x+1/2,-z+1/2,+y+1', '+x+1/2,-z+1,-y+1/2', '+x,+z+1/2,+y+1/2', '-x,+z+1,-y+1', '-z+1/2,-y+1/2,+x+1', '-z,+y+1,-x+1', '+z+1/2,-y+1,-x+1/2', '+z,+y+1/2,+x+1/2', '+x+1/2,+y,+z+1/2', '-x+1/2,-y+1/2,+z+1', '-x+1,+y+1/2,-z+1/2', '+x+1,-y,-z+1', '+z+1/2,+x,+y+1/2', '+z+1,-x,-y+1', '-z+1/2,-x+1/2,+y+1', '-z+1,+x+1/2,-y+1/2', '+y+1/2,+z,+x+1/2', '-y+1,+z+1/2,-x+1/2', '+y+1,-z,-x+1', '-y+1/2,-z+1/2,+x+1', '+y+5/4,+x+1/4,-z+5/4', '-y+3/4,-x+1/4,-z+3/4', '+y+3/4,-x+3/4,+z+5/4', '-y+5/4,+x+3/4,+z+3/4', '+x+5/4,+z+1/4,-y+5/4', '-x+5/4,+z+3/4,+y+3/4', '-x+3/4,-z+1/4,-y+3/4', '+x+3/4,-z+3/4,+y+5/4', '+z+5/4,+y+1/4,-x+5/4', '+z+3/4,-y+3/4,+x+5/4', '-z+5/4,+y+3/4,+x+3/4', '-z+3/4,-y+1/4,-x+3/4', '-x+3/4,-y+1/4,-z+3/4', '+x+3/4,+y+3/4,-z+5/4', '+x+5/4,-y+3/4,+z+3/4', '-x+5/4,+y+1/4,+z+5/4', '-z+3/4,-x+1/4,-y+3/4', '-z+5/4,+x+1/4,+y+5/4', '+z+3/4,+x+3/4,-y+5/4', '+z+5/4,-x+3/4,+y+3/4', '-y+3/4,-z+1/4,-x+3/4', '+y+5/4,-z+3/4,+x+3/4', '-y+5/4,+z+1/4,+x+5/4', '+y+3/4,+z+3/4,-x+5/4', '-y+1,-x,+z+1', '+y+1/2,+x,+z+1/2', '-y+1/2,+x+1/2,-z+1', '+y+1,-x+1/2,-z+1/2', '-x+1,-z,+y+1', '+x+1,-z+1/2,-y+1/2', '+x+1/2,+z,+y+1/2', '-x+1/2,+z+1/2,-y+1', '-z+1,-y,+x+1', '-z+1/2,+y+1/2,-x+1', '+z+1,-y+1/2,-x+1/2', '+z+1/2,+y,+x+1/2', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1,+z+1/2', '-x+1,+y+1,-z', '+x+1,-y+1/2,-z+1/2', '+z+1/2,+x+1/2,+y', '+z+1,-x+1/2,-y+1/2', '-z+1/2,-x+1,+y+1/2', '-z+1,+x+1,-y', '+y+1/2,+z+1/2,+x', '-y+1,+z+1,-x', '+y+1,-z+1/2,-x+1/2', '-y+1/2,-z+1,+x+1/2', '+y+5/4,+x+3/4,-z+3/4', '-y+3/4,-x+3/4,-z+1/4', '+y+3/4,-x+5/4,+z+3/4', '-y+5/4,+x+5/4,+z+1/4', '+x+5/4,+z+3/4,-y+3/4', '-x+5/4,+z+5/4,+y+1/4', '-x+3/4,-z+3/4,-y+1/4', '+x+3/4,-z+5/4,+y+3/4', '+z+5/4,+y+3/4,-x+3/4', '+z+3/4,-y+5/4,+x+3/4', '-z+5/4,+y+5/4,+x+1/4', '-z+3/4,-y+3/4,-x+1/4', '-x+3/4,-y+3/4,-z+1/4', '+x+3/4,+y+5/4,-z+3/4', '+x+5/4,-y+5/4,+z+1/4', '-x+5/4,+y+3/4,+z+3/4', '-z+3/4,-x+3/4,-y+1/4', '-z+5/4,+x+3/4,+y+3/4', '+z+3/4,+x+5/4,-y+3/4', '+z+5/4,-x+5/4,+y+1/4', '-y+3/4,-z+3/4,-x+1/4', '+y+5/4,-z+5/4,+x+1/4', '-y+5/4,+z+3/4,+x+3/4', '+y+3/4,+z+5/4,-x+3/4', '-y+1,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z', '-y+1/2,+x+1,-z+1/2', '+y+1,-x+1,-z', '-x+1,-z+1/2,+y+1/2', '+x+1,-z+1,-y', '+x+1/2,+z+1/2,+y', '-x+1/2,+z+1,-y+1/2', '-z+1,-y+1/2,+x+1/2', '-z+1/2,+y+1,-x+1/2', '+z+1,-y+1,-x', '+z+1/2,+y+1/2,+x'], [228, 1, '     Fd-3c', 'Cubic', '+x,+y,+z', '-x,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,-z', '+x+1/2,-y,-z+1/2', '+z,+x,+y', '+z+1/2,-x,-y+1/2', '-z,-x+1/2,+y+1/2', '-z+1/2,+x+1/2,-y', '+y,+z,+x', '-y+1/2,+z+1/2,-x', '+y+1/2,-z,-x+1/2', '-y,-z+1/2,+x+1/2', '+y+3/4,+x+1/4,-z+3/4', '-y+1/4,-x+1/4,-z+1/4', '+y+1/4,-x+3/4,+z+3/4', '-y+3/4,+x+3/4,+z+1/4', '+x+3/4,+z+1/4,-y+3/4', '-x+3/4,+z+3/4,+y+1/4', '-x+1/4,-z+1/4,-y+1/4', '+x+1/4,-z+3/4,+y+3/4', '+z+3/4,+y+1/4,-x+3/4', '+z+1/4,-y+3/4,+x+3/4', '-z+3/4,+y+3/4,+x+1/4', '-z+1/4,-y+1/4,-x+1/4', '-x+3/4,-y+3/4,-z+3/4', '+x+3/4,+y+1/4,-z+1/4', '+x+1/4,-y+1/4,+z+3/4', '-x+1/4,+y+3/4,+z+1/4', '-z+3/4,-x+3/4,-y+3/4', '-z+1/4,+x+3/4,+y+1/4', '+z+3/4,+x+1/4,-y+1/4', '+z+1/4,-x+1/4,+y+3/4', '-y+3/4,-z+3/4,-x+3/4', '+y+1/4,-z+1/4,+x+3/4', '-y+1/4,+z+3/4,+x+1/4', '+y+3/4,+z+1/4,-x+1/4', '-y,-x+1/2,+z', '+y+1/2,+x+1/2,+z+1/2', '-y+1/2,+x,-z', '+y,-x,-z+1/2', '-x,-z+1/2,+y', '+x,-z,-y+1/2', '+x+1/2,+z+1/2,+y+1/2', '-x+1/2,+z,-y', '-z,-y+1/2,+x', '-z+1/2,+y,-x', '+z,-y,-x+1/2', '+z+1/2,+y+1/2,+x+1/2', '+x,+y+1/2,+z+1/2', '-x,-y+1,+z+1', '-x+1/2,+y+1,-z+1/2', '+x+1/2,-y+1/2,-z+1', '+z,+x+1/2,+y+1/2', '+z+1/2,-x+1/2,-y+1', '-z,-x+1,+y+1', '-z+1/2,+x+1,-y+1/2', '+y,+z+1/2,+x+1/2', '-y+1/2,+z+1,-x+1/2', '+y+1/2,-z+1/2,-x+1', '-y,-z+1,+x+1', '+y+3/4,+x+3/4,-z+5/4', '-y+1/4,-x+3/4,-z+3/4', '+y+1/4,-x+5/4,+z+5/4', '-y+3/4,+x+5/4,+z+3/4', '+x+3/4,+z+3/4,-y+5/4', '-x+3/4,+z+5/4,+y+3/4', '-x+1/4,-z+3/4,-y+3/4', '+x+1/4,-z+5/4,+y+5/4', '+z+3/4,+y+3/4,-x+5/4', '+z+1/4,-y+5/4,+x+5/4', '-z+3/4,+y+5/4,+x+3/4', '-z+1/4,-y+3/4,-x+3/4', '-x+3/4,-y+5/4,-z+5/4', '+x+3/4,+y+3/4,-z+3/4', '+x+1/4,-y+3/4,+z+5/4', '-x+1/4,+y+5/4,+z+3/4', '-z+3/4,-x+5/4,-y+5/4', '-z+1/4,+x+5/4,+y+3/4', '+z+3/4,+x+3/4,-y+3/4', '+z+1/4,-x+3/4,+y+5/4', '-y+3/4,-z+5/4,-x+5/4', '+y+1/4,-z+3/4,+x+5/4', '-y+1/4,+z+5/4,+x+3/4', '+y+3/4,+z+3/4,-x+3/4', '-y,-x+1,+z+1/2', '+y+1/2,+x+1,+z+1', '-y+1/2,+x+1/2,-z+1/2', '+y,-x+1/2,-z+1', '-x,-z+1,+y+1/2', '+x,-z+1/2,-y+1', '+x+1/2,+z+1,+y+1', '-x+1/2,+z+1/2,-y+1/2', '-z,-y+1,+x+1/2', '-z+1/2,+y+1/2,-x+1/2', '+z,-y+1/2,-x+1', '+z+1/2,+y+1,+x+1', '+x+1/2,+y,+z+1/2', '-x+1/2,-y+1/2,+z+1', '-x+1,+y+1/2,-z+1/2', '+x+1,-y,-z+1', '+z+1/2,+x,+y+1/2', '+z+1,-x,-y+1', '-z+1/2,-x+1/2,+y+1', '-z+1,+x+1/2,-y+1/2', '+y+1/2,+z,+x+1/2', '-y+1,+z+1/2,-x+1/2', '+y+1,-z,-x+1', '-y+1/2,-z+1/2,+x+1', '+y+5/4,+x+1/4,-z+5/4', '-y+3/4,-x+1/4,-z+3/4', '+y+3/4,-x+3/4,+z+5/4', '-y+5/4,+x+3/4,+z+3/4', '+x+5/4,+z+1/4,-y+5/4', '-x+5/4,+z+3/4,+y+3/4', '-x+3/4,-z+1/4,-y+3/4', '+x+3/4,-z+3/4,+y+5/4', '+z+5/4,+y+1/4,-x+5/4', '+z+3/4,-y+3/4,+x+5/4', '-z+5/4,+y+3/4,+x+3/4', '-z+3/4,-y+1/4,-x+3/4', '-x+5/4,-y+3/4,-z+5/4', '+x+5/4,+y+1/4,-z+3/4', '+x+3/4,-y+1/4,+z+5/4', '-x+3/4,+y+3/4,+z+3/4', '-z+5/4,-x+3/4,-y+5/4', '-z+3/4,+x+3/4,+y+3/4', '+z+5/4,+x+1/4,-y+3/4', '+z+3/4,-x+1/4,+y+5/4', '-y+5/4,-z+3/4,-x+5/4', '+y+3/4,-z+1/4,+x+5/4', '-y+3/4,+z+3/4,+x+3/4', '+y+5/4,+z+1/4,-x+3/4', '-y+1/2,-x+1/2,+z+1/2', '+y+1,+x+1/2,+z+1', '-y+1,+x,-z+1/2', '+y+1/2,-x,-z+1', '-x+1/2,-z+1/2,+y+1/2', '+x+1/2,-z,-y+1', '+x+1,+z+1/2,+y+1', '-x+1,+z,-y+1/2', '-z+1/2,-y+1/2,+x+1/2', '-z+1,+y,-x+1/2', '+z+1/2,-y,-x+1', '+z+1,+y+1/2,+x+1', '+x+1/2,+y+1/2,+z', '-x+1/2,-y+1,+z+1/2', '-x+1,+y+1,-z', '+x+1,-y+1/2,-z+1/2', '+z+1/2,+x+1/2,+y', '+z+1,-x+1/2,-y+1/2', '-z+1/2,-x+1,+y+1/2', '-z+1,+x+1,-y', '+y+1/2,+z+1/2,+x', '-y+1,+z+1,-x', '+y+1,-z+1/2,-x+1/2', '-y+1/2,-z+1,+x+1/2', '+y+5/4,+x+3/4,-z+3/4', '-y+3/4,-x+3/4,-z+1/4', '+y+3/4,-x+5/4,+z+3/4', '-y+5/4,+x+5/4,+z+1/4', '+x+5/4,+z+3/4,-y+3/4', '-x+5/4,+z+5/4,+y+1/4', '-x+3/4,-z+3/4,-y+1/4', '+x+3/4,-z+5/4,+y+3/4', '+z+5/4,+y+3/4,-x+3/4', '+z+3/4,-y+5/4,+x+3/4', '-z+5/4,+y+5/4,+x+1/4', '-z+3/4,-y+3/4,-x+1/4', '-x+5/4,-y+5/4,-z+3/4', '+x+5/4,+y+3/4,-z+1/4', '+x+3/4,-y+3/4,+z+3/4', '-x+3/4,+y+5/4,+z+1/4', '-z+5/4,-x+5/4,-y+3/4', '-z+3/4,+x+5/4,+y+1/4', '+z+5/4,+x+3/4,-y+1/4', '+z+3/4,-x+3/4,+y+3/4', '-y+5/4,-z+5/4,-x+3/4', '+y+3/4,-z+3/4,+x+3/4', '-y+3/4,+z+5/4,+x+1/4', '+y+5/4,+z+3/4,-x+1/4', '-y+1/2,-x+1,+z', '+y+1,+x+1,+z+1/2', '-y+1,+x+1/2,-z', '+y+1/2,-x+1/2,-z+1/2', '-x+1/2,-z+1,+y', '+x+1/2,-z+1/2,-y+1/2', '+x+1,+z+1,+y+1/2', '-x+1,+z+1/2,-y', '-z+1/2,-y+1,+x', '-z+1,+y+1/2,-x', '+z+1/2,-y+1/2,-x+1/2', '+z+1,+y+1,+x+1/2'], [229, 1, '     Im-3m', 'Cubic', '+x,+y,+z', '-x,-y,+z', '-x,+y,-z', '+x,-y,-z', '+z,+x,+y', '+z,-x,-y', '-z,-x,+y', '-z,+x,-y', '+y,+z,+x', '-y,+z,-x', '+y,-z,-x', '-y,-z,+x', '+y,+x,-z', '-y,-x,-z', '+y,-x,+z', '-y,+x,+z', '+x,+z,-y', '-x,+z,+y', '-x,-z,-y', '+x,-z,+y', '+z,+y,-x', '+z,-y,+x', '-z,+y,+x', '-z,-y,-x', '-x,-y,-z', '+x,+y,-z', '+x,-y,+z', '-x,+y,+z', '-z,-x,-y', '-z,+x,+y', '+z,+x,-y', '+z,-x,+y', '-y,-z,-x', '+y,-z,+x', '-y,+z,+x', '+y,+z,-x', '-y,-x,+z', '+y,+x,+z', '-y,+x,-z', '+y,-x,-z', '-x,-z,+y', '+x,-z,-y', '+x,+z,+y', '-x,+z,-y', '-z,-y,+x', '-z,+y,-x', '+z,-y,-x', '+z,+y,+x', '+x+1/2,+y+1/2,+z+1/2', '-x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z+1/2', '+z+1/2,+x+1/2,+y+1/2', '+z+1/2,-x+1/2,-y+1/2', '-z+1/2,-x+1/2,+y+1/2', '-z+1/2,+x+1/2,-y+1/2', '+y+1/2,+z+1/2,+x+1/2', '-y+1/2,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x+1/2', '-y+1/2,-z+1/2,+x+1/2', '+y+1/2,+x+1/2,-z+1/2', '-y+1/2,-x+1/2,-z+1/2', '+y+1/2,-x+1/2,+z+1/2', '-y+1/2,+x+1/2,+z+1/2', '+x+1/2,+z+1/2,-y+1/2', '-x+1/2,+z+1/2,+y+1/2', '-x+1/2,-z+1/2,-y+1/2', '+x+1/2,-z+1/2,+y+1/2', '+z+1/2,+y+1/2,-x+1/2', '+z+1/2,-y+1/2,+x+1/2', '-z+1/2,+y+1/2,+x+1/2', '-z+1/2,-y+1/2,-x+1/2', '-x+1/2,-y+1/2,-z+1/2', '+x+1/2,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z+1/2', '-z+1/2,-x+1/2,-y+1/2', '-z+1/2,+x+1/2,+y+1/2', '+z+1/2,+x+1/2,-y+1/2', '+z+1/2,-x+1/2,+y+1/2', '-y+1/2,-z+1/2,-x+1/2', '+y+1/2,-z+1/2,+x+1/2', '-y+1/2,+z+1/2,+x+1/2', '+y+1/2,+z+1/2,-x+1/2', '-y+1/2,-x+1/2,+z+1/2', '+y+1/2,+x+1/2,+z+1/2', '-y+1/2,+x+1/2,-z+1/2', '+y+1/2,-x+1/2,-z+1/2', '-x+1/2,-z+1/2,+y+1/2', '+x+1/2,-z+1/2,-y+1/2', '+x+1/2,+z+1/2,+y+1/2', '-x+1/2,+z+1/2,-y+1/2', '-z+1/2,-y+1/2,+x+1/2', '-z+1/2,+y+1/2,-x+1/2', '+z+1/2,-y+1/2,-x+1/2', '+z+1/2,+y+1/2,+x+1/2'], [230, 1, '     Ia-3d', 'Cubic', '+x,+y,+z', '-x+1/2,-y,+z+1/2', '-x,+y+1/2,-z+1/2', '+x+1/2,-y+1/2,-z', '+z,+x,+y', '+z+1/2,-x+1/2,-y', '-z+1/2,-x,+y+1/2', '-z,+x+1/2,-y+1/2', '+y,+z,+x', '-y,+z+1/2,-x+1/2', '+y+1/2,-z+1/2,-x', '-y+1/2,-z,+x+1/2', '+y+3/4,+x+1/4,-z+1/4', '-y+3/4,-x+3/4,-z+3/4', '+y+1/4,-x+1/4,+z+3/4', '-y+1/4,+x+3/4,+z+1/4', '+x+3/4,+z+1/4,-y+1/4', '-x+1/4,+z+3/4,+y+1/4', '-x+3/4,-z+3/4,-y+3/4', '+x+1/4,-z+1/4,+y+3/4', '+z+3/4,+y+1/4,-x+1/4', '+z+1/4,-y+1/4,+x+3/4', '-z+1/4,+y+3/4,+x+1/4', '-z+3/4,-y+3/4,-x+3/4', '-x,-y,-z', '+x+1/2,+y,-z+1/2', '+x,-y+1/2,+z+1/2', '-x+1/2,+y+1/2,+z', '-z,-x,-y', '-z+1/2,+x+1/2,+y', '+z+1/2,+x,-y+1/2', '+z,-x+1/2,+y+1/2', '-y,-z,-x', '+y,-z+1/2,+x+1/2', '-y+1/2,+z+1/2,+x', '+y+1/2,+z,-x+1/2', '-y+1/4,-x+3/4,+z+3/4', '+y+1/4,+x+1/4,+z+1/4', '-y+3/4,+x+3/4,-z+1/4', '+y+3/4,-x+1/4,-z+3/4', '-x+1/4,-z+3/4,+y+3/4', '+x+3/4,-z+1/4,-y+3/4', '+x+1/4,+z+1/4,+y+1/4', '-x+3/4,+z+3/4,-y+1/4', '-z+1/4,-y+3/4,+x+3/4', '-z+3/4,+y+3/4,-x+1/4', '+z+3/4,-y+1/4,-x+3/4', '+z+1/4,+y+1/4,+x+1/4', '+x+1/2,+y+1/2,+z+1/2', '-x+1,-y+1/2,+z+1', '-x+1/2,+y+1,-z+1', '+x+1,-y+1,-z+1/2', '+z+1/2,+x+1/2,+y+1/2', '+z+1,-x+1,-y+1/2', '-z+1,-x+1/2,+y+1', '-z+1/2,+x+1,-y+1', '+y+1/2,+z+1/2,+x+1/2', '-y+1/2,+z+1,-x+1', '+y+1,-z+1,-x+1/2', '-y+1,-z+1/2,+x+1', '+y+5/4,+x+3/4,-z+3/4', '-y+5/4,-x+5/4,-z+5/4', '+y+3/4,-x+3/4,+z+5/4', '-y+3/4,+x+5/4,+z+3/4', '+x+5/4,+z+3/4,-y+3/4', '-x+3/4,+z+5/4,+y+3/4', '-x+5/4,-z+5/4,-y+5/4', '+x+3/4,-z+3/4,+y+5/4', '+z+5/4,+y+3/4,-x+3/4', '+z+3/4,-y+3/4,+x+5/4', '-z+3/4,+y+5/4,+x+3/4', '-z+5/4,-y+5/4,-x+5/4', '-x+1/2,-y+1/2,-z+1/2', '+x+1,+y+1/2,-z+1', '+x+1/2,-y+1,+z+1', '-x+1,+y+1,+z+1/2', '-z+1/2,-x+1/2,-y+1/2', '-z+1,+x+1,+y+1/2', '+z+1,+x+1/2,-y+1', '+z+1/2,-x+1,+y+1', '-y+1/2,-z+1/2,-x+1/2', '+y+1/2,-z+1,+x+1', '-y+1,+z+1,+x+1/2', '+y+1,+z+1/2,-x+1', '-y+3/4,-x+5/4,+z+5/4', '+y+3/4,+x+3/4,+z+3/4', '-y+5/4,+x+5/4,-z+3/4', '+y+5/4,-x+3/4,-z+5/4', '-x+3/4,-z+5/4,+y+5/4', '+x+5/4,-z+3/4,-y+5/4', '+x+3/4,+z+3/4,+y+3/4', '-x+5/4,+z+5/4,-y+3/4', '-z+3/4,-y+5/4,+x+5/4', '-z+5/4,+y+5/4,-x+3/4', '+z+5/4,-y+3/4,-x+5/4', '+z+3/4,+y+3/4,+x+3/4']]

              // symmetry here
              var symops,nops,j,groupfound,setting,gname,cname,groupname,groupnumber;

              groupname = "P1";
              if (data.includes("_symmetry_space_group_name_H-M")) {
                 groupname = data.split("_symmetry_space_group_name_H-M")[1].split("\n")[0].trim();
              } 
              groupnumber = 1;
              if (data.includes("_space_group_IT_number")) {
                 groupnumber = data.split("_space_group_IT_number")[1].split("\n")[0].trim();
              }
              cname = "Triclinic"
              if (data.includes("_symmetry_cell_setting")) {
                 cname = jsUcfirst(data.split("_symmetry_cell_setting")[1].split("\n")[0].trim());
              }
           
              symops = ["x,y,z"];
              if (data.includes("_symmetry_equiv_pos_as_xyz") || data.includes("_space_group_symop_operation_xyz")) {
                 if (data.includes("_symmetry_equiv_pos_as_xyz")) {
                    symops = data.split("_symmetry_equiv_pos_as_xyz")[1].split("loop_")[0].trim().replace(/'/g,"").replace(/ /g, "").split("\n");
                 } else {
                    symops = data.split("_space_group_symop_operation_xyz")[1].split("loop_")[0].trim().replace(/'/g,"").replace(/ /g, "").split("\n");
                 }
                 nops   = symops.length-1;
                 document.getElementById("symmetryops").value = symops.slice(0,nops).join("\n");

                 j=0;
                 groupfound = false;
                 while ((!groupfound) && (j<symall.length)) {
                    nops = symall[j].length;
                    groupfound = compare_ops(symall[j].slice(4,nops),symops);
                    j += 1;
                 }

                 if (groupfound) {
                    groupnumber = symall[j-1][0];
                    setting = symall[j-1][1];
                    gname   = symall[j-1][2];
                    cname   = symall[j-1][3];
                 } else {
                    setting = 0;
                    gname = groupname.replace(" ","").replace("\'","");
                 }
                 document.getElementById("lattice_group").value = gname.trim();
                 document.getElementById("lattice_group_setting").value = setting;
                 document.getElementById("lattice_group_number").value  = groupnumber;
                 document.getElementById("crystal_system").value  = cname;
              }

              // geometry here 
              var loops = data.split("loop_")
              j=0;
              var geomfound = false;
              while ((!geomfound) && (j<loops.length)) {
                 geomfound = loops[j].includes("_atom_site_type_symbol");
                 geomfound = geomfound || loops[j].includes("_atom_site_label");
                 j += 1;
              }
              var looplines = loops[j-1].trim().split("\n");
              var isym,ix,iy,iz,istart,ss,symb;
              isym = -1; ix = -1; iy = -1; iz = -1; istart = -1;
              for (j=0; j<looplines.length; ++j) {
                  if (looplines[j].includes("_atom_site_type_symbol")) {
                     isym = j;
                  }
                  if ((looplines[j].includes("_atom_site_label")) && (isym<0)) {
                     isym = j;
                  }
                  if (looplines[j].includes("_atom_site_fract_x")) {
                     ix = j;
                  }
                  if (looplines[j].includes("_atom_site_fract_y")) {
                     iy = j;
                  }
                  if (looplines[j].includes("_atom_site_fract_z")) {
                     iz = j;
                  }
                  if (looplines[j].includes("_")) {istart = j;}
               }
               console.log(isym);
               console.log(ix); console.log(iy); console.log(iz);
               istart += 1;
               var fracgeom = [] ;
               for (j=istart; j<looplines.length; ++j) {
                  ss = looplines[j].trim().split(/[ ,]+/);
                  if (ss[isym].length>1) {
                     symb = ss[isym].charAt(0);
                     if (isLetter(ss[isym].charAt(1))) { symb += ss[isym].charAt(1); }
                  } else {
                     symb = ss[isym].charAt(0);
                  }
                  x = parseFloat(ss[ix].split("(")[0]); 
                  y = parseFloat(ss[iy].split("(")[0]);
                  z = parseFloat(ss[iz].split("(")[0]);

                  fracgeom2 = symmetry_genfracgeom(symops,symb,x,y,z);
                  for (n=0; n<fracgeom2.length; ++n) {
                     m = 0;
                     geomfound = false;
                     while ((!geomfound) && (m<fracgeom.length)) {
                        geomfound = (fracgeom2[n][0]==fracgeom[m][0]);
                        geomfound = geomfound && (Math.abs(fracgeom2[n][1]-fracgeom[m][1])<1.0e-6);
                        geomfound = geomfound && (Math.abs(fracgeom2[n][2]-fracgeom[m][2])<1.0e-6);
                        geomfound = geomfound && (Math.abs(fracgeom2[n][3]-fracgeom[m][3])<1.0e-6);
                        m += 1;
                     }
                     if (!geomfound) {
                        fracgeom.push(fracgeom2[n]);
                     }
                  }
               }

	       // unitcell update
               ucell = jmsfetchucell();
               var a1 = ucell[1];
               var a2 = ucell[2];
               var a3 = ucell[3];
               fracdat = '';
               xyzdat  = '';
               for (j=0; j<fracgeom.length; ++j) {
                  fracdat += fracgeom[j][0] + " " + fracgeom[j][1].toFixed(6)
                                            + " " + fracgeom[j][2].toFixed(6)
                                            + " " + fracgeom[j][3].toFixed(6) + "\n";
                  x = a1[0]*fracgeom[j][1] + a2[0]*fracgeom[j][2] + a3[0]*fracgeom[j][3];
                  y = a1[1]*fracgeom[j][1] + a2[1]*fracgeom[j][2] + a3[1]*fracgeom[j][3];
                  z = a1[2]*fracgeom[j][1] + a2[2]*fracgeom[j][2] + a3[2]*fracgeom[j][3];
                  xyzdat += fracgeom[j][0] + " " + x.toFixed(6)
                                           + " " + y.toFixed(6)
                                           + " " + z.toFixed(6) + "\n";
               }
               document.getElementById("fractionalCoords").value = fracdat;
               document.getElementById("cartesianCoords").value  = xyzdat;
               console.log(xyzdat);
               console.log(fracdat);
               nion = fracgeom.length;
               xyzdat = nion + "\n\n" + xyzdat;
               data = xyzdat;
           }

           return data;
        } 

        function myPick() {
           alert('you clicked on atom with index=' + arguments[2]);
        }

        var jm_cmdlist = [];
        var jm_cmdlist2 = [];

        function jm_cmdlist_reset() {
           m_cmdlist  = [];
           jm_cmdlist2 = [];
        }
        function jm_cmdlist_add() {
           var moldat = "\"model reset\"\n" + exMod() + "end \"model reset\"";
           var orient = jmvar("script('show orientation')");
           orient =  "reset; " + orient.split("reset;")[1];
           jm_cmdlist.push([moldat,orient]);
           var n = jm_cmdlist.length;
           if (n>20) {
              jm_cmdlist.shift();
           }
        }
        function jm_cmdlist2_add() {
           var moldat = "\"model reset\"\n" + exMod() + "end \"model reset\"";
           var orient = jmvar("script('show orientation')");
           orient =  "reset; " + orient.split("reset;")[1];
           jm_cmdlist2.push([moldat,orient]);
           var m = jm_cmdlist2.length;
           if (m>40) {
              jm_cmdlist2.shift();
           }
        }

        function jm_cmdlist_undo() {
           var n = jm_cmdlist.length;
           if (n>0) {
              jm_cmdlist2_add();
              var cdat = jm_cmdlist.pop();
              var moldat = cdat[0];
              var orient = cdat[1];
              var scpt = "load data "+moldat + " ;";
                  scpt += 'select Meitnerium; color atoms TRANSLUCENT orange; label "e-"; color label cpk; ';
              //Jmol.script(jmolApplet0, "load data "+moldat);
              Jmol.script(jmolApplet0, scpt);
              //Jmol.script(jmolApplet0, orient);
           }
        }
        function jm_cmdlist_redo() {
           var m = jm_cmdlist2.length;
           if (m>0) {
              jm_cmdlist_add();
              var cdat = jm_cmdlist2.pop();
              var moldat = cdat[0];
              var orient = cdat[1];
              var scpt = "load data "+moldat + " ;";
                  scpt += 'select Meitnerium; color atoms TRANSLUCENT orange; label "e-"; color label cpk; ';
              //Jmol.script(jmolApplet0, "load data "+moldat);
              Jmol.script(jmolApplet0, scpt);
              //Jmol.script(jmolApplet0, orient);
           }
        }


        // basic JMOL routines - all other routines call these functions
        function jms(scpt) { 
           jm_cmdlist_add();
           Jmol.script(jmolApplet0, scpt); 
           jmsetcoordboxes();
        }
        function jms0(scpt) { 
           Jmol.script(jmolApplet0, scpt); 
        }
        function jmstr(scpt) { 
           return Jmol.getPropertyAsString(jmolApplet0,scpt); 
        }
        function jmvar(x) {
           return Jmol.evaluateVar(jmolApplet0, x);
        }



        function jmreset() { jms("load smiles \"" + "C" + "\"; set modelKitMode;"); }



        // ****************************
        // *                          *
        // *     a1a2a3_to_lat        *
        // *                          *
        // ****************************
        function a1a2a3_to_lat(a1,a2,a3) {
           console.log("A1=",a1);
           console.log("A2=",a2);
           console.log("A3=",a3);
           var a = Math.sqrt(a1[0]*a1[0] + a1[1]*a1[1] + a1[2]*a1[2]);
           var b = Math.sqrt(a2[0]*a2[0] + a2[1]*a2[1] + a2[2]*a2[2]);
           var c = Math.sqrt(a3[0]*a3[0] + a3[1]*a3[1] + a3[2]*a3[2]);
           console.log("a=",a);
           console.log("b=",b);
           console.log("c=",c);

           var d2 = (a2[0]-a3[0])*(a2[0]-a3[0])
                  + (a2[1]-a3[1])*(a2[1]-a3[1])
                  + (a2[2]-a3[2])*(a2[2]-a3[2]);
           var alpha = (b*b + c*c - d2)/(2.00*b*c);
           alpha = Math.acos(alpha)*180.00/Math.PI;

           d2 = (a3[0]-a1[0])*(a3[0]-a1[0])
              + (a3[1]-a1[1])*(a3[1]-a1[1])
              + (a3[2]-a1[2])*(a3[2]-a1[2]);
           var beta = (c*c + a*a - d2)/(2.00*c*a);
           beta = Math.acos(beta)*180.00/Math.PI;

           d2 = (a1[0]-a2[0])*(a1[0]-a2[0])
              + (a1[1]-a2[1])*(a1[1]-a2[1])
              + (a1[2]-a2[2])*(a1[2]-a2[2]);
           var gamma = (a*a + b*b - d2)/(2.00*a*b);
           gamma = Math.acos(gamma)*180.00/Math.PI;

           return [a,b,c,alpha,beta,gamma];
        }

        // ****************************
        // *                          *
        // *     a1a2a3_to_b1b2b3     *
        // *                          *
        // ****************************
        function a1a2a3_to_b1b2b3(a1,a2,a3) {
           var   b1 = [a2[1]*a3[2]-a2[2]*a3[1], a2[2]*a3[0]-a2[0]*a3[2], a2[0]*a3[1]-a2[1]*a3[0]];
           var   b2 = [a3[1]*a1[2]-a3[2]*a1[1], a3[2]*a1[0]-a3[0]*a1[2], a3[0]*a1[1]-a3[1]*a1[0]];
           var   b3 = [a1[1]*a2[2]-a1[2]*a2[1], a1[2]*a2[0]-a1[0]*a2[2], a1[0]*a2[1]-a1[1]*a2[0]];
           var vol = a1[0]*b1[0] + a1[1]*b1[1] + a1[2]*b1[2];
           b1[0] /= vol; b1[1] /= vol; b1[2] /= vol;
           b2[0] /= vol; b2[1] /= vol; b2[2] /= vol;
           b3[0] /= vol; b3[1] /= vol; b3[2] /= vol;
           return [b1,b2,b3];
        }

        // ****************************
        // *                          *
        // *     a1a2a3_to_volume     *
        // *                          *
        // ****************************
        function a1a2a3_to_volume(a1,a2,a3) {
           var   b1 = [a2[1]*a3[2]-a2[2]*a3[1], a2[2]*a3[0]-a2[0]*a3[2], a2[0]*a3[1]-a2[1]*a3[0]];
           var   b2 = [a3[1]*a1[2]-a3[2]*a1[1], a3[2]*a1[0]-a3[0]*a1[2], a3[0]*a1[1]-a3[1]*a1[0]];
           var   b3 = [a1[1]*a2[2]-a1[2]*a2[1], a1[2]*a2[0]-a1[0]*a2[2], a1[0]*a2[1]-a1[1]*a2[0]];
           var vol = Math.abs(a1[0]*b1[0] + a1[1]*b1[1] + a1[2]*b1[2]);
           return vol;
        }

        // ****************************
        // *                          *
        // *     a1a2a3_to_lattice    *
        // *                          *
        // ****************************
        function a1a2a3_to_lattice(a1,a2,a3) {
           var [b1,b2,b3] = a1a2a3_to_b1b2b3(a1,a2,a3);
           var lat        = a1a2a3_to_lat(a1,a2,a3);

           return [a1,a2,a3,b1,b2,b3,lat];
        }

        // ****************************
        // *                          *
        // *     abcabg_to_lattice    *
        // *                          *
        // ****************************
        function abcabg_to_lattice(a,b,c,alpha,beta,gamma) {
           var conv = Math.PI/180.0;
           var cdist = [a,b,c];
           var cang  = [alpha*conv,beta*conv,gamma*conv];
           var gmat = [cdist[0]*cdist[0],
                       cdist[1]*cdist[0]*Math.cos(cang[2]),
                       cdist[2]*cdist[0]*Math.cos(cang[1]),
                       cdist[0]*cdist[1]*Math.cos(cang[2]),
                       cdist[1]*cdist[1],
                       cdist[2]*cdist[1]*Math.cos(cang[0]),
                       cdist[0]*cdist[2]*Math.cos(cang[1]),
                       cdist[1]*cdist[2]*Math.cos(cang[0]),
                       cdist[2]*cdist[2]]
           var deter3 = gmat[0]*(gmat[4]*gmat[8]-gmat[7]*gmat[5])
                      - gmat[3]*(gmat[1]*gmat[8]-gmat[7]*gmat[2])
                      + gmat[6]*(gmat[1]*gmat[5]-gmat[4]*gmat[2]);
           var vol = Math.sqrt(deter3)

           var c1=Math.cos(cang[0]);
           var c2=Math.cos(cang[1]);
           var c3=Math.cos(cang[2]);
           var s3=Math.sin(cang[2]);

           var a1 = [cdist[0]*s3,              cdist[0]*c3, 0.0];
           var a2 = [0.0,                      cdist[1],    0.0];
           var a3 = [(cdist[2]*(c2-c1*c3)/s3), cdist[2]*c1, (vol/(cdist[0]*cdist[1]*s3))];

           var [b1,b2,b3] = a1a2a3_to_b1b2b3(a1,a2,a3);
           var lat        = [a,b,c,alpha,beta,gamma];

           return [a1,a2,a3,b1,b2,b3,lat];
        }

        // ****************************
        // *                          *
        // *     vec3_to_string3      *
        // *                          *
        // ****************************
        function vec3_to_string3(vec3) {
           console.log("vec3=",vec3);
           var string3 = vec3[0].toFixed(6) + " " + vec3[1].toFixed(6) + " " + vec3[2].toFixed(6);
           return string3;
        }

        // ****************************
        // *                          *
        // *     string3_to_vec3      *
        // *                          *
        // ****************************
        function string3_to_vec3(string3) {
           var x = string3.trim().split(/[ ,]+/);
           return  [parseFloat(x[0]),parseFloat(x[1]),parseFloat(x[2])] ;
        }


        // ****************************
        // *                          *
        // *    xyzrow2_to_lattice    *
        // *                          *
        // ****************************
        function xyzrow2_to_lattice(x) {
           var a1,a2,a3,b1,b2,b3,lat,lattice;
           var haslattice = true;
           if (x.length==9) {
              a1 = [parseFloat(x[0]),parseFloat(x[1]),parseFloat(x[2])];
              a2 = [parseFloat(x[3]),parseFloat(x[4]),parseFloat(x[5])];
              a3 = [parseFloat(x[6]),parseFloat(x[7]),parseFloat(x[8])];
              lattice = a1a2a3_to_lattice(a1,a2,a3);
           } else {
              a1 = [1.0,0.0,0.0];
              a2 = [0.0,1.0,0.0];
              a3 = [0.0,0.0,1.0];
              b1 = [1.0,0.0,0.0];
              b2 = [0.0,1.0,0.0];
              b3 = [0.0,0.0,1.0];
              lat = [1.0,1.0,1.0,90.0,90.0,90.0];
              lattice = [a1,a2,a3,b1,b2,b3,lat];
              haslattice = false;
           }

           return [lattice,haslattice];
        }

        // ****************************
        // *                          *
        // *       jmshowcell        *
        // *                          *
        // ****************************
        function jmshowcell() { 
           var isshowing = document.getElementById("showcell").value =="Unit cell off";
           var centeron  = document.getElementById("centercell").value == "Centered";
           if (isshowing) {
              var a1 = document.getElementById("lattice_a1").value;
              var a2 = document.getElementById("lattice_a2").value;
              var a3 = document.getElementById("lattice_a3").value;
              var origin = string3_to_vec3(document.getElementById("lattice_center").value);
              var scpt = "unitcell [{" + origin + "} {" + a1 + "} {" + a2 + "} {" + a3 + "}];";
              scpt += "unitcell ON;"
              jms(scpt); 
              document.getElementById("showcell").value = "Unit cell on";
              if (centeron) { jms("unitcell {-0.5 -0.5 -0.5};"); }
           } else {
              jms("unitcell OFF;"); 
              document.getElementById("showcell").value = "Unit cell off";
           }
        }

        // ****************************
        // *                          *
        // *     jmscentercell        *
        // *                          *
        // ****************************
        function jmscentercell() { 
           var docenter = document.getElementById("centercell").value == "Origin";
           if (docenter) {
              jms("unitcell {-0.5 -0.5 -0.5};"); 
              document.getElementById("centercell").value = "Centered";
           } else {
              jms("unitcell {0.0 0.0 0.0};"); 
              document.getElementById("centercell").value = "Origin";
           }
        }

        // ****************************
        // *                          *
        // *     jmsshiftcell        *
        // *                          *
        // ****************************
        function jmsshiftcell(n1n2n3) {
           var x0 = n1n2n3.trim().split(/[ ,]+/);
           var n1 = parseFloat(x0[0]);
           var n2 = parseFloat(x0[1]);
           var n3 = parseFloat(x0[2]);
           var fracdat = document.getElementById("fractionalCoords").value;
           var xyz = fracdat.trim().split("\n");
           var nion = xyz.length;
           var i,line,x,y,z;
           var fracdat2 = ''
           for (i=0; i<nion; ++i) {
              line = xyz[i].trim().split(/[ ,]+/);
              x = parseFloat(line[1]) + n1;
              y = parseFloat(line[2]) + n2;
              z = parseFloat(line[3]) + n3;
              if (x>0.5)  x -= 1.0;
              if (x<=-0.5) x += 1.0;
              if (y>0.5)  y -= 1.0;
              if (y<=-0.5) y += 1.0;
              if (z>0.5)  z -= 1.0;
              if (z<=-0.5) z += 1.0;
              fracdat2 += line[0] + " " + x.toFixed(6) 
                                  + " " + y.toFixed(6) 
                                  + " " + z.toFixed(6) + "\n";
           }
           document.getElementById("fractionalCoords").value = fracdat2;
           jmsupdatefracbox();
        }

        // ****************************
        // *                          *
        // *     jmschangecellunits   *
        // *                          *
        // ****************************
        function jmschangecellunits(scal) {
           document.getElementById("cell_a").value *= scal;
           document.getElementById("cell_b").value *= scal;
           document.getElementById("cell_c").value *= scal;
           jsmcellchange(true,true);
        }

        // ****************************
        // *                          *
        // *     jsmcellchange        *
        // *                          *
        // ****************************
        function jsmcellchange(cellchange,scoords) {
           var a1,a2,a3;
           var cellon = document.getElementById("showcell").value != "Unit cell off";
           //var cellon = true;
           var centeron = document.getElementById("centercell").value == "Centered";
           if (cellchange) {
               var a = parseFloat(document.getElementById("cell_a").value);
               var b = parseFloat(document.getElementById("cell_b").value);
               var c = parseFloat(document.getElementById("cell_c").value);
               var alpha = parseFloat(document.getElementById("cell_alpha").value);
               var beta  = parseFloat(document.getElementById("cell_beta").value);
               var gamma = parseFloat(document.getElementById("cell_gamma").value); 
               var lat = abcabg_to_lattice(a,b,c,alpha,beta,gamma);
               a1 = lat[0]; a2 = lat[1]; a3 = lat[2];	
               document.getElementById("lattice_a1").value = vec3_to_string3(a1);
               document.getElementById("lattice_a2").value = vec3_to_string3(a2);
               document.getElementById("lattice_a3").value = vec3_to_string3(a3);
           } else {
              a1 = string3_to_vec3(document.getElementById("lattice_a1").value);
              a2 = string3_to_vec3(document.getElementById("lattice_a2").value);
              a3 = string3_to_vec3(document.getElementById("lattice_a3").value);
              var lattice = a1a2a3_to_lattice(a1,a2,a3);
              var lat = lattice[6];
              document.getElementById("cell_a").value = lat[0]
              document.getElementById("cell_b").value = lat[1]
              document.getElementById("cell_c").value = lat[2]
              document.getElementById("cell_alpha").value = lat[3]
              document.getElementById("cell_beta").value  = lat[4]
              document.getElementById("cell_gamma").value = lat[5]
           }
           var origin = string3_to_vec3(document.getElementById("lattice_center").value);
           var scpt = "unitcell [{" + origin + "} {" + vec3_to_string3(a1) + "} {" + vec3_to_string3(a2) + "} {" + vec3_to_string3(a3) + "}];";
           if (centeron) { scpt += "unitcell {-0.5 -0.5 -0.5};"; }
           if (cellon) { jms(scpt); }
           if (scoords) {jmsetcoordboxes();}
        }


        // ****************************
        // *                          *
        // *    loadframe2jsmol       *
        // *                          *
        // ****************************
        var xyzframes_ntotal = 1;
        var xyzframes_cur = 0;
        var xyzframes = [];
        function loadframe2jsmol(addmodel,append) {
           var a1,a2,a3,xyzcell;
           var xyzdat = jmvar("data({1.1},\"xyz\")");
           var nion = xyzdat.trim().split("\n").length;
           xyzdat = nion + "\n\n" + xyzdat;
           var a1 = document.getElementById("lattice_a1").value;
           var a2 = document.getElementById("lattice_a2").value;
           var a3 = document.getElementById("lattice_a3").value;
           xyzcell = [xyzdat,a1,a2,a3];
           if (addmodel) {
              window.xyzframes_ntotal += 1;
              window.xyzframes.push(xyzcell);
           }

           var orient = jmvar("script('show orientation')");
           orient     =  "reset; " + orient.split("reset;")[1];

           if (append) {
              var amodel   =  parseFloat(prompt("Please enter model to append:", (1+(window.xyzframes_cur+1) % window.xyzframes_ntotal)));
              amodel -= 1;
              var xyzcell1 = window.xyzframes[amodel];
              var xyzdat1 = "\"append\"|" + xyzcell1[0].trim().replace(/\n/g,' | ') + "|end \"append\"";
              jms("set appendNew false; data "+xyzdat1);

           } else {
              var nframes = window.xyzframes.length;
              if (nframes<window.xyzframes_ntotal) {
                 window.xyzframes.push(xyzcell);
                 window.xyzframes_cur = (window.xyzframes_cur + 1) % window.xyzframes_ntotal;
              } else {
                    window.xyzframes[window.xyzframes_cur] = xyzcell;
                    window.xyzframes_cur = (window.xyzframes_cur + 1) % window.xyzframes_ntotal;
                    xyzcell = window.xyzframes[window.xyzframes_cur];
              }
              var i = window.xyzframes_cur + 1;
              document.getElementById("model_label").innerHTML = "Model " + i + " out of " + window.xyzframes_ntotal;

              var scpt = "load data " + "\"model editor\"|" + xyzcell[0].trim().replace(/\n/g,' | ') + "|end \"model editor\"";
              jms(scpt);
              document.getElementById("lattice_a1").value = xyzcell[1];
              document.getElementById("lattice_a2").value = xyzcell[2];
              document.getElementById("lattice_a3").value = xyzcell[3];
           } 
           jms(orient);
           jsmcellchange(false,true);
        }
        function fetchframexyz(amodel) {
           var xyzcell1 = window.xyzframes[amodel];
           var xyzlines = xyzcell1[0].trim().split("\n");
           var xyzstr = "";
           for (var i=2; i<xyzlines.length; ++i) {
              xyzstr += xyzlines[i] + "\n";
           }
           return xyzstr;
        }
        function fetchframefrac(amodel) {
           var symb,x,y,z,f1,f2,f3;
           var xyzcell1 = window.xyzframes[amodel];
           var xyzstr = "";
           xyzstr += "system crystal\n";
           xyzstr += "   lattice_vectors\n";
           xyzstr += "   " + xyzcell1[1] + "\n";
           xyzstr += "   " + xyzcell1[2] + "\n";
           xyzstr += "   " + xyzcell1[3] + "\n";
           xyzstr += "end\n\n";
           var a1 = string3_to_vec3(xyzcell1[1]);
           var a2 = string3_to_vec3(xyzcell1[2]);
           var a3 = string3_to_vec3(xyzcell1[3]);
           var [b1,b2,b3] = a1a2a3_to_b1b2b3(a1,a2,a3);
           var xyzlines = xyzcell1[0].trim().split("\n");
           for (var i=2; i<xyzlines.length; ++i) {
              ss = xyzlines[i].trim().split(/[ ,]+/);
              symb = ss[0];
              x = parseFloat(ss[1]);
              y = parseFloat(ss[2]);
              z = parseFloat(ss[3]);
              f1 = b1[0]*x + b1[1]*y + b1[2]*z;
              f2 = b2[0]*x + b2[1]*y + b2[2]*z;
              f3 = b3[0]*x + b3[1]*y + b3[2]*z;
              xyzstr += symb + " " + f1.toFixed(6) + " " + f2.toFixed(6) + " " + f3.toFixed(6) +  "\n";
           }
           return xyzstr;
        }
        function fetchframelat(amodel) {
           var xyzcell1 = window.xyzframes[amodel];
           var fstr = '';
           fstr += "simulation_cell units angstroms\n";
           fstr += "lattice_vectors\n";
           fstr += xyzcell1[1] + "\n";
           fstr += xyzcell1[2] + "\n";
           fstr += xyzcell1[3] + "\n";
           fstr += "end\n";
           return fstr;
        }

        // ****************************
        // *                          *
        // *       jmssupercell       *
        // *                          *
        // ****************************
        function jmssupercell() { 

           var n1n2n3 = prompt("Enter n1 n2 n3:","1 1 1");
           var x0 = n1n2n3.trim().split(/[ ,]+/);
           var n1 = parseInt(x0[0]);
           var n2 = parseInt(x0[1]);
           var n3 = parseInt(x0[2]);
           var ss,symb,f1,f2,f3,x,y,z,y0,z0;
           var ucell = jmsfetchucell();
           var centeron = document.getElementById("centercell").value == "Origin unit cell";
           var xyzdat = jmvar("data({1.1},\"xyz\")");
           if (xyzdat.includes('Mt')) {
              var ss = xyzdat.split('\n');
              xyzdat = ''
              for (var i=0; i<ss.length; ++i) {
                 if (!ss[i].includes('Mt')) {
                    xyzdat += ss[i] + '\n';
                 }
              }
           }
           var cntr = ucell[0];
           var a1 = ucell[1];
           var a2 = ucell[2];
           var a3 = ucell[3];
           var b1 = ucell[4];
           var b2 = ucell[5];
           var b3 = ucell[6];

           var xyzlines = xyzdat.trim().split("\n");
           var nion = xyzlines.length;
           var xcm = 0.0;
           var ycm = 0.0;
           var zcm = 0.0;
           var countcm = 0.0;

           for (var i=0; i<nion; ++i) {
              ss = xyzlines[i].trim().split(/[ ,]+/);
              symb = ss[0];
              x0 = parseFloat(ss[1]);
              y0 = parseFloat(ss[2]);
              z0 = parseFloat(ss[3]);
              for (var i3=0; i3<n3; ++i3) {
              for (var i2=0; i2<n2; ++i2) {
              for (var i1=0; i1<n1; ++i1) {

                 x = x0 + i1*a1[0] + i2*a2[0] + i3*a3[0];
                 y = y0 + i1*a1[1] + i2*a2[1] + i3*a3[1];
                 z = z0 + i1*a1[2] + i2*a2[2] + i3*a3[2];
                 xcm += x;
                 ycm += y;
                 zcm += z;
                 countcm += 1.0;
              }}}
           }
           xcm = xcm/countcm;
           ycm = ycm/countcm;
           zcm = zcm/countcm;

           var fracdat = '';
           xyzdat  = '';
           for (var i3=0; i3<n3; ++i3) {
           for (var i2=0; i2<n2; ++i2) {
           for (var i1=0; i1<n1; ++i1) {
              for (var i=0; i<nion; ++i) {
                 ss = xyzlines[i].trim().split(/[ ,]+/);
                 symb = ss[0];
                 x0 = parseFloat(ss[1]);
                 y0 = parseFloat(ss[2]);
                 z0 = parseFloat(ss[3]);

                 x = x0 + i1*a1[0] + i2*a2[0] + i3*a3[0] - xcm;
                 y = y0 + i1*a1[1] + i2*a2[1] + i3*a3[1] - ycm;
                 z = z0 + i1*a1[2] + i2*a2[2] + i3*a3[2] - zcm;

                 f1 = x*b1[0] + y*b1[1] + z*b1[2];
                 f2 = x*b2[0] + y*b2[1] + z*b2[2];
                 f3 = x*b3[0] + y*b3[1] + z*b3[2];
                 fracdat += symb + " " + f1.toFixed(6) + " " + f2.toFixed(6) + " " + f3.toFixed(6) + "\n";
                 xyzdat  += symb + " " + x.toFixed(6)  + " " + y.toFixed(6)  + " " + z.toFixed(6) + "\n";
              }
           }}}
           var xyzdat1 = nion*n1*n2*n3 + "\n\n" + xyzdat;
           var orient = jmvar("script('show orientation')");
           orient =  "reset; " + orient.split("reset;")[1];
           var xyzdat2 = "\"model editor\"|" + xyzdat1.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
           jms("load data "+xyzdat2);
           jms(orient);

           a1[0] *= n1; a1[1] *= n1; a1[2] *= n1;
           a2[0] *= n2; a2[1] *= n2; a2[2] *= n2;
           a3[0] *= n3; a3[1] *= n3; a3[2] *= n3;
           document.getElementById("lattice_a1").value = vec3_to_string3(a1);
           document.getElementById("lattice_a2").value = vec3_to_string3(a2);
           document.getElementById("lattice_a3").value = vec3_to_string3(a3);

           document.getElementById("cartesianCoords").value  = xyzdat;
           jsmcellchange(false,true);

           supercell_atomlist_color_penalty('atomlist1','colortype1','penalty1a','penalty1b','penalty1c',nion,n1,n2,n3);
           supercell_atomlist_color_penalty('atomlist2','colortype2','penalty2a','penalty2b','penalty2c',nion,n1,n2,n3);
           supercell_atomlist_color_penalty('atomlist3','colortype3','penalty3a','penalty3b','penalty3c',nion,n1,n2,n3);
           supercell_atomlist_color_penalty('atomlist4','colortype4','penalty4a','penalty4b','penalty4c',nion,n1,n2,n3);
        }


        // ****************************
        // *                          *
        // *       jmsfoldcell        *
        // *                          *
        // ****************************
        function jmsfoldcell() { 
           var ss,symb,f1,f2,f3,x,y,z;
           var ucell = jmsfetchucell();
           var centeron = document.getElementById("centercell").value == "Origin unit cell";
           var xyzdat = jmvar("data({1.1},\"xyz\")");
           if (xyzdat.includes('Mt')) {
              var ss = xyzdat.split('\n');
              xyzdat = ''
              for (var i=0; i<ss.length; ++i) {
                 if (!ss[i].includes('Mt')) {
                    xyzdat += ss[i] + '\n';
                 }
              }
           }
           var cntr = ucell[0];
           var a1 = ucell[1];
           var a2 = ucell[2];
           var a3 = ucell[3];
           var b1 = ucell[4];
           var b2 = ucell[5];
           var b3 = ucell[6];
           
           var xyzlines = xyzdat.trim().split("\n");
           var nion = xyzlines.length;
           var fracdat = '';
           xyzdat  = '';
           for (var i=0; i<nion; ++i) {
              ss = xyzlines[i].trim().split(/[ ,]+/);
              symb = ss[0];
              x = parseFloat(ss[1]);
              y = parseFloat(ss[2]);
              z = parseFloat(ss[3]);
              f1 = x*b1[0] + y*b1[1] + z*b1[2];
              f2 = x*b2[0] + y*b2[1] + z*b2[2];
              f3 = x*b3[0] + y*b3[1] + z*b3[2];
              while (f1>=0.5) { f1 -= 1.0;}
              while (f2>=0.5) { f2 -= 1.0;}
              while (f3>=0.5) { f3 -= 1.0;}
              while (f1<(-0.5)) { f1 += 1.0;}
              while (f2<(-0.5)) { f2 += 1.0;}
              while (f3<(-0.5)) { f3 += 1.0;}
              //f1 = f1 - Math.floor(f1);
              //f2 = f2 - Math.floor(f2);
              //f3 = f3 - Math.floor(f3);
            
              x = f1*a1[0] + f2*a2[0] + f3*a3[0];
              y = f1*a1[1] + f2*a2[1] + f3*a3[1];
              z = f1*a1[2] + f2*a2[2] + f3*a3[2];
              fracdat += symb + " " + f1.toFixed(6) + " " + f2.toFixed(6) + " " + f3.toFixed(6) + "\n";
              xyzdat  += symb + " " + x.toFixed(6)  + " " + y.toFixed(6)  + " " + z.toFixed(6) + "\n";
           }
           var xyzdat1 = nion + "\n\n" + xyzdat;
           var orient = jmvar("script('show orientation')");
           orient =  "reset; " + orient.split("reset;")[1];
           var xyzdat2 = "\"model editor\"|" + xyzdat1.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
           jms("load data "+xyzdat2);
           jms(orient);
           jsmcellchange(false,false);

           document.getElementById("fractionalCoords").value = fracdat;
           document.getElementById("cartesianCoords").value  = xyzdat;
        }

        // ****************************
        // *                          *
        // *       jmsfetchucell      *
        // *                          *
        // ****************************
        function jmsfetchucell() { 
           var ucell = jmvar("unitcell()");
           var cntr = ucell[0];
           var a1 = ucell[1];
           var a2 = ucell[2];
           var a3 = ucell[3];

           var [b1,b2,b3] = a1a2a3_to_b1b2b3(a1,a2,a3);

           return [cntr,a1,a2,a3,b1,b2,b3]
        }

        // ****************************
        // *                          *
        // *     jmssetcoordboxes     *
        // *                          *
        // ****************************
        function jmsetcoordboxes() { 
           console.log("in jmsetcoordboxes");
           var ss,symb,x,y,z,fx,fy,fz;
           var xyzdat = jmvar("data({1.1},\"xyz\")");
           if (xyzdat.includes('Mt')) {
              var ss = xyzdat.split('\n');
              xyzdat = ''
              for (var i=0; i<ss.length; ++i) {
                 if (!ss[i].includes('Mt')) {
                    xyzdat += ss[i] + '\n';
                 }
              }
           }
           document.getElementById("cartesianCoords").value = xyzdat;
           var a1 = string3_to_vec3(document.getElementById("lattice_a1").value);
           var a2 = string3_to_vec3(document.getElementById("lattice_a2").value);
           var a3 = string3_to_vec3(document.getElementById("lattice_a3").value);
           var [b1,b2,b3] = a1a2a3_to_b1b2b3(a1,a2,a3);
           
           var xyzlines = xyzdat.trim().split("\n");
           var fracdat = '';
           for (var i=0; i<xyzlines.length; ++i) {
              ss = xyzlines[i].trim().split(/[ ,]+/);
              symb = ss[0];
              x = parseFloat(ss[1]);
              y = parseFloat(ss[2]);
              z = parseFloat(ss[3]);
              fx = x*b1[0] + y*b1[1] + z*b1[2];
              fy = x*b2[0] + y*b2[1] + z*b2[2];
              fz = x*b3[0] + y*b3[1] + z*b3[2];
              fracdat += symb + " " + fx.toFixed(6) + " " + fy.toFixed(6) + " " + fz.toFixed(6) + "\n";
           }
           document.getElementById("fractionalCoords").value = fracdat;

        }
 

        function jmsupdatefracbox() { 
           var ss,symb,f1,f2,f3,x,y,z;
           var ucell   = jmsfetchucell();
           var a1 = ucell[1];
           var a2 = ucell[2];
           var a3 = ucell[3];
           var fracdat   = document.getElementById("fractionalCoords").value;
           var fraclines = fracdat.trim().split("\n");
           var nion = fraclines.length;
           var xyzdat = ''
           for (var i=0; i<nion; ++i) {
              ss = fraclines[i].trim().split(/[ ,]+/);
              symb = ss[0];
              f1 = parseFloat(ss[1]);
              f2 = parseFloat(ss[2]);
              f3 = parseFloat(ss[3]);
              x = f1*a1[0] + f2*a2[0] + f3*a3[0];
              y = f1*a1[1] + f2*a2[1] + f3*a3[1];
              z = f1*a1[2] + f2*a2[2] + f3*a3[2];
              xyzdat += symb + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
           }
           document.getElementById("cartesianCoords").value = xyzdat;
           xyzdat = nion + "\n\n" + xyzdat;

           var orient = jmvar("script('show orientation')");
           orient =  "reset; " + orient.split("reset;")[1];
           var xyzdat2 = "\"model editor\"|" + xyzdat.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
           jms("load data "+xyzdat2);
           jms(orient);
           jsmcellchange(true,false);

           document.getElementById("fractionalCoords").value = fracdat;
        }

        function jmsupdatecartbox() { 
           var ss,symb,f1,f2,f3,x,y,z;
           var ucell   = jmsfetchucell();
           var b1 = ucell[4];
           var b2 = ucell[5];
           var b3 = ucell[6];

           var xyzdat   = document.getElementById("cartesianCoords").value;
           var xyzlines = xyzdat.trim().split("\n");
           var nion = xyzlines.length;

           //update jsmol data
           xyzdat = nion + "\n\n" + xyzdat;
           var orient = jmvar("script('show orientation')");
           orient =  "reset; " + orient.split("reset;")[1];
           var xyzdat2 = "\"model editor\"|" + xyzdat.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
           jms("load data "+xyzdat2);
           jms(orient);
           jsmcellchange(true,false);

           //update fractional coordinates box
           var fracdat = ''
           for (var i=0; i<nion; ++i) {
              ss = xyzlines[i].trim().split(/[ ,]+/);
              symb = ss[0];
              x = parseFloat(ss[1]);
              y = parseFloat(ss[2]);
              z = parseFloat(ss[3]);
              f1 = x*b1[0] + y*b1[1] + z*b1[2];
              f2 = x*b2[0] + y*b2[1] + z*b2[2];
              f3 = x*b3[0] + y*b3[1] + z*b3[2];
              fracdat += symb + " " + f1.toFixed(6) + " " + f2.toFixed(6) + " " + f3.toFixed(6) + "\n";
           }
           document.getElementById("fractionalCoords").value = fracdat;
        }


        function jmresetPointer() {
           var scpt = 'set picking off; unbind; set picking on; set picking identify; set pickingStyle toggle; set PickCallback \"\"';
           Jmol.script(jmolApplet0, scpt); 
        }



	function jmredrawMolecule() {
                //jms("saveOrientation 99");
                //jms("restore orientation 99");
                //orient =  orient.split("reset;")[0];
                var orient = jmvar("script('show orientation')");
                orient =  "reset; " + orient.split("reset;")[1];
		var mol = exMod();
                var moldat = "\"model reset\"\n" + mol + "end \"model reset\"";
                jms("load data "+moldat);
                jms(orient);
	}

        function jmsmiles0(smiles) { 
            jms("load smiles \"" + smiles.replace('>>','.') + "\"");
            var hasreaction = document.getElementById("jmolreactionplane").value == "Reaction off";
            if (hasreaction) {
               scpt  = "draw reactionarrow diameter 0.2  color red arrow {-2,0,0}, {2,0,0}; ";
               scpt += "draw reactionplane \"reaction plane\" 1500 color translucent red plane {0,0,0} {0,1,0} {0,0,1};"
               jms0(scpt);
            }
        }

        function jmsmiles() { 
            jms("load smiles \"" + document.JME.smiles().replace('>>','.') + "\""); 
            var hasreaction = document.getElementById("jmolreactionplane").value == "Reaction off";
            if (hasreaction) {
               scpt  = "draw reactionarrow diameter 0.2  color red arrow {-2,0,0}, {2,0,0}; ";
               scpt += "draw reactionplane \"reaction plane\" 1500 color translucent red plane {0,0,0} {0,1,0} {0,0,1};"
               jms0(scpt);
            }
        }
        function jmasmiles() { jms("set appendNew false;load append smiles \"" + document.JME.smiles().replace('>>','.') + "\"; select all; select within(molecule,(*)[0]); minimize select selected;"); }

        function exMod() { 
            return jmstr("extractModel");
         }
        function exModXYZ() { 
           var xyzdat0 = jmvar("data({1.1},\"xyz\")").trim();
           var nion = xyzdat0.split("\n").length;
           var cellon = document.getElementById("showcell").value != "Unit cell off";
     
           var xyzdat = nion + "\n";
           if (cellon) {
              xyzdat += document.getElementById("lattice_a1").value + " ";
              xyzdat += document.getElementById("lattice_a2").value + " ";
              xyzdat += document.getElementById("lattice_a3").value;
           }
           xyzdat += "\n";
           xyzdat += xyzdat0;
           return xyzdat;
        }

        function jmoltoeditor() {editor.setValue(exModXYZ());}



        function submit_nwchemjob2() {
           var arrows_post_url = '{{ arrows_api }}upload/';
           var arrows_get_url  = '{{ arrows_api }}queue_nwchem_add/';
           var textToSave0 = editor.getValue();
           var textToSave  = textToSave0

           if (textToSave0.includes("#JOB HAS ALREADY BEEN SUBMITTED")) {
              document.getElementById('runmebanner3').innerHTML= "This NWChem Job has already been submitted!";
              return;
           }

           //var fileInput = document.getElementById("fileInput");
           if (textToSave.includes("start")) {
              ii = Math.floor(Math.random() * 1000) + 1;
              filenameguess = "nwchem-" + ii +".nw";
              var fileNameToSaveAs =  filenameguess

              textToSave += "\n# queue_name: nwchem :queue_name\n";
              var labelInput = document.getElementById("queue_nwchem_label").value;
              if (labelInput.length==0) {
                 labelInput =  prompt("Please enter Queue Label:", "NWChem Job #" + ii);
              }

              if (textToSave.includes("#curdir ")) {
                 labelInput += " curdir=" + textToSave.split("#curdir ")[1].split("\n")[0].trim();
              }
              var qwaitInput = document.getElementById("queue_wait_label").value;
              if (qwaitInput.length>0) {
                 labelInput += " QWAIT::" + qwaitInput + "::QWAIT";
              }

              if (labelInput.length>0) {
                 textToSave += "# label:" + fileNameToSaveAs + " " + labelInput + " :label\n";
              }
              //var secret = document.getElementById("queue_secret_code").value.trim();
              //if (secret.length>0) {
              //   textToSave += "# ARROWS_PASSWORD:" + secret + ":ARROWS_PASSWORD\n"
              //}
              if (confirm("Do you want to submit " + labelInput + "?")) {

                 var textToSaveAsBlob = new Blob([textToSave], {type:"text/plain"});
                 var textToSaveAsURL  = window.URL.createObjectURL(textToSaveAsBlob);

                 var formD = new FormData();
                 formD.append('file', textToSaveAsBlob,fileNameToSaveAs);
                 formD.append('title', fileNameToSaveAs);

                 var xhr = new XMLHttpRequest();
                 xhr.open("POST",  arrows_post_url, true);
                 xhr.send(formD);

                 document.getElementById('runmebanner3').innerHTML= "NWChem Job was uploaded as " + fileNameToSaveAs ;

                 var request = new XMLHttpRequest();
                 request.open('GET', arrows_get_url+fileNameToSaveAs, true);
                 request.onload = function (e) {
                   if (request.readyState === 4) {
                     if (request.status === 200) {
                       console.log(request.responseText);
                       document.getElementById('runmebanner3b').innerHTML= request.responseText;
                       if (request.responseText.includes("=")) {
                          document.getElementById("queue_wait_label").value = request.responseText.split("=")[1].trim();
                          editor.setValue("#JOB HAS ALREADY BEEN SUBMITTED" + " - " + request.responseText +"\n"  + textToSave0);
                       }
                     } else {
                       console.error(request.statusText);
                       document.getElementById('runmebanner3b').innerHTML= request.statusText;
                     }
                   }
                 };
                 request.onerror = function (e) {
                   console.error(request.statusText);
                   document.getElementById('runmebanner3b').innerHTML= request.statusText;
                 };
                 request.send();
              }


           } else {
              document.getElementById('runmebanner3').innerHTML= "This is not an NWChem input deck";
           }

        }




        // This routine loads xyzdata into jmol from editor
        //load data "model example"|2|testing|C 1.22 1 1|O 12 2 2|end "model example"
        function jmloadxyz() {
           var xyzdat = "\"model editor\"|" + editor_fetchXYZ().trim().replace(/\n/g,' | ') + "|end \"model editor\"";
           jms("load data "+xyzdat); 
           jsmcellchange(true,true);
        }

        // This routine loads nwdata, xyzdata, or cifdata into jmol from editor
        function jmloadnwxyzcif() {

        }

        // This routine appends xyzdata into jmol from editor
        function jmappendxyz() {
           var xyzdat = "\"append\"|" + editor_fetchXYZ().trim().replace(/\n/g,' | ') + "|end \"append\"";
           jms("set appendNew false; data "+xyzdat); 
           jsmcellchange(true,true);
        }





        function editorsave() {
           var textToSave = editor.getValue();
           var filenameguess = "nwchem.xyz";
           if (textToSave.includes("geometry")) {
              filenameguess = "nwchem.nw"
           }
           var textToSaveAsBlob = new Blob([textToSave], {type:"text/plain"});
           var textToSaveAsURL  = window.URL.createObjectURL(textToSaveAsBlob);
	   var fileNameToSaveAs =  prompt("Please enter filename:", filenameguess);

           var downloadLink = document.createElement("a");
           downloadLink.download = fileNameToSaveAs;
           downloadLink.innerHTML = "Download File";
           downloadLink.href = textToSaveAsURL;
           downloadLink.onclick = destroyClickedElement;
           downloadLink.style.display = "none";
           document.body.appendChild(downloadLink);

           downloadLink.click();
        }
        function destroyClickedElement(event) {
           document.body.removeChild(event.target);
        }
        function loadfiletoeditor() {
           var data = "no data";
	   var fileToLoad = document.getElementById("fileToLoad").files[0];

           var fileReader = new FileReader();
           fileReader.onload = function(fileLoadedEvent) {
              var textFromFileLoaded = fileLoadedEvent.target.result;
              editor.setValue(textFromFileLoaded);
           };
           fileReader.readAsText(fileToLoad, "UTF-8");
        }


        function loadurltoeditor() {
           var corh = "https://cors-anywhere.herokuapp.com/";
           var url = corh + document.getElementById("urlToLoad").value;
           
           if (url.trim().length>9) {
              var ajax = new XMLHttpRequest();
              ajax.open("GET", url, false); // third parameter is async flag
              ajax.send();
              var textFromUrl = ajax.responseText;
              editor.setValue(textFromUrl);
           }
        }

        function loadbulktojsmol() {
           var a = parseFloat(document.getElementById("bulk_a").value);
           var c = parseFloat(document.getElementById("bulk_c").value);
           var u = parseFloat(document.getElementById("bulk_u").value);
           var bt = document.getElementById("bulk_type").value;
           var bn = document.getElementById("bulk_name").value;
           var bp = document.getElementById("bulk_primitive").checked;
           var bc = document.getElementById("bulk_cubic").checked;
           console.log("a=",a);
           console.log("c=",c);
           console.log("u=",u);
           console.log("bt=",bt);
           console.log("bn=",bn);
           console.log("bc=",bc);
           if ((bt=="sc")||(bt=="cesiumchloride")) {
              var aa2 = a/2.0;
              document.getElementById("cell_a").value = a;
              document.getElementById("cell_b").value = a;
              document.getElementById("cell_c").value = a;
              document.getElementById("cell_alpha").value = 90.0;
              document.getElementById("cell_beta").value  = 90.0;
              document.getElementById("cell_gamma").value = 90.0;
              document.getElementById("showcell").value = "Unit cell on";
              document.getElementById("centercell").value = "Origin";
              var ss = bn.trim().split(/[ ,]+/);
              var s1 = ss[0];
              var s2 = s1;
              if (ss.length>1) { s2 = ss[1]; }
              if (bt=="sc") {
                 xyzdat = "1\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
              } else {
                 xyzdat = "2\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                 xyzdat += s2.trim() + " " + aa2.toFixed(6) + " " + aa2.toFixed(6) + " " + aa2.toFixed(6) + "\n";
              }
              var scpt = "load data \"model editor\"|" + xyzdat.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
              jms(scpt);
              jsmcellchange(true,true);
           }
           if ((((bt=="fcc")||(bt=="diamond")||(bt=="zincblende")||(bt=="rocksalt"))&&(bp)&&(!bc))||(bt=="fluorite")) {
              var aa = a/2.0;
              var zz = 0.0;
              a1 = aa.toFixed(6) + " " + aa.toFixed(6) + " " + zz.toFixed(6);
              a2 = aa.toFixed(6) + " " + zz.toFixed(6) + " " + aa.toFixed(6);
              a3 = zz.toFixed(6) + " " + aa.toFixed(6) + " " + aa.toFixed(6);
              document.getElementById("lattice_a1").value = a1;
              document.getElementById("lattice_a2").value = a2;
              document.getElementById("lattice_a3").value = a3;
              document.getElementById("showcell").value = "Unit cell on";
              document.getElementById("centercell").value = "Origin";
              var ss = bn.trim().split(/[ ,]+/);
              var s1 = ss[0];
              var s2 = s1;
              if (ss.length>1) { s2 = ss[1]; }
              var s3 = s2;
              if (ss.length>2) { s3 = ss[2]; }
              if (bt=="fcc") {
                 xyzdat = "1\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
              } else if ((bt=="zincblende") || (bt=="diamond")|| (bt=="rocksalt")) {
                 if (bt=="rocksalt") {
                    var aa2 = a/2.0;
                    xyzdat = "2\n\n";
                    xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                    xyzdat += s2.trim() + " " + aa2.toFixed(6) + " 0.0 0.0\n";
                 } else {
                    var aa4 = a/4.0;
                    xyzdat = "2\n\n";
                    xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                    xyzdat += s2.trim() + " " + aa4.toFixed(6) + " " + aa4.toFixed(6) + " " + aa4.toFixed(6) + "\n";
                 }
              } else {
                 var aa4 = a/4.0;
                 var aa34 = 3.0*a/4.0;
                 xyzdat = "3\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                 xyzdat += s2.trim() + " " + aa4.toFixed(6) + " " + aa4.toFixed(6) + " " + aa4.toFixed(6) + "\n";
                 xyzdat += s3.trim() + " " + aa34.toFixed(6) + " " + aa34.toFixed(6) + " " + aa34.toFixed(6) + "\n";
                 console.log("a1=",a1);
                 console.log("a2=",a2);
                 console.log("a3=",a3);
              }
              var scpt = "load data \"model editor\"|" + xyzdat.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
              jms(scpt);
              jsmcellchange(false,true);
           }
           if (((bt=="fcc")||(bt=="diamond")||(bt=="zincblende")||(bt=="rocksalt"))  && (!bp) && (!bc)) {
              var bb = a/Math.sqrt(2.0);
              var aa2 = a/2.0;
              var aa4 = a/4.0;
              var aa34 = 3*a/4.0;
              var bb2 = bb/2.0;
              var zz = 0.0;
              document.getElementById("cell_a").value = bb;
              document.getElementById("cell_b").value = bb;
              document.getElementById("cell_c").value = a;
              document.getElementById("cell_alpha").value = 90.0;
              document.getElementById("cell_beta").value  = 90.0;
              document.getElementById("cell_gamma").value = 90.0;
              document.getElementById("showcell").value = "Unit cell on";
              document.getElementById("centercell").value = "Origin";
              var ss = bn.trim().split(/[ ,]+/);
              var s1 = ss[0];
              var s2 = s1;
              if (ss.length>1) { s2 = ss[1]; }
              if (bt=="fcc") {
                 xyzdat = "2\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                 xyzdat += s2.trim() + " " + bb2.toFixed(6) + " " +  bb2.toFixed(6) + " " + aa2.toFixed(6) + "\n";
              } else if ((bt=="diamond")||(bt=="zincblende")) {
                 xyzdat = "4\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                 xyzdat += s2.trim() + " " + bb2.toFixed(6) + " " +  zz.toFixed(6) + " " + aa4.toFixed(6) + "\n";
                 xyzdat += s1.trim() + " " + bb2.toFixed(6) + " " +  bb2.toFixed(6) + " " + aa2.toFixed(6) + "\n";
                 xyzdat += s2.trim() + " " + zz.toFixed(6) + " " +  bb2.toFixed(6) + " " + aa34.toFixed(6) + "\n";
              } else {
                 xyzdat = "4\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                 xyzdat += s2.trim() + " " + bb2.toFixed(6) + " " +  bb2.toFixed(6) + " " + zz.toFixed(6) + "\n";
                 xyzdat += s1.trim() + " " + bb2.toFixed(6) + " " +  bb2.toFixed(6) + " " + aa2.toFixed(6) + "\n";
                 xyzdat += s2.trim() + " " + zz.toFixed(6) + " " +  zz.toFixed(6) + " " + aa2.toFixed(6) + "\n";
              }
              var scpt = "load data \"model editor\"|" + xyzdat.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
              jms(scpt);
              jsmcellchange(true,true);
           }

           if (((bt=="fcc")||(bt=="diamond")||(bt=="zincblende")||(bt=="rocksalt")) && bc) {
              var aa2 = a/2.0;
              var aa4 = a/4.0;
              var aa34 = 3*a/4.0;
              var zz = 0.0;
              document.getElementById("cell_a").value = a;
              document.getElementById("cell_b").value = a;
              document.getElementById("cell_c").value = a;
              document.getElementById("cell_alpha").value = 90.0;
              document.getElementById("cell_beta").value  = 90.0;
              document.getElementById("cell_gamma").value = 90.0;
              document.getElementById("showcell").value = "Unit cell on";
              document.getElementById("centercell").value = "Origin";
              var ss = bn.trim().split(/[ ,]+/);
              var s1 = ss[0];
              var s2 = s1;
              if (ss.length>1) { s2 = ss[1]; }
              if (bt=="fcc") {
                 xyzdat = "4\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                 xyzdat += s2.trim() + " 0.0 " + aa2.toFixed(6) + " " + aa2.toFixed(6) + "\n";
                 xyzdat += s2.trim() + " " + aa2.toFixed(6) + " 0.0 " + aa2.toFixed(6) + "\n";
                 xyzdat += s2.trim() + " " + aa2.toFixed(6) + " " + aa2.toFixed(6) + " 0.0\n";
              } else if ((bt=="diamond")||(bt=="zincblende")) {
                 xyzdat = "8\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                 xyzdat += s2.trim() + " " + aa4.toFixed(6) + " " + aa4.toFixed(6) + " " + aa4.toFixed(6) + "\n";
                 xyzdat += s1.trim() + " 0.0 " + aa2.toFixed(6) + " " + aa2.toFixed(6) + "\n";
                 xyzdat += s2.trim() + " " + aa4.toFixed(6) + " " + aa34.toFixed(6) + " " + aa34.toFixed(6) + "\n";
                 xyzdat += s1.trim() + " " + aa2.toFixed(6) + " 0.0 " + aa2.toFixed(6) + "\n";
                 xyzdat += s2.trim() + " " + aa34.toFixed(6) + " " + aa4.toFixed(6) + " " + aa34.toFixed(6) + "\n";
                 xyzdat += s1.trim() + " " + aa2.toFixed(6) + " " + aa2.toFixed(6) + " 0.0\n";
                 xyzdat += s2.trim() + " " + aa34.toFixed(6) + " " + aa34.toFixed(6) + " " + aa4.toFixed(6) + "\n";
              } else {
                 xyzdat = "8\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                 xyzdat += s2.trim() + " " + aa2.toFixed(6) + " " + zz.toFixed(6) + " " + zz.toFixed(6) + "\n";
                 xyzdat += s1.trim() + " 0.0 " + aa2.toFixed(6) + " " + aa2.toFixed(6) + "\n";
                 xyzdat += s2.trim() + " " + aa2.toFixed(6) + " " + aa2.toFixed(6) + " " + aa2.toFixed(6) + "\n";
                 xyzdat += s1.trim() + " " + aa2.toFixed(6) + " 0.0 " + aa2.toFixed(6) + "\n";
                 xyzdat += s2.trim() + " " + zz.toFixed(6) + " " + zz.toFixed(6) + " " + aa2.toFixed(6) + "\n";
                 xyzdat += s1.trim() + " " + aa2.toFixed(6) + " " + aa2.toFixed(6) + " 0.0\n";
                 xyzdat += s2.trim() + " " + zz.toFixed(6) + " " + aa2.toFixed(6) + " " + zz.toFixed(6) + "\n";
              }
              var scpt = "load data \"model editor\"|" + xyzdat.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
              jms(scpt);
              jsmcellchange(true,true);
           }
           if ((bt=="bcc") && (bp) && (!bc)) {
              var aa = a/2.0;
              var maa = -aa;
              a1 = maa.toFixed(6) + " " + aa.toFixed(6) + " " + aa.toFixed(6);
              a2 = aa.toFixed(6) + " " + maa.toFixed(6) + " " + aa.toFixed(6);
              a3 = aa.toFixed(6) + " " + aa.toFixed(6) + " " + maa.toFixed(6);
              document.getElementById("lattice_a1").value = a1;
              document.getElementById("lattice_a2").value = a2;
              document.getElementById("lattice_a3").value = a3;
              document.getElementById("showcell").value = "Unit cell on";
              document.getElementById("centercell").value = "Origin";
              var ss = bn.trim().split(/[ ,]+/);
              var s1 = ss[0];
              var s2 = s1;
              if (ss.length>1) { s2 = ss[1]; }
              xyzdat = "1\n\n";
              xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
              var scpt = "load data \"model editor\"|" + xyzdat.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
              jms(scpt);
              jsmcellchange(false,true);
           }
           if ((bt=="bcc") && ((!bp) || bc)) {
              var aa2 = a/2.0;
              document.getElementById("cell_a").value = a;
              document.getElementById("cell_b").value = a;
              document.getElementById("cell_c").value = a;
              document.getElementById("cell_alpha").value = 90.0;
              document.getElementById("cell_beta").value  = 90.0;
              document.getElementById("cell_gamma").value = 90.0;
              document.getElementById("showcell").value = "Unit cell on";
              document.getElementById("centercell").value = "Origin";
              var ss = bn.trim().split(/[ ,]+/);
              var s1 = ss[0];
              var s2 = s1;
              if (ss.length>1) { s2 = ss[1]; }
              xyzdat = "2\n\n";
              xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
              xyzdat += s2.trim() + " " + aa2.toFixed(6) + " " +  aa2.toFixed(6) + " " + aa2.toFixed(6) + "\n";
              var scpt = "load data \"model editor\"|" + xyzdat.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
              jms(scpt);
              jsmcellchange(true,true);
           }
           if (((bt=="hcp")||(bt=="wurtzite")) && (bp)) {
              var maa = -a/2.0;
              var zz = 0.0;
              var ca = Math.sqrt(8.0/3.0)
              if (c>1.0e-3) {
                 ca = a/c;
              } 
              var aa32 = a*Math.sqrt(3)/2.0;
              var caa = ca*a;

    
              a1 = a.toFixed(6)   + " " + zz.toFixed(6)   + " " + zz.toFixed(6);
              a2 = maa.toFixed(6) + " " + aa32.toFixed(6) + " " + zz.toFixed(6);
              a3 = zz.toFixed(6) + " " + zz.toFixed(6)    + " " + caa.toFixed(6);
              document.getElementById("lattice_a1").value = a1;
              document.getElementById("lattice_a2").value = a2;
              document.getElementById("lattice_a3").value = a3;
              document.getElementById("showcell").value = "Unit cell on";
              document.getElementById("centercell").value = "Origin";
              var ss = bn.trim().split(/[ ,]+/);
              var s1 = ss[0];
              var s2 = s1;
              if (ss.length>1) { s2 = ss[1]; }
              if (bt=="hcp") { 
                 var x = 0.0;
                 var y = a * Math.sqrt(3.0)/3.0;
                 var z = caa/2.0;
                 xyzdat = "2\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                 xyzdat += s2.trim() + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
              } else {
                 if (u<1.0e-3) { u = 0.25 + (1.0/3.0)/(ca*ca); }
                 xyzdat = "4\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                 var x = 1.0/3.0*a  + 2.0/3.0*maa  + (0.5-u)*zz;
                 var y = 1.0/3.0*zz + 2.0/3.0*aa32 + (0.5-u)*zz;
                 var z = 1.0/3.0*zz + 2.0/3.0*zz   + (0.5-u)*caa;
                 xyzdat += s2.trim() + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
                 x = 1.0/3.0*a  + 2.0/3.0*maa  + (0.5)*zz;
                 y = 1.0/3.0*zz + 2.0/3.0*aa32 + (0.5)*zz;
                 z = 1.0/3.0*zz + 2.0/3.0*zz   + (0.5)*caa;
                 xyzdat += s1.trim() + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
                 x = 0.0*a  + 0.0*maa  + (1.0-u)*zz;
                 y = 0.0*zz + 0.0*aa32 + (1.0-u)*zz;
                 z = 0.0*zz + 0.0*zz   + (1.0-u)*caa;
                 xyzdat += s2.trim() + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
              }
              var scpt = "load data \"model editor\"|" + xyzdat.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
              jms(scpt);
              jsmcellchange(false,true);
           }
           if (((bt=="hcp")||(bt=="wurtzite")) && (!bp)) {
              var zz = 0.0;
              var ca = Math.sqrt(8.0/3.0)
              if (c>1.0e-3) {
                 ca = a/c;
              } 
              var aa2  = a/2.0;
              var aa32  = a*Math.sqrt(3.0)/2.0;
              var aa36  = a*Math.sqrt(3.0)/6.0;
              var aa323  = 2.0*a*Math.sqrt(3.0)/3.0;
              var caa2 = ca*a/2.0;

              document.getElementById("cell_a").value = a;
              document.getElementById("cell_b").value = a*Math.sqrt(3.0);
              document.getElementById("cell_c").value = ca*a;
              document.getElementById("cell_alpha").value = 90.0;
              document.getElementById("cell_beta").value  = 90.0;
              document.getElementById("cell_gamma").value = 90.0;
              document.getElementById("showcell").value = "Unit cell on";
              document.getElementById("centercell").value = "Origin";
              var ss = bn.trim().split(/[ ,]+/);
              var s1 = ss[0];
              var s2 = s1;
              if (ss.length>1) { s2 = ss[1]; }
              if (bt=="hcp") {
                 xyzdat = "4\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                 xyzdat += s2.trim() + " " + aa2.toFixed(6) + " " +  aa32.toFixed(6) + " " + zz.toFixed(6) + "\n";
                 xyzdat += s2.trim() + " " + aa2.toFixed(6) + " " +  aa36.toFixed(6) + " " + caa2.toFixed(6) + "\n";
                 xyzdat += s1.trim() + " " + zz.toFixed(6) + " " +  aa323.toFixed(6) + " " + caa2.toFixed(6) + "\n";
              } else {
                 if (u<1.0e-3) { u = 0.25 + (1.0/3.0)/(ca*ca); }
                 xyzdat = "8\n\n";
                 xyzdat += s1.trim() + " 0.0 0.0 0.0\n";
                 var x = 0.0*a;
                 var y = 1/3.0*a*Math.sqrt(3.0);
                 var z = (0.5-u)*ca*a;
                 xyzdat += s2.trim() + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
                 x = 0.0*a; y = 1/3.0*a*Math.sqrt(3.0);   z = (0.5)*ca*a;
                 xyzdat += s1.trim() + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
                 x = 0.0*a; y = 0.0*a*Math.sqrt(3.0);     z = (1.0-u)*ca*a;
                 xyzdat += s2.trim() + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
                 x = 0.5*a; y = 0.5*a*Math.sqrt(3.0);     z = 0.0*ca*a;
                 xyzdat += s1.trim() + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
                 x = 0.5*a; y = 5.0/6.0*a*Math.sqrt(3.0); z = (0.5-u)*ca*a;
                 xyzdat += s2.trim() + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
                 x = 0.5*a; y = 5.0/6.0*a*Math.sqrt(3.0); z = (0.5)*ca*a;
                 xyzdat += s1.trim() + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
                 x = 0.5*a; y = 0.5*a*Math.sqrt(3.0);     z = (1.0-u)*ca*a;
                 xyzdat += s2.trim() + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
              }
              var scpt = "load data \"model editor\"|" + xyzdat.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
              jms(scpt);
              jsmcellchange(true,true);

           }
        }

        var checkedRadio = [null,null,null];
        function ClearRd(ths,ii) {
           if (checkedRadio[ii] == ths) {
               ths.checked = false;
               checkedRadio[ii] = null;
           } else {
               checkedRadio[ii] = ths; 
           }
        }
        function defineslab() {
           var sc = document.getElementById("surface_cut").value;
           if (sc=="sc100") { 
              document.getElementById("surface_a").value = "0.0  1.0  0.0";
              document.getElementById("surface_b").value = "0.0  0.0  1.0";
              document.getElementById("surface_c").value = "1.0  0.0  0.0";
           }
           if (sc=="sc001") { 
              document.getElementById("surface_a").value = "1.0  0.0  0.0";
              document.getElementById("surface_b").value = "0.0  1.0  0.0";
              document.getElementById("surface_c").value = "0.0  0.0  1.0";
           }
           if (sc=="sc111") { 
              document.getElementById("surface_a").value = " 1.0 -1.0  0.0";
              document.getElementById("surface_b").value = " 0.0  1.0 -1.0";
              document.getElementById("surface_c").value = "-1.0 -1.0 -1.0";
           }
           if (sc=="fcc100") { 
              document.getElementById("surface_a").value = " 0.0  1.0  0.0";
              document.getElementById("surface_b").value = " 0.0  0.0  1.0";
              document.getElementById("surface_c").value = " 1.0  0.0  0.0";
           }
           if (sc=="fcc110") { 
              document.getElementById("surface_a").value = " 0.0  0.0  2.0";
              document.getElementById("surface_b").value = " 1.5 -1.5  0.0";
              document.getElementById("surface_c").value = " 1.5  1.5  0.0";
           }
           if (sc=="fcc111") { 
              document.getElementById("surface_a").value = " 1.5 -1.5  0.0";
              document.getElementById("surface_b").value = " 0.0  1.5 -1.5";
              document.getElementById("surface_c").value = "-1.0 -1.0 -1.0";
           }
           if (sc=="fcc211") { 
              document.getElementById("surface_a").value = " 0.0  1.5 -1.5";
              document.getElementById("surface_b").value = " 1.0 -1.0 -1.0";
              document.getElementById("surface_c").value = " 2.0  1.0  1.0";
           }
           if (sc=="bcc100") { 
              document.getElementById("surface_a").value = " 0.0  1.0  0.0";
              document.getElementById("surface_b").value = " 0.0  0.0  1.0";
              document.getElementById("surface_c").value = " 1.0  0.0  0.0";
           }
           if (sc=="bcc001") { 
              document.getElementById("surface_a").value = " 1.0  0.0  0.0";
              document.getElementById("surface_b").value = " 0.0  1.0  0.0";
              document.getElementById("surface_c").value = " 0.0  0.0  1.0";
           }
           if (sc=="bcc110") { 
              document.getElementById("surface_a").value = " 0.0  0.0  2.0";
              document.getElementById("surface_b").value = " 1.0 -1.0  0.0";
              document.getElementById("surface_c").value = " 1.0  1.0  0.0";
           }
           if (sc=="bcc111") { 
              document.getElementById("surface_a").value = " 1.0 -1.0  0.0";
              document.getElementById("surface_b").value = " 0.0  1.0 -1.0";
              document.getElementById("surface_c").value = "-1.0 -1.0 -1.0";
           }
           if (sc=="hcp0001") { 
              document.getElementById("surface_a").value = " 1.0  0.0  0.0";
              document.getElementById("surface_b").value = " 0.0  1.0  0.0";
              document.getElementById("surface_c").value = " 0.0  0.0  1.0";
           }
           if (sc=="diamond100") { 
              document.getElementById("surface_a").value = " 0.0  1.0  0.0";
              document.getElementById("surface_b").value = " 0.0  0.0  1.0";
              document.getElementById("surface_c").value = " 1.0  0.0  0.0";
           }
           if (sc=="diamond111") { 
              document.getElementById("surface_a").value = " 1.0 -1.0  0.0";
              document.getElementById("surface_b").value = " 0.0  1.0 -1.0";
              document.getElementById("surface_c").value = "-1.0 -1.0 -1.0";
           }
        }

        function cutslab() {
           var i,a,b,c,ss,origin,vacuum,scaling,tolerance,nlayers;
           var atoms,a1,a2,a3,tmp;

           ss = document.getElementById("surface_a").value.trim().split(/[ ,]+/);
           a = [parseFloat(ss[0]), parseFloat(ss[1]), parseFloat(ss[2])];

           ss = document.getElementById("surface_b").value.trim().split(/[ ,]+/);
           b = [parseFloat(ss[0]), parseFloat(ss[1]), parseFloat(ss[2])];

           ss = document.getElementById("surface_c").value.trim().split(/[ ,]+/);
           c = [parseFloat(ss[0]), parseFloat(ss[1]), parseFloat(ss[2])];

           ss = document.getElementById("surface_origin").value.trim().split(/[ ,]+/);
           origin = [parseFloat(ss[0]), parseFloat(ss[1]), parseFloat(ss[2])];

           tolerance = parseFloat(document.getElementById("surface_tolerance").value.trim());
           vacuum = parseFloat(document.getElementById("surface_vacuum").value.trim());
           ss = document.getElementById("surface_scaling").value.trim().split(/[ ,]+/);
           if (ss.length>2) {
              scaling = [parseFloat(ss[0]), parseFloat(ss[1]), parseFloat(ss[2])];
           } else if (ss.length==2) {
              scaling = [parseFloat(ss[0]), parseFloat(ss[0]), parseFloat(ss[1])];
           } else if (ss.length==1) {
              scaling = [parseFloat(ss[0]), parseFloat(ss[0]), parseFloat(ss[0])];
           } else  {
              scaling = [1.0,1.0,1.0];
           }

           ss = document.getElementById("lattice_a1").value.trim().split(/[ ,]+/);
           a1 = [parseFloat(ss[0]), parseFloat(ss[1]), parseFloat(ss[2])];
           
           ss = document.getElementById("lattice_a2").value.trim().split(/[ ,]+/);
           a2 = [parseFloat(ss[0]), parseFloat(ss[1]), parseFloat(ss[2])];

           ss = document.getElementById("lattice_a3").value.trim().split(/[ ,]+/); 
           a3 = [parseFloat(ss[0]), parseFloat(ss[1]), parseFloat(ss[2])];

           //tmp = document.getElementById("cartesianCoords").value.trim().split("\n");
           tmp = jmvar("data({1.1},\"xyz\")").trim().split("\n");
           atoms = [];
           for (i=0; i<tmp.length; ++i) {
              ss = tmp[i].trim().split(/[ ,]+/); 
              atoms.push( [ss[0],parseFloat(ss[1]),parseFloat(ss[2]),parseFloat(ss[3])] );
           }
           console.log(atoms);

           //lattice vectors in cells are stored along rows!
         //  var cell = [a1[0],a2[0],a3[0],
         //              a1[1],a2[1],a3[1],
         //              a1[2],a2[2],a3[2]];

         //  if ((Math.abs(c[0])<1.0e-5) && (Math.abs(c[1])<1.0e-5) && (Math.abs(c[2])<1.0e-5)) {
         //     var metric = mat33mult(cell,mat33trans(cell));
         //     var vol = Math.sqrt(mat33det(metric));
         //     c = mat33vec3solv(mat33trans(metric),vec3cross(a,b))*Math.pow(vol,2.0/3.0);
         //  }

           a[0] *= scaling[0]; a[1] *= scaling[0]; a[2] *= scaling[0];
           b[0] *= scaling[1]; b[1] *= scaling[1]; b[2] *= scaling[1];
           c[0] *= scaling[2]; c[1] *= scaling[2]; c[2] *= scaling[2];
           var cutatomscell = cutslab0(atoms,a1,a2,a3,a,b,c,origin,vacuum,tolerance);
           atoms = cutatomscell[0];
           var aa1 = cutatomscell[1];
           var aa2 = cutatomscell[2];
           var aa3 = cutatomscell[3];
           
           a1 = aa1[0].toFixed(6) + " " + aa1[1].toFixed(6) + " " + aa1[2].toFixed(6);
           a2 = aa2[0].toFixed(6) + " " + aa2[1].toFixed(6) + " " + aa2[2].toFixed(6);
           a3 = aa3[0].toFixed(6) + " " + aa3[1].toFixed(6) + " " + aa3[2].toFixed(6);
           document.getElementById("lattice_a1").value = a1;
           document.getElementById("lattice_a2").value = a2;
           document.getElementById("lattice_a3").value = a3;

           var xyzdat = atoms.length + "\n\n";
           for (i=0; i<atoms.length; ++i) {
              xyzdat += atoms[i][0] + " " + atoms[i][1].toFixed(6)
                                    + " " + atoms[i][2].toFixed(6)
                                    + " " + atoms[i][3].toFixed(6) + "\n";
           }
           var scpt = "load data \"model editor\"|" + xyzdat.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
           jms(scpt);
           jsmcellchange(false,true);
           //scpt = "select *; minimize FIX selected;";
           //jms(scpt);
        }


        function cutslab0(atoms,a1,a2,a3,a,b,c,origin,vacuum,tolerance) {
           var ii,i1,i2,i3,n1,n2,n3,f1,f2,f3,x,y,z,tx,ty,tz;
           var dd,ddmin,atom;

           var b1 = [a2[1]*a3[2]-a2[2]*a3[1], a2[2]*a3[0]-a2[0]*a3[2], a2[0]*a3[1]-a2[1]*a3[0]];
           var b2 = [a3[1]*a1[2]-a3[2]*a1[1], a3[2]*a1[0]-a3[0]*a1[2], a3[0]*a1[1]-a3[1]*a1[0]];
           var b3 = [a1[1]*a2[2]-a1[2]*a2[1], a1[2]*a2[0]-a1[0]*a2[2], a1[0]*a2[1]-a1[1]*a2[0]];
           var vol = a1[0]*b1[0] + a1[1]*b1[1] + a1[2]*b1[2];
           b1[0] /= vol; b1[1] /= vol; b1[2] /= vol;
           b2[0] /= vol; b2[1] /= vol; b2[2] /= vol;
           b3[0] /= vol; b3[1] /= vol; b3[2] /= vol;

           var aa1 = [a[0]*a1[0] + a[1]*a2[0] + a[2]*a3[0],
                      a[0]*a1[1] + a[1]*a2[1] + a[2]*a3[1],
                      a[0]*a1[2] + a[1]*a2[2] + a[2]*a3[2]];
           var aa2 = [b[0]*a1[0] + b[1]*a2[0] + b[2]*a3[0],
                      b[0]*a1[1] + b[1]*a2[1] + b[2]*a3[1],
                      b[0]*a1[2] + b[1]*a2[2] + b[2]*a3[2]];
           var aa3 = [c[0]*a1[0] + c[1]*a2[0] + c[2]*a3[0],
                      c[0]*a1[1] + c[1]*a2[1] + c[2]*a3[1],
                      c[0]*a1[2] + c[1]*a2[2] + c[2]*a3[2]];
           var bb1 = [aa2[1]*aa3[2]-aa2[2]*aa3[1], aa2[2]*aa3[0]-aa2[0]*aa3[2], aa2[0]*aa3[1]-aa2[1]*aa3[0]];
           var bb2 = [aa3[1]*aa1[2]-aa3[2]*aa1[1], aa3[2]*aa1[0]-aa3[0]*aa1[2], aa3[0]*aa1[1]-aa3[1]*aa1[0]];
           var bb3 = [aa1[1]*aa2[2]-aa1[2]*aa2[1], aa1[2]*aa2[0]-aa1[0]*aa2[2], aa1[0]*aa2[1]-aa1[1]*aa2[0]];
           console.log("ibb1=",bb1);
           console.log("ibb2=",bb2);
           console.log("ibb3=",bb3);
           console.log("iaa1=",aa1);

           var vol = aa1[0]*bb1[0] + aa1[1]*bb1[1] + aa1[2]*bb1[2];
           console.log("vol=",vol);
           bb1[0] /= vol; bb1[1] /= vol; bb1[2] /= vol;
           bb2[0] /= vol; bb2[1] /= vol; bb2[2] /= vol;
           bb3[0] /= vol; bb3[1] /= vol; bb3[2] /= vol;

           n1=1;n2=1;n3=1;
           for (i3=0; i3<2; ++i3) {
              for (i2=0; i2<2; ++i2) {
                 for (i1=0; i1<2; ++i1) {
                    x = i1*aa1[0] + i2*aa2[0] + i3*aa3[0] - origin[0];
                    y = i1*aa1[1] + i2*aa2[1] + i3*aa3[1] - origin[1];
                    z = i1*aa1[2] + i2*aa2[2] + i3*aa3[2] - origin[2];
                    f1 = x*bb1[0] + y*bb1[1] + z*bb1[2];
                    f2 = x*bb2[0] + y*bb2[1] + z*bb2[2];
                    f3 = x*bb3[0] + y*bb3[1] + z*bb3[2];
                    if (Math.abs(f1)>n1) { n1 = Math.abs(f1); }
                    if (Math.abs(f2)>n2) { n2 = Math.abs(f2); }
                    if (Math.abs(f3)>n3) { n3 = Math.abs(f3); }
                 }
              }
           }
           n1 = 25;
           n2 = 25;
           n3 = 25;

           console.log("n1=",n1);
           console.log("n2=",n2);
           console.log("n3=",n3);
           console.log("a1=",a1);
           console.log("a2=",a2);
           console.log("a3=",a3);
           console.log("aa1=",aa1);
           console.log("aa2=",aa2);
           console.log("aa3=",aa3);
           console.log("bb1=",bb1);
           console.log("bb2=",bb2);
           console.log("bb3=",bb3);



           var delta = 1.0e-8;
           var xx,yy,zz;
           var atoms2 = [];
           for (i3=(-n3); i3<=n3; ++i3) {
              for (i2=(-n2); i2<=n2; ++i2) {
                 for (i1=(-n1); i1<=n1; ++i1) {
                    for (ii=0; ii<atoms.length; ++ii) {
                       atom = atoms[ii];
                       symb = atom[0];
                       x    = atom[1]; y = atom[2]; z = atom[3];

                       xx = x + i1*a1[0] + i2*a2[0] + i3*a3[0] - origin[0];
                       yy = y + i1*a1[1] + i2*a2[1] + i3*a3[1] - origin[1];
                       zz = z + i1*a1[2] + i2*a2[2] + i3*a3[2] - origin[2];

                       f1 = xx*bb1[0] + yy*bb1[1] + zz*bb1[2];
                       f2 = xx*bb2[0] + yy*bb2[1] + zz*bb2[2];
                       f3 = xx*bb3[0] + yy*bb3[1] + zz*bb3[2];
                       if ((f1>=(-0.5-delta)) && (f1<(0.5-delta)) && (f2>=(-0.5-delta)) && (f2<(0.5-delta)) && (f3>=(-0.5-delta)) && (f3<=(0.5+tolerance))) {
                          console.log("f1,f2,f3=",f1,f2,f3,xx,yy,zz);
                          console.log("i1,i2,i3=",i1,i2,i3,x,y,z);
                          atoms2.push([atom[0],xx,yy,zz])
                       }
                    }
                 }
              }
           }

           tx = Math.sqrt(aa3[0]*aa3[0] + aa3[1]*aa3[1] + aa3[2]*aa3[2]);
           tz = tx/2 + vacuum/2;
           ty = 1.0 + vacuum/tx;
           aa3[0] *= ty;
           aa3[1] *= ty;
           aa3[2] *= ty;

           return [atoms2,aa1,aa2,aa3];
        }

        function vec3cross(a,b) {
           return [(a[1]*b[2]-a[2]*b[1]),(a[2]*b[0]-a[0]*b[2]),(a[0]*b[1]-a[1]*b[0])];
        }
        function mat33trans(m) {
           return  [m[0],m[3],m[6],
                    m[1],m[4],m[7],
                    m[2],m[5],m[8]];
        }
        function mat33mult(m1,m2) {
           return [m1[0]*m2[0] + m1[3]*m2[1] + m1[6]*m2[2],
                   m1[1]*m2[0] + m1[4]*m2[1] + m1[7]*m2[2],
                   m1[2]*m2[0] + m1[5]*m2[1] + m1[8]*m2[2],
                   m1[0]*m2[3] + m1[3]*m2[4] + m1[6]*m2[5],
                   m1[1]*m2[3] + m1[4]*m2[4] + m1[7]*m2[5],
                   m1[2]*m2[3] + m1[5]*m2[4] + m1[8]*m2[5],
                   m1[0]*m2[6] + m1[3]*m2[7] + m1[6]*m2[8],
                   m1[1]*m2[6] + m1[4]*m2[7] + m1[7]*m2[8],
                   m1[2]*m2[6] + m1[5]*m2[7] + m1[8]*m2[8]];
        }
        function mat33det(m) {
           return (m[0]*(m[4]*m[8]-m[5]*m[7])+m[3]*(m[7]*m[2]-m[8]*m[1])+m[6]*(m[1]*m[5]-m[2]*m[4]));
        }
        function mat33norm(m) {
           return Math.sqrt(m[0]*m[0]+m[1]*m[1]+m[2]*m[2]+m[3]*m[3]+m[4]*m[4]+m[5]*m[5]+m[6]*m[6]+m[7]*m[7]+m[8]*m[8]);
        }

        function mat33vec3solv(m,b) {
           var d = mat33det(m);
           var dx = mat33det( [b[0],b[1],b[2], m[3],m[4],m[5], m[6],m[7],m[8]] );
           var dy = mat33det( [m[0],m[1],m[2], b[0],b[1],b[2], m[6],m[7],m[8]] );
           var dz = mat33det( [m[0],m[1],m[2], m[3],m[4],m[5], b[0],b[1],b[2]] );
           return [dx/d, dy/d, dz/d];
        }

        function finish_solvateurltojsmol(textFromUrl) {

           var machine = document.getElementById("machine").value;
           var ncpus = "6";
           if (machine.includes("cori"))     { ncpus="48";}
           if (machine.includes("gulfport")) { ncpus="32";}
           if (machine.includes("samsung"))  { ncpus="32";}
           if (machine.includes("aerosol"))  { ncpus="32";}
           //ncpus   = prompt("Please enter number cpus:", ncpus);
           var tmp = textFromUrl.split("simulation_cell")[1].split("end")[0].trim();
           var a1,a2,a3;
           if (tmp.includes("lattice_vectors")) {
              a1 = string3_to_vec3(tmp.split("\n")[1]); a1[0] *= 0.529177; a1[1] *= 0.529177; a1[2] *= 0.529177;
              a2 = string3_to_vec3(tmp.split("\n")[2]); a2[0] *= 0.529177; a2[1] *= 0.529177; a2[2] *= 0.529177;
              a3 = string3_to_vec3(tmp.split("\n")[3]); a3[0] *= 0.529177; a3[1] *= 0.529177; a3[2] *= 0.529177;
           } else if (tmp.includes("SC")) {
              var a = 0.529177*parseFloat(tmp.split("SC")[1].split("\n")[0]);
              var lat = abcabg_to_lattice(a,a,a,90.0,90.0,90.0);
              a1 = lat[0];
              a2 = lat[1];
              a3 = lat[2];
           }
           document.getElementById("lattice_a1").value = vec3_to_string3(a1);
           document.getElementById("lattice_a2").value = vec3_to_string3(a2);
           document.getElementById("lattice_a3").value = vec3_to_string3(a3);
           document.getElementById("showcell").value   = "Unit cell on";
           //document.getElementById("centercell").value = "Origin";
           document.getElementById("centercell").value = "Centered";

           var xyz = textFromUrl.split("geometry noautosym noautoz")[1].split("end")[0].trim();
           var nion = xyz.split("\n").length;
           var xyzdat = nion + "\n\n" + xyz;

           var scpt = "load data \"model editor\"|" + xyzdat.trim().replace(/\n/g,' | ') + "|end \"model editor\"";
           jms(scpt);
           jsmcellchange(false,true);
           //jmscentercell();

           var mformula = textFromUrl.split("#mformula = ")[1].split("\n")[0].trim();
           var x =  "#nwchem_input  " + mformula + "-aimdmm.nw\n";
           x += "#nwchem_output " + mformula + "-aimdmm.out00\n";
           x += "#nwchem_done   " + mformula + "-aimdmm.done\n";
           x += "#\n";
           x += "#mformula_off\n";
           x += "#\n";
           x += "#transfer_files *.nw *.xyz *.ion_motion *.emotion *.fei *.cif *.hist *.gr *.dat *.meta_gaussians *.cube\n";
           x += "#bad_files md_xs\n";
           x += "#\n";
           x += "#\n";
           var permdir_tag = document.getElementById("permdir_tag").value.trim();
           x += "#permdir " + mformula + "-aimdmm" + permdir_tag + "\n";
           x += "#deletescratch no\n";
           x += "#queuesave no\n"
           x += "#\n";
           x += "#machine " + machine + "\n";
           x += "#cputime 8:05:00\n";
           x += "#ncpus " + ncpus + "\n";
           x += "#queue regular\n";
           x += "#\n";
           var data = x + textFromUrl.split("#Fetched the following entry:")[1].split("</pre>")[0].trim();

           editor.setValue(data);
        }

        function solvateurltojsmol() {
           var arrows_post_url = '{{ arrows_api }}upload/';
           var arrows_get_url  = '{{ arrows_api }}molecular_calculation/';
           document.getElementById('runmebanner4b').innerHTML= "Solvation calculation started.";

           var xyz = jmvar("data({1.1},\"xyz\")").trim();
           xyz = " xyzdata{" + xyz.trim().replace(/\n/g,' | ') + "} theory{aimd-mm}";
           xyz += " ^{"+ charge_arrowsdata()+"}";
           xyz += " mult{"+ mult_arrowsdata()+"}";
           if (document.getElementById("showcell").value=="Unit cell on") {;
              xyz += " unitcell{lattice_vectors | ";
              xyz += document.getElementById("lattice_a1").value + " | ";
              xyz += document.getElementById("lattice_a2").value + " | ";
              xyz += document.getElementById("lattice_a3").value + "}";
           } else {
              var molarity = prompt("Please enter molarity:", "1.0");
              xyz += " molarity{"+ molarity+"}";
           }

           //var url = "https://arrows.emsl.pnnl.gov/api/input_deck/\"" + xyz + "\"" ;
           textToSave = xyz;

           ii = Math.floor(Math.random() * 1000) + 1;
           filenameguess = "nwchem-" + ii +".nw";
           var fileNameToSaveAs =  filenameguess

           var textToSaveAsBlob = new Blob([textToSave], {type:"text/plain"});
           var textToSaveAsURL  = window.URL.createObjectURL(textToSaveAsBlob);

           var formD = new FormData();
           formD.append('file', textToSaveAsBlob,fileNameToSaveAs);
           formD.append('title', fileNameToSaveAs);

           var xhr = new XMLHttpRequest();
           xhr.open("POST", arrows_post_url, true);
           xhr.send(formD);


          //    var request = new XMLHttpRequest();
          //    request.open('GET', saveurl1, true);
          //    request.onreadystatechange = function() {
          //       if (this.readyState == 4 && this.status == 200) {
          //        document.getElementById("HTMLOutput").innerHTML = this.responseText;
          //       }
          //    };
          //    request.send(); 

           var ajax = new XMLHttpRequest();
           ajax.open('GET', arrows_get_url+fileNameToSaveAs, true);
           ajax.onload = function (e) {
             if (ajax.readyState === 4) {
               if (ajax.status === 200) {
                 var textFromUrl = ajax.responseText;
                 console.log(textFromUrl);
                 document.getElementById('runmebanner4b').innerHTML= "Solvation Finished!";
                 finish_solvateurltojsmol(textFromUrl);
               } else {
                 console.error(ajax.statusText);
                 document.getElementById('runmebanner4b').innerHTML= ajax.statusText;
               }
             }
           };
           ajax.onerror = function (e) {
             console.error(ajax.statusText);
             document.getElementById('runmebanner4b').innerHTML= ajax.statusText;
           };
           ajax.send();
        }



        function loadurltojsmol(append) {
           if (append) {
              document.getElementById('runmebanner4b').innerHTML= "Appending esmiles.";
           } else {
              document.getElementById('runmebanner4b').innerHTML= "Loading esmiles.";
           }
           var append2 = append;
           var urllist = document.getElementById("urlToLoad2").value.split(" + ");
           console.log(urllist);
           for (var i=0; i<urllist.length; ++i) {
              var x;
              var url = urllist[i];
              var url2 = "";
              var res = url.split(" ");
              if (/^\+?(0|[1-9]\d*)$/.test(res[0])){
                x = parseInt(res[0]);
                url = res.slice(1).join(" ");
              }
             else {
                x = 1;
              }
              if (url.indexOf("http") == -1) {
                 url2 = "{{ arrows_api }}esmiles2xyz/\"" + url + "\"" ;
                 //url  = "https://arrows.emsl.pnnl.gov/api/xyz/\"" + url + "\"" ;
                 url  = "{{ arrows_api }}mol/\"" + url + "\"" ;
              }
              console.log(url);
              if (url.trim().length>9) {
                 var ajax = new XMLHttpRequest();
                 ajax.open("GET", url, false); // third parameter is async flag
                 ajax.send();
                 var textFromUrl = ajax.responseText;
                 if ((textFromUrl.indexOf("mol failed")!=-1) && (url2!="")) {
                    console.log(url2);
                    var ajax2 = new XMLHttpRequest();
                    ajax2.open("GET", url2, false); // third parameter is async flag
                    ajax2.send();
                    var textFromUrl2= ajax2.responseText;
                    var obj = JSON.parse(textFromUrl2);
                    textFromUrl = obj.mol_blob;
                 }
                 for (var j=0; j<x; ++j){
                    if (append2) {
                       //var xyzdat = "\"append\"|" + textFromUrl.trim().replace(/\n/g,' | ') + "|end \"append\";";
                       var moldat = "\"append\"" + textFromUrl + "end \"append\";";
                       jms("set appendNew false; data "+moldat + "select all; select within(molecule,(*)[0]); minimize select selected; select {*}[0];");
                    }
                    else {
                       //var xyzdat = "\"model arrows\"|" +textFromUrl.trim().replace(/\n/g,' | ') + "|end \"model arrows\";";
                       var moldat = "\"model arrows\"" +textFromUrl + "end \"model arrows\";";
                       jms("load data "+moldat  + "select all; select within(molecule,(*)[0]); minimize select selected; select {*}[0];");
                       append2 = true;
                    }
                 }
              }
           }
        }


        function submiturl() {
           var url = document.getElementById("urlToLoad").value;
           var saveurl1 = url.replace("raw=","submit_nwchem3=");
           var filename = url.split("/").pop();

           if (confirm("Do you want to submit job " + filename + " ?")) {
              document.getElementById("HTMLOutput").innerHTML = "submitted job: " + saveurl1 + "\n";
              var request = new XMLHttpRequest();
              request.open('GET', saveurl1, true);
              request.onreadystatechange = function() {
                 if (this.readyState == 4 && this.status == 200) {
                  document.getElementById("HTMLOutput").innerHTML = this.responseText;
                 }
              };
              request.send();
           }
        }



        function deleteMoleculePick() {
           var anum = arguments[1].split("#")[1].split(" ")[0];
           //var anum = arguments[1].split("#")[0].trim();
           //var anum0 = arguments[1].split("#")[1].split(" ")[0];
           //var anum1 = parseInt(anum0) - 1;
           //var anum  = anum1.toString();
           var scpt = "select within(molecule,{*}[" + anum + "]); delete selected; unbind; set picking identify; set PickCallback \"\";";
           jms(scpt);
        }
        function jmdeletemolecule() {
           jms0("unbind; unbind \"DOUBLE\"; set picking off;set picking on; set atomPicking true;  set PickCallback \"deleteMoleculePick\";");
        }

        function minimizeMoleculePick() {
           var anum = arguments[1].split("#")[1].split(" ")[0];
           //var anum = arguments[1].split("#")[0].trim();
           //var anum0 = arguments[1].split("#")[1].split(" ")[0];
           //var anum1 = parseInt(anum0) - 1;
           //var anum  = anum1.toString();
           var scpt = "x = within(molecule,{*}[" + anum + "]); minimize select x only; unbind; set picking identify; set PickCallback \"\";";
           jms(scpt);
        }
        function jmminimizemolecule() {
           jms0("unbind; unbind \"DOUBLE\"; set picking off;set picking on; set atomPicking true;  set PickCallback \"minimizeMoleculePick\";");
        }


        function hcleanMoleculePick() {
           var anum = arguments[1].split("#")[1].split(" ")[0];
           //var anum = arguments[1].split("#")[0].trim();
           //var anum0 = arguments[1].split("#")[1].split(" ")[0];
           //alert(anum0);
           //var anum1 = parseInt(anum0) - 1;
           //var anum  = anum1.toString();
           var scpt = "x = within(molecule,{*}[" + anum + "]); delete hydrogens and x; calculate hydrogens x; unbind; set picking identify; set PickCallback \"\";";
           jms(scpt);
        }
        function jmhcleanmolecule() {
           jms0("unbind; unbind \"DOUBLE\"; set picking off;set picking on; set atomPicking true;  set PickCallback \"hcleanMoleculePick\";");
        }



        function centerAtomPick() {
           //var anum = arguments[1].split("#")[1].split(" ")[0];
           var anum = arguments[1].split("#")[0].split(" ")[0];
           var scpt = 'set picking off; unbind; set picking on; set picking identify; set pickingStyle toggle; set PickCallback \"\"; ';
               scpt += "select "+ anum + "; center selected; "
           jms0(scpt);
        }
        function jmcenteratom() {
           jms0("unbind; unbind \"DOUBLE\"; set picking off;set picking on; set atomPicking true;  set PickCallback \"centerAtomPick\";");
        }

        function jmcenterorigin() {
           var scpt = 'unbind; unbind \"DOUBLE\"; set picking off; set picking on; set picking identify; set pickingStyle toggle; center {0,0,0}';
           jms0(scpt);
        }



        function jmpickatom(symbol0) {
           var scpt  = "set picking off; set picking on; set atomPicking true; set picking assignatom_";
           var symbol = symbol0;
           if (symbol0=='X1'){
              if (document.getElementById("atomX1").value=="??") {
                 symbol = prompt("Please enter atom symbol:", "Fe");
                 document.getElementById("atomX1").value = symbol;
              } else {
                 symbol = document.getElementById("atomX1").value;
              }
           } 
           if (symbol0=='X2'){
              if (document.getElementById("atomX2").value=="??") {
                 symbol = prompt("Please enter atom symbol:", "Fe");
                 document.getElementById("atomX2").value = symbol;
              } else {
                 symbol = document.getElementById("atomX2").value;
              }
           } 
           if (symbol0=='X3'){
              if (document.getElementById("atomX3").value=="??") {
                 symbol = prompt("Please enter atom symbol:", "Fe");
                 document.getElementById("atomX3").value = symbol;
              } else {
                 symbol = document.getElementById("atomX3").value;
              }
           } 
           if (symbol0=='X4'){
              if (document.getElementById("atomX4").value=="??") {
                 symbol = prompt("Please enter atom symbol:", "Fe");
                 document.getElementById("atomX4").value = symbol;
              } else {
                 symbol = document.getElementById("atomX4").value;
              }
           } 
           if (symbol0=='X5'){
              if (document.getElementById("atomX5").value=="??") {
                 symbol = prompt("Please enter atom symbol:", "Fe");
                 document.getElementById("atomX5").value = symbol;
              } else {
                 symbol = document.getElementById("atomX5").value;
              }
           } 
           if (symbol0=='X6'){
              if (document.getElementById("atomX6").value=="??") {
                 symbol = prompt("Please enter atom symbol:", "Fe");
                 document.getElementById("atomX6").value = symbol;
              } else {
                 symbol = document.getElementById("atomX6").value;
              }
           } 
           if (symbol0=='X7'){
              if (document.getElementById("atomX7").value=="??") {
                 symbol = prompt("Please enter atom symbol:", "Fe");
                 document.getElementById("atomX7").value = symbol;
              } else {
                 symbol = document.getElementById("atomX7").value;
              }
           } 
           if (symbol0=='Xx'){
              symbol = prompt("Please enter atom symbol:", "Fe");
           } 
           
           if (document.getElementById("insertatom").value == "++") { 
              jmaddsmiles(symbol);
              jminsertatom(false);
           } else {
              scpt += symbol;
              jms(scpt);
           }
        }
        //document.getElementById("atomX1").value = "??";
        //document.getElementById("atomX2").value = "??";
        //document.getElementById("atomX3").value = "??";
        //document.getElementById("atomX4").value = "??";
        //document.getElementById("atomX5").value = "??";
        //document.getElementById("atomX6").value = "??";
        //document.getElementById("atomX7").value = "??";

        function fetch_smilesprompt() {
           var smiles = prompt("Please enter smiles:", "CCO");
           if (smiles.includes("http")) {
              alert("Running OSRA for " + smiles);
              var url = "{{ arrows_api }}osra/'" + smiles + "'";
              var ajax = new XMLHttpRequest();
              ajax.onload = functionName;
              ajax.onerror = errorFunctionName;
              ajax.open("GET", url, false); // third parameter is async flag
              ajax.send();
              function functionName() {
                  console.log(this); // log the response
                  if (this.status == 200) { // request succeeded
                      // do something with this.responseText;
                      //alert(this.responseText);
                      if (this.responseText.includes("OSRA_RESULT:")) {
                         var allsmiles = this.responseText.split("OSRA_RESULT:")[1].split(":OSRA_RESULT")[0].trim().split("\n"); 
                         var i,j,tstr,smilesentry,smiles0;
                         tstr = 'SMILES generated by OSRA:\n';
                         for (i=0; i<allsmiles.length; ++i) {
                            j = i+1;
                            tstr += j.toString() + " " + allsmiles[i] + "\n";
                         }
                         smilesentry = prompt(tstr+"Please choose entry:", "1");
                         i = parseInt(smilesentry) - 1;
                         smiles0 = allsmiles[i];
                         smiles = prompt("Please enter smiles:", smiles0);
                      } else {
                         smiles = "CCO";
                      }
                  } else {
                      smiles = "CCO";
                  }
              }
              function errorFunctionName(e) {
                  console.log(this);
                  console.error(e);
                  // do something with this.status, this.statusText
              }
           }
           return smiles;
        }

        function jmaddsmiles(option0) {
           var smiles,scpt;

           smiles = "["+option0+"]" //default to atom smiles

           if (option0=='H2O'){ 
              smiles = "O"; 
           }
           if (option0=='CH4'){ 
              smiles = "C"; 
           }
           if (option0=='SHE'){ 
              smiles = "[Mt]"; 
           }
           if (option0=='X1'){
              if (document.getElementById("smilesX1").value=="smiles?") {
                 //smiles = prompt("Please enter smiles:", "CCO");
                 smiles = fetch_smilesprompt();
                 document.getElementById("smilesX1").value = smiles;
              } else {
                 smiles = document.getElementById("smilesX1").value;
              }
           } 
           if (option0=='X2'){
              if (document.getElementById("smilesX2").value=="smiles?") {
                 //smiles = prompt("Please enter smiles:", "CCO");
                 smiles = fetch_smilesprompt();
                 document.getElementById("smilesX2").value = smiles;
              } else {
                 smiles = document.getElementById("smilesX2").value;
              }
           } 
           if (option0=='X3'){
              if (document.getElementById("smilesX3").value=="smiles?") {
                 //smiles = prompt("Please enter smiles:", "CCO");
                 smiles = fetch_smilesprompt();
                 document.getElementById("smilesX3").value = smiles;
              } else {
                 smiles = document.getElementById("smilesX3").value;
              }
           } 
           if (option0=='Xx'){
              smiles = fetch_smilesprompt();
           } 
           //var scpt = 'set appendNew false; load append smiles \"' + smiles + '\"; select all; select within(molecule,(*)[0]); minimize select selected; ';
           var scpt = 'set appendNew false; load append smiles \"' + smiles + '\"; select all; select within(molecule,(*)[0]); ';
           if (option0=='SHE'){ 
              var scpt = 'set appendNew false; '
              scpt += 'data \"append\"|1|testing|Mt 0.22 0.2 0.1|end \"append\"; ';
              scpt += 'select all; select within(molecule,(*)[0]); minimize select selected; ';
              scpt += 'select Meitnerium; color atoms TRANSLUCENT orange; label "e-"; color label cpk; ';
           } else {
              scpt += 'select {*}[0]; ' 
           }
           jms(scpt);
        }
        //document.getElementById("smilesX1").value = "smiles?";
        //document.getElementById("smilesX2").value = "smiles?";
        //document.getElementById("smilesX3").value = "smiles?";

        function jminsertatom(option0) {
           if (option0) {
              document.getElementById("insertatom").value = '++';
           } else {
              document.getElementById("insertatom").value = "^^";
           }
        }
        //document.getElementById("insertatom").value = "^^";

        function jmspin() {
           var scpt;
           var jjj = document.getElementById("jmolspin").value;
           if  (jjj == "Spin off") {
              scpt = "Spin off;";
              document.getElementById("jmolspin").value = "Spin on";
           } else {
              scpt = "Spin on;";
              document.getElementById("jmolspin").value = "Spin off";
           }
           jms0(scpt);
        }
        //document.getElementById("jmolspin").value = "Spin on";

        function jmlabel() {
           var scpt;
           var jjj = document.getElementById("jmollabel").value;
           if  (jjj == "Labels off") {
              scpt = "select all; label off";
              document.getElementById("jmollabel").value = "Labels on";
           } else {
              scpt = "select all; label %a; ";
              scpt += 'select Meitnerium; color atoms TRANSLUCENT orange; label "e-"; ';
              document.getElementById("jmollabel").value = "Labels off";
           }
           jms0(scpt);
        }
        //document.getElementById("jmollabel").value = "Labels on";

        function jmaxes() {
           var scpt;
           var jjj = document.getElementById("jmolaxes").value;
           if  (jjj == "Axes off") {
              scpt = "unitcell 0; axes 0"
              document.getElementById("jmolaxes").value = "Axes on";
           } else {
              scpt = "unitcell 1; axes 1"
              document.getElementById("jmolaxes").value = "Axes off";
           }
           jms0(scpt);
        }
        //document.getElementById("jmolaxes").value = "Axes on";


        function jmreactionplane() {
           var scpt;
           var jjj = document.getElementById("jmolreactionplane").value;
           if  (jjj == "Reaction off") {
              scpt = "draw \"reaction*\" delete;";
              document.getElementById("jmolreactionplane").value = "Reaction on";
              document.getElementById("jmolreactionplane2").value = "Reaction on";
              document.getElementById("jmolreactionplane3").value = "Reaction on";
              jsmenoreaction();
           } else {
              //scpt = "draw reactionarrow diameter 0.2  color red arrow {-2,0,0}, {2,0,0}; draw reactionplane \"reaction plane\" 2000 color translucent green plane {0,0,0} {0,1,0} {0,0,1};"
              scpt  = "draw reactionarrow diameter 0.2  color red arrow {-2,0,0}, {2,0,0}; ";
              //scpt += "set userColorScheme white blue yellow red green cyan orange magenta maroon lime grey;";
              //scpt += "set propertycolorscheme 'user';";
              scpt += "draw reactionplane \"reaction plane\" 1500 color translucent red plane {0,0,0} {0,1,0} {0,0,1};"
              document.getElementById("jmolreactionplane").value = "Reaction off";
              document.getElementById("jmolreactionplane2").value = "Reaction off";
              document.getElementById("jmolreactionplane3").value = "Reaction off";
              jsmereaction();
           }
           jms0(scpt);
        }
        //document.getElementById("jmolreactionplane").value = "Reaction on";
        //document.getElementById("jmolreactionplane2").value = "Reaction on";
        //document.getElementById("jmolreactionplane3").value = "Reaction on";


        function jmbackground() {
           var scpt;
           var jjj = document.getElementById("jmbackcolor").value;
           if (jjj=="Bckgrnd black") {
              scpt="background black;";
              document.getElementById("jmbackcolor").value = "Bckgrnd default";
           } else {
              //scpt="background [xc6ed80];";
              scpt="background [x4286f4];";
              document.getElementById("jmbackcolor").value = "Bckgrnd black";
           }
           jms0(scpt);
        }
        //document.getElementById("jmbackcolor").value = "Bckgrnd black";

        function jmlabelcolor() {
           var scpt;
           var jjj = document.getElementById("jmlblcolor").value;
           if (jjj=="Label black") {
              scpt="select all; color label black;";
              document.getElementById("jmlblcolor").value = "Label CPK";
           } else {
              scpt="select all; color label cpk;";
              document.getElementById("jmlblcolor").value = "Label black";
           }
           jms0(scpt);
        }
        //document.getElementById("jmlblcolor").value = "Label black";


        function jmmodelkit() {
           var scpt;
           var jjj = document.getElementById("jmolmodelkit").value;
           if  (jjj == "ModelKit off") {
              scpt = "set modelkitMode = false;"
              document.getElementById("jmolmodelkit").value = "ModelKit on";
           } else {
              scpt = "set modelkitMode = true;"
              document.getElementById("jmolmodelkit").value = "ModelKit off";
           }
           jms0(scpt);
        }
        //document.getElementById("jmolmodelkit").value = "ModelKit off";

        function jmmovemolecule() {
           jms('unbind; unbind _wheelZoom; unbind "DOUBLE"; set picking off; set picking on; set allowRotateSelected false; set modelKitMode false;');
           jms('set picking off; set picking ON; set atomPicking true; set allowRotateSelected TRUE; set picking dragmolecule;bind "double" "javascript moveMol(2)";');
        }
        function jmmoveatom() {
           jms('unbind; unbind _wheelZoom; unbind "DOUBLE"; set picking off; set picking on; set allowRotateSelected false; set modelKitMode false;');
           jms('set picking off; set picking ON; set picking DRAGATOM; bind "double" "javascript moveMol(1)";');
        }
        function jmrotatebond() {
           jms('unbind; unbind _wheelZoom; unbind "DOUBLE"; set picking off; set picking on; set allowRotateSelected false; set modelKitMode false;');
           jms('set Picking OFF;set Picking ON;set Picking ROTATEBOND;unbind "LEFT-DRAG";bind "LEFT-DRAG" "_rotateBranch";hover off;unbind "WHEEL";bind "WHEEL" "select *;color cpk"');
        }
        function jmrotatemolecule() {
           jms('unbind; unbind _wheelZoom; unbind "DOUBLE"; set picking off; set picking on; set allowRotateSelected false; set modelKitMode false;');
           jms('set picking off; set picking ON;set atomPicking true;set picking dragmolecule;set allowRotateSelected TRUE;bind "drag" "_rotateselected";bind "double" "javascript moveMol(3)";');
        }

        function charge_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var charge = eval(jmvar("{*}.formalCharge.sum"));
           if (arrows_input.includes("^{")) {
              charge = eval(arrows_input.split("^{")[1].split("}")[0].trim());
           }
           return charge;
        }
        function mult_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var charge = eval(jmvar("{*}.formalCharge.sum"));
           if (arrows_input.includes("^{")) {
              charge = eval(arrows_input.split("^{")[1].split("}")[0].trim());
           }
           var mult = (eval(jmvar("{*}.elemno.sum")) + charge) % 2 + 1;
           if (arrows_input.includes("mult{")) {
              mult = eval(arrows_input.split("mult{")[1].split("}")[0].trim());
           }
           return mult;
        }
        function theory_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var theory = "pspw";
           if (arrows_input.includes("theory{")) {
              theory = arrows_input.split("theory{")[1].split("}")[0].trim();
           } else {
              var ispspw = document.getElementById("bandpspw").value == "PSPW calculation";
              var ispspw4 = document.getElementById("bandpspw").value == "PSPW4 calculation";
              var isband  = document.getElementById("bandpspw").value == "BAND calculation";
              var isdft  = document.getElementById("bandpspw").value == "DFT calculation";
              var isscf  = document.getElementById("bandpspw").value == "HF calculation";
              var ismp2  = document.getElementById("bandpspw").value == "MP2 calculation";
              if (ispspw) {theory= "pspw"; }
              if (ispspw4) {theory= "pspw4"; }
              if (isband) {theory= "band"; }
              if (isdft) {theory= "dft"; }
              if (isscf) {theory= "hf"; }
              if (ismp2) {theory= "mp2"; }
           }
           return theory;
        }
        function theory_arrowsdata2() {
           var pspw = theory_arrowsdata();
           if (pspw=="pspw4") {pspw="pspw";}
           return pspw;
        }

        function theory_property_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var theory = "pspw";
           if (arrows_input.includes("theory_property{")) {
              theory = arrows_input.split("theory_property{")[1].split("}")[0].trim();
           }
           return theory;
        }
        function basis_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var basis = "default";
           if (arrows_input.includes("basis{")) {
              basis = arrows_input.split("basis{")[1].split("}")[0].trim();
           } else {
              basis = document.getElementById("basis_type").value;
           }
           basis = basis.replace("cartesian","").replace("spherical","");
           if ((theory_arrowsdata().includes("pspw")) || (theory_arrowsdata().includes("band"))) {
              if ((basis.includes("def2")) || (basis.includes("6-31"))) {
                 basis = "default";
              }
              if (basis.includes("Ry")) {
                 basis = parseFloat(basis.split("Ry")[0].trim())*0.5;
                 basis = basis.toFixed(1);
              }
           } else {
              if (basis.includes("Ry")) {
                 basis = "default";
              }
           }
           return basis;
        }
        function isspherical_basis_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var basis = "default";
           if (arrows_input.includes("basis{")) {
              basis = arrows_input.split("basis{")[1].split("}")[0].trim();
           } else {
              basis = document.getElementById("basis_type").value;
           }
           var spherical = basis.includes("spherical");
           console.log("spherical=",spherical);
           return spherical;
        }

        function basis_property_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var basis = "default";
           if (arrows_input.includes("basis_property{")) {
              basis = arrows_input.split("basis_property{")[1].split("}")[0].trim();
           }
           return basis;
        }
        function basisHZ_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var basis = "default";
           if (arrows_input.includes("basisHZ{")) {
              basis = arrows_input.split("basisHZ{")[1].split("}")[0].trim();
           }
           return basis;
        }
        function basisHZ_property_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var basis = "default";
           if (arrows_input.includes("basisHZ_property{")) {
              basis = arrows_input.split("basisHZ_property{")[1].split("}")[0].trim();
           }
           return basis;
        }
        function xc_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var xc = "default";
           if (arrows_input.includes("xc{")) {
              xc = arrows_input.split("xc{")[1].split("}")[0].trim();
           } else {
              xc = document.getElementById("xc_type").value;
           }
           if ((xc=="m06-2x") && ((theory_arrowsdata().includes("pspw")) || (theory_arrowsdata().includes("band")))) {
              xc = "default";
           }
           if (xc=="default") {
              xc = "b3lyp";
              if ((arrows_input.includes("pspw")) || ((theory_arrowsdata().includes("pspw")) || (theory_arrowsdata().includes("band")))) {
                 xc = "pbe";
              }
              if ((theory_arrowsdata().includes("mp2")) || (theory_arrowsdata().includes("hf"))) {
                 xc = "xxx";
              }
           }
           return xc;
        }
        function xc_property_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var xc = "pspw";
           if (arrows_input.includes("xc_property{")) {
              xc = arrows_input.split("xc_property{")[1].split("}")[0].trim();
           }
           return xc;
        }
        function solvation_type_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var solvation_type = "None";
           if (arrows_input.includes("theory{pspw")) {
              solvation_type = "None";
           }
           if (arrows_input.includes("solvation_type{")) {
              solvation_type = arrows_input.split("solvation_type{")[1].split("}")[0].trim();
           }
           return solvation_type;
        }
        function calculation_type_arrowsdata() {
           var arrows_input = document.form.smi.value;
           var calculation_type = "e";
           if (arrows_input.includes("theory{pspw")) {
              calculation_type = "e";
           }
           if (arrows_input.includes("calculation_type{")) {
              calculation_type = arrows_input.split("calculation_type{")[1].split("}")[0].trim();
           }
           return calculation_type;
        }



	function readMolecule() {
		var mol = exMod();
                jsmeApplet.reset();
                jsmeApplet.readMolFile(mol);
	}

        function esmiles2dWindow() {

           var mol    = document.form2.smi.value.split("~")[0];
           var re = /\+/g;
           var re2 = / /g;
           mol = mol.split("~")[0];

           mol = mol.replace(re, ".");
           mol = mol.replace("-->",">>");

           var smiles = mol.replace(re2,"");

           jsmeApplet.readGenericMolecularInput(smiles);
        }

	function appendMolecule() {
		var mol = exMod();
                jsmeApplet.readMolFile(mol);
	}

	function readMultipart() {
		var jme = "9 9 C 6.68 -7.15 C 5.47 -6.45 C 4.26 -7.15 C 4.26 -8.55 C 5.47 -9.25 C 6.68 -8.55 C 5.47 -5.05 O- 6.68 -4.35 O 4.26 -4.35 1 2 1 2 3 2 3 4 1 4 5 2 5 6 1 6 1 2 2 7 1 7 8 1 7 9 2|1 0 Na+ 12.21 -6.61";
		jsmeApplet.readMolecule(jme) // or document.JME.readMolecule(jme
	}

	function readReaction() {
		var jme = "3 2 C:1 1.41 -7.12 O:2 1.41 -5.72 Cl 2.63 -7.82 1 2 2 1 3 1|3 2 N:3 5.72 -6.78 C:4 7.12 -6.78 H:5 5.02 -7.99 1 2 1 1 3 1 >> 5 4 C:1 13.51 -6.40 O:2 13.51 -5.00 N:3 14.72 -7.10 C:4 15.94 -6.40 H:5 14.71 -8.50 1 2 2 1 3 1 3 4 1 3 5 1";
		jsmeApplet.readMolecule(jme);
	}

	function getMolfile() {
		var data = document.JME.molFile();
		document.getElementById("jme_output").value = data;

	}
	function getSmiles() {
                var drawing = document.JME.smiles();
                document.form.smi.value = drawing;
	}
	function appendSmiles() {
                var drawing = document.JME.smiles();
                var re = /\./g;
                drawing = drawing.replace(re, " + ");
                drawing = drawing.replace(">>"," --> ");
                document.form2.smi.value += drawing;
	}

	function appendSmiles2() {
                //jms("xxsmiles = {1.1}.find(\"SMILES\");");
                //var drawing = jmvar("xxsmiles");
                var drawing = jmvar("{1.1}.find(\"SMILES\")");
                //var re = /\./g;
                //drawing = drawing.replace(re, " + ");
                drawing = drawing.replace(">>"," --> ");
                document.form.smi.value += drawing;
	}

	function appendXYZ2() {
           var hasreaction = document.getElementById("jmolreactionplane").value == "Reaction off";
           if (hasreaction) {
              var i,ii,jj,kk,tmp,xyz,q,reactants,products;
              var mol = exMod();
              var header = mol.split("V2000")[0];
              var geombonds = mol.split("V2000")[1].trim();
              var nion  = eval(header.split("\n").pop().trim().split(" ")[0]);
              var nbond = eval(header.split("\n").pop().trim().split(/[ ,]+/)[1]);
              var geom0 = geombonds.trim().split("\n").slice(0,nion);
              var bond0 = geombonds.trim().split("\n").slice(nion,nion+nbond);
              var graph0 = Array.apply(null, Array(nion*nion)).map(Number.prototype.valueOf,0);
              var charge0 =  jmvar("{*}.formalCharge.all");
              for (i=0; i<bond0.length; ++i) {
                 tmp = bond0[i].trim().split(/[ ,]+/);
                 ii = eval(tmp[0])-1;
                 jj = eval(tmp[1])-1;
                 kk = eval(tmp[2]);
                 graph0[ii+jj*nion] = kk;
                 graph0[jj+ii*nion] = kk;
              }
              var molecules0 = Array.apply(null, Array(nion)).map(Number.prototype.valueOf,0);
              var mc = 0;
              var foundlink;
              for (ii=0; ii<nion; ++ii) {
                 foundlink = 0;
                 for (jj=0; jj<ii; ++jj) {
                    if ((graph0[ii+jj*nion]>0) && (molecules0[jj]>0)) {
                       foundlink = molecules0[jj];
                    }
                 }
                 if (foundlink==0) {
                    mc += 1;
                    foundlink = mc;
                 }
                 molecules0[ii] = foundlink;
              }
              var signx0;
              reactants = [];
              products  = [];
              for (i=0; i<mc; ++i) {
                 xyz = '';
                 q = 0;
                 signx0 = -1;
                 for (ii=0; ii<nion; ++ii) {
                    if (molecules0[ii]==(i+1)) {
                       if (eval(geom0[ii].trim().split(/[ ,]+/)[0])>0.0) {
                          signx0 = 1;
                       }
                       xyz += geom0[ii].trim().split(/[ ,]+/)[3] + " ";
                       xyz += geom0[ii].trim().split(/[ ,]+/)[0] + " ";
                       xyz += geom0[ii].trim().split(/[ ,]+/)[1] + " ";
                       xyz += geom0[ii].trim().split(/[ ,]+/)[2] + "\n";
                       q += charge0[ii];
                    }
                 }
                 if (xyz.includes("Mt")) {
                    xyz = " SHE ";
                 } else {
                    xyz = " xyzdata{" + xyz.trim().replace(/\n/g,' | ') + "}";
                    if (q!=0.0) {
                       xyz += " ^{" + q.toString() + "} "
                    }
                 }
                 if (signx0<0) {
                    reactants.push(xyz);
                 } else {
                    products.push(xyz);
                 }
              }
              if (document.form.smi.value.includes("~")) {
                 tmp = document.form.smi.value.split("~")[1].trim();
              } else {
                 tmp = '';
              }
              document.form.smi.value = reactants.join(" + ")  + " --> " + products.join(" + ");
              if (tmp!='') {
                 document.form.smi.value += " ~ " + tmp;
              }
           } else {
                var charge  = charge_arrowsdata();
                var xyzdat  = jmvar("data({1.1},\"xyz\")");
                if (xyzdat.includes('Mt')) {
                   var ss = xyzdat.split('\n');
                   xyzdat = ''
                   for (var i=0; i<ss.length; ++i) {
                      if (!ss[i].includes('Mt')) {
                         xyzdat += ss[i] + '\n';
                      }
                   }
                }
                var drawing = " xyzdata{" + xyzdat.trim().replace(/\n/g,' | ') + "}";
                if (charge!=0.0) {
                   drawing += " ^{" + charge.toString() + "}"
                }
                document.form.smi.value += drawing;
	   }

           // Add unit cell info
           document.form.smi.value += " unitcell{lattice_vectors | ";
           document.form.smi.value += document.getElementById("lattice_a1").value + " | ";
           document.form.smi.value += document.getElementById("lattice_a2").value + " | ";
           document.form.smi.value += document.getElementById("lattice_a3").value + "}";

	}

	function convert2XYZ() {
           var i,n,x,y,m,latblock,isfrac;
           var data = editor.getValue(); // or session.getValue
           var lines = data.split("\n");
           if (data.includes("V2000")) {
              data = lines[3].trim().split(" ")[0];
              n = eval(data);
              data += "\n\n";
              n += 4;
              for (i=4; i<n; i++) {
                 x = lines[i].trim().split(/[ ,]+/);
                 data += x[3] + " "; 
                 data += x[0] + " ";
                 data += x[1] + " ";
                 data += x[2] + "\n";
              }
              editor.setValue(data);
           } 

           if (data.includes("geometry")) {
              n = lines.length;
              m = 0;
              x = false;
              y = false;
              isfrac = false;
              data = "";
              latblock = "";
              for (i=0; i<n; i++) {
                 if (lines[i].includes("geometry")) {
                    x = true;
                 } else if (lines[i].includes("system crystal")) {
                    y = true;
                    isfrac = true;
                 } else if (lines[i].includes("end") && (y)) {
                    y = false;
                 } else if (y) {
                    latblock += lines[i] + "\n";
                 } else if (lines[i].includes("end") && (x)) {
                    x = false;
                 } else if (x) {
                    if (lines[i].trim().length>0) {
                       if (isfrac) {
                           var sym = lines[i].trim().split(/[ ,]+/)[0];
                           var f1  = eval(lines[i].trim().split(/[ ,]+/)[1]);
                           var f2  = eval(lines[i].trim().split(/[ ,]+/)[2]);
                           var f3  = eval(lines[i].trim().split(/[ ,]+/)[3]);
                           var ll = latblock.split("lattice_vectors")[1].trim().split("\n");
                           var a1 = [eval(ll[0].trim().split(/[ ,]+/)[0]),
                                     eval(ll[0].trim().split(/[ ,]+/)[1]),
                                     eval(ll[0].trim().split(/[ ,]+/)[2])];
                           var a2 = [eval(ll[1].trim().split(/[ ,]+/)[0]),
                                     eval(ll[1].trim().split(/[ ,]+/)[1]),
                                     eval(ll[1].trim().split(/[ ,]+/)[2])];
                           var a3 = [eval(ll[2].trim().split(/[ ,]+/)[0]),
                                     eval(ll[2].trim().split(/[ ,]+/)[1]),
                                     eval(ll[2].trim().split(/[ ,]+/)[2])];
                           var xx = f1*a1[0] + f2*a2[0] + f3*a3[0];
                           var yy = f1*a1[1] + f2*a2[1] + f3*a3[1];
                           var zz = f1*a1[2] + f2*a2[2] + f3*a3[2];
                           data += sym + " " + xx.toFixed(6) + " " + yy.toFixed(6) + " " + zz.toFixed(6) + "\n";
                       } else {
                          data += lines[i] + "\n";
                       }
                       m += 1;
                    }
                 }
              }
              if (latblock.includes("lattice_vectors")) {
                 latblock = latblock.split("lattice_vectors")[1].trim().split("\n").join("").trim();
              } else {
                 latblock = ""
              }
              data = m.toString() + "\n" + latblock + "\n" + data;
              editor.setValue(data);
           }
        } 


        function symbols_ncharge(symbols,q) {
           var periodic_table_charge = { 'H'  : 1, 'He' : 2, 'Li' : 3, 'Be' : 4, 'B'  : 5, 'C'  : 6, 'N'  : 7, 'O'  : 8, 'F'  : 9, 'Ne' : 10, 'Na' : 11, 'Mg' : 12, 'Al' : 13, 'Si' : 14, 'P'  : 15, 'S'  : 16, 'Cl' : 17, 'Ar' : 18, 'K'  : 19, 'Ca' : 20, 'Sc' : 21, 'Ti' : 22, 'V'  : 23, 'Cr' : 24, 'Mn' : 25, 'Fe' : 26, 'Co' : 27, 'Ni' : 28, 'Cu' : 29, 'Zn' : 30, 'Ga' : 31, 'Ge' : 32, 'As' : 33, 'Se' : 34, 'Br' : 35, 'Kr' : 36, 'Rb' : 37, 'Sr' : 38, 'Y'  : 39, 'Zr' : 40, 'Nb' : 41, 'Mo' : 42, 'Tc' : 43, 'Ru' : 44, 'Rh' : 45, 'Pd' : 46, 'Ag' : 47, 'Cd' : 48, 'In' : 49, 'Sn' : 50, 'Sb' : 51, 'Te' : 52, 'I'  : 53, 'Xe' : 54, 'Cs' : 55, 'Ba' : 56, 'La' : 57, 'Ce' : 58, 'Pr' : 59, 'Nd' : 60, 'Pm' : 61, 'Sm' : 62, 'Eu' : 63, 'Gd' : 64, 'Tb' : 65, 'Dy' : 66, 'Ho' : 67, 'Er' : 68, 'Tm' : 69, 'Yb' : 70, 'Lu' : 71, 'Hf' : 72, 'Ta' : 73, 'W'  : 74, 'Re' : 75, 'Os' : 76, 'Ir' : 77, 'Pt' : 78, 'Au' : 79, 'Hg' : 80, 'Tl' : 81, 'Pb' : 82, 'Bi' : 83, 'Po' : 84, 'At' : 85, 'Rn' : 86, 'Fr' : 87, 'Ra' : 88, 'Ac' : 89, 'Th' : 90, 'Pa' : 91, 'U'  : 92, 'Np' : 93, 'Pu' : 94, 'Am' : 95, 'Cm' : 96, 'Bk' : 97, 'Cf' : 98, 'Es' : 99, 'Fm' : 100, 'Md' : 101, 'No' : 102, 'Lr' : 103, 'Rf' : 104, 'Ha' : 105, 'Sg' : 106, 'Bh' : 107, 'Hs' : 108, 'Mt' : 109 };
           var i;
           var ncharge = -q;
           for (i=0; i<symbols.length; i++) {
               ncharge += periodic_table_charge[symbols[i]];
           }
           return ncharge;
        }

        function makegaussianbasis(basis,basisHZ,katom) {
           var i,aa;
           var periodic_table_charge = { 'H'  : 1, 'He' : 2, 'Li' : 3, 'Be' : 4, 'B'  : 5, 'C'  : 6, 'N'  : 7, 'O'  : 8, 'F'  : 9, 'Ne' : 10, 'Na' : 11, 'Mg' : 12, 'Al' : 13, 'Si' : 14, 'P'  : 15, 'S'  : 16, 'Cl' : 17, 'Ar' : 18, 'K'  : 19, 'Ca' : 20, 'Sc' : 21, 'Ti' : 22, 'V'  : 23, 'Cr' : 24, 'Mn' : 25, 'Fe' : 26, 'Co' : 27, 'Ni' : 28, 'Cu' : 29, 'Zn' : 30, 'Ga' : 31, 'Ge' : 32, 'As' : 33, 'Se' : 34, 'Br' : 35, 'Kr' : 36, 'Rb' : 37, 'Sr' : 38, 'Y'  : 39, 'Zr' : 40, 'Nb' : 41, 'Mo' : 42, 'Tc' : 43, 'Ru' : 44, 'Rh' : 45, 'Pd' : 46, 'Ag' : 47, 'Cd' : 48, 'In' : 49, 'Sn' : 50, 'Sb' : 51, 'Te' : 52, 'I'  : 53, 'Xe' : 54, 'Cs' : 55, 'Ba' : 56, 'La' : 57, 'Ce' : 58, 'Pr' : 59, 'Nd' : 60, 'Pm' : 61, 'Sm' : 62, 'Eu' : 63, 'Gd' : 64, 'Tb' : 65, 'Dy' : 66, 'Ho' : 67, 'Er' : 68, 'Tm' : 69, 'Yb' : 70, 'Lu' : 71, 'Hf' : 72, 'Ta' : 73, 'W'  : 74, 'Re' : 75, 'Os' : 76, 'Ir' : 77, 'Pt' : 78, 'Au' : 79, 'Hg' : 80, 'Tl' : 81, 'Pb' : 82, 'Bi' : 83, 'Po' : 84, 'At' : 85, 'Rn' : 86, 'Fr' : 87, 'Ra' : 88, 'Ac' : 89, 'Th' : 90, 'Pa' : 91, 'U'  : 92, 'Np' : 93, 'Pu' : 94, 'Am' : 95, 'Cm' : 96, 'Bk' : 97, 'Cf' : 98, 'Es' : 99, 'Fm' : 100, 'Md' : 101, 'No' : 102, 'Lr' : 103, 'Rf' : 104, 'Ha' : 105, 'Sg' : 106, 'Bh' : 107, 'Hs' : 108, 'Mt' : 109 };
           var foundHZ = false;
           var str = "basis \"ao basis\" cartesian print\n";
           if (isspherical_basis_arrowsdata()) {
              str = "basis \"ao basis\" spherical print\n";
           }

           for (i=0; i<katom.length; i++) {
              aa = katom[i];
              if (periodic_table_charge[aa]<21) {
                 if (basis=='default') { 
                    str += " " + aa + " library \"6-311++G(2d,2p)\"" + "\n";
                 } else {
                    str += " " + aa + " library " + basis + "\n";
                 }
              } else {
                 if (basisHZ=='default') {
                    if (periodic_table_charge[aa]<37) {
                       str += " " + aa + " library aug-cc-pVTZ" + "\n";
                    } else if (periodic_table_charge[aa]<87) {
                       str += " " + aa + " library Def2-TZVPD" + "\n";
                       foundHZ = true;
                    } else {
                       str += " " + aa + " library crenbl_ecp" + "\n";
                       foundHZ = true;
                    }
                 } else {
                    str += " " + aa + " library " + basisHZ + "\n";
                    if (periodic_table_charge[aa]>=37) {
                       foundHZ = true;
                    }
                 } 
              } 
           }
           str += "end\n";

           if (foundHZ) { 
              str += "ecp\n"
              for (i=0; i<katom.length; i++) {
                 aa = katom[i];
                 if (periodic_table_charge[aa]>=37) {
                    if (basisHZ=='default') { 
                       if (periodic_table_charge[aa]<87) {
                          str += " " + aa + " library Def2-TZVPD" + "\n";
                       } else {
                          str += " " + aa + " library crenbl_ecp" + "\n";
                       }
                    } else {
                       str += " " + aa + " library " + basisHZ + "\n";
                    }
                 }
              }
              str += "end\n";
           }
           str += "\n";
           return str;
        }

        function makegeom_neb(periodic) {
           var models = prompt("Please reaction and product model numbers:", "1 2");
           var amodel1 = parseInt(models.split(/[ ,]+/)[0])-1;
           var amodel2 = parseInt(models.split(/[ ,]+/)[1])-1;
           console.log("model1=",amodel1);
           console.log("model2=",amodel2);

           //*** generate neb_start geometry input ***
           var eoln = "\n";
           var tstr = '';
           tstr += eoln+eoln+eoln;
           if (periodic) {
              tstr += "nwpw\n";
              tstr += fetchframelat(amodel1);
              tstr += "end\n\n";
           }
           tstr += "geometry units angstroms print xyz noautosym noautoz nocenter"+eoln;
           tstr += fetchframexyz(amodel1);
           tstr += "end"+eoln;

           //*** generate neb_end geometry input ***
           tstr += eoln+eoln+eoln;
           tstr += "geometry neb_end units angstroms print xyz noautosym noautoz nocenter"+eoln;
           tstr += fetchframexyz(amodel2);
           tstr += "end"+eoln;

           return tstr;
        }


        function prepend_header() {
           var x;
           var data  = editor.getValue(); // or session.getValue
           var lines = data.split("\n");
           var machine = "we31869";
           var ncpus = "6";
           var permdir_tag = document.getElementById("permdir_tag").value.trim();
           var machine = document.getElementById("machine").value;
           if (machine.includes("cori"))     { ncpus="48";}
           if (machine.includes("gulfport")) { ncpus="32";}
           if (machine.includes("samsung"))  { ncpus="32";}
           if (machine.includes("aerosol"))  { ncpus="32";}
           var ii = Math.floor(Math.random() * 1000) + 1;
           var mformula = "aerosol-" + ii;
           mformula = prompt("Please enter jobname:", mformula);

           x =  "#nwchem_input  " + mformula + ".nw\n";
           x += "#nwchem_output " + mformula + ".out00\n";
           x += "#nwchem_done   " + mformula + ".done\n";
           x += "#\n";
           x += "#mformula_off\n";
           x += "#\n";
           x += "#transfer_files *.nw *.xyz *.ion_motion *.emotion *.fei *.cif *.hist *.gr *.dat *.meta_gaussians *.cube *.neb_epath *.neb_final_epath\n";
           x += "#bad_files md_xs\n";
           x += "#\n";
           x += "#\n";
           x += "#permdir " + mformula + permdir_tag + "\n";
           //x += "#deletescratch no\n";
           x += "#deletescratch yes\n";
           x += "#queuesave no\n"
           x += "#\n";
           x += "#machine " + machine + "\n";
           x += "#cputime 18:05:00\n";
           x += "#ncpus " + ncpus + "\n";
           x += "#queue regular\n";
           x += "#\n";

           if (!data.includes("title")) {
              x += "title \"NWChem job: " + mformula + "\"\n\n";
           }
           data = x + data;
           editor.setValue(data); // or session.getValue
        }





        // ****************************
        // *                          *
        // *     convert2geometry     *
        // *                          *
        // ****************************
	function convert2geometry(iscif) {
           var i,n,x,y,z,a1,a2,a3,b1,b2,b3,lat,fdata,cifdata,cifdata2,tt,haslattice,symbol;
           var symbols = [];
           var xyz     = [];
           var data  = editor.getValue(); // or session.getValue
           var lines = data.split("\n");
           var machine = "we31869";
           var ncpus = "6";
           var permdir_tag = document.getElementById("permdir_tag").value.trim();
            
           if (!iscif) {
              machine = document.getElementById("machine").value;
              if (machine.includes("cori"))     { ncpus="48";}
              if (machine.includes("gulfport")) { ncpus="32";}
              if (machine.includes("samsung"))  { ncpus="32";}
              if (machine.includes("aerosol"))  { ncpus="32";}
              //ncpus   = prompt("Please enter number cpus:", ncpus);
           }

           var today = new Date();
           var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
           var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
           var dateTime = date+' '+time;
           var geomlattice =  document.getElementById("latticelocation").value == "Lattice in geometry block";
           var reading = 0;

           if (data.includes("_cell_length_a")) { //read cif data
              reading = 1;
              var [fracgeom,lattice,symmetry] = parse_cif(data);
              lat = lattice[6];
              a1 = lattice[0];
              a2 = lattice[1];
              a3 = lattice[2];

              data  = "geometry\n";
              fdata = "geometry noautoz nocenter noautosym\n";
              if (geomlattice) {
                 fdata += "system crystal\n";
                 fdata += "   lattice_vectors\n";
                 fdata += "     " + vec3_to_string3(a1) + "\n";
                 fdata += "     " + vec3_to_string3(a2) + "\n";
                 fdata += "     " + vec3_to_string3(a3) + "\n";
                 fdata += "end\n\n";
              }
              cifdata = "data_emsl_arrows\n\n";
              cifdata += "_audit_creation_date " + dateTime + "\n";
              cifdata += "_audit_creation_method generated by Tiny Arrows\n";
              cifdata += "\n\n";
              cifdata += "_cell_length_a     " + lat[0].toFixed(4) + "\n";
              cifdata += "_cell_length_b     " + lat[1].toFixed(4) + "\n";
              cifdata += "_cell_length_c     " + lat[2].toFixed(4) + "\n";
              cifdata += "_cell_angle_alpha " + lat[3].toFixed(4) + "\n";
              cifdata += "_cell_angle_beta  " + lat[4].toFixed(4) + "\n";
              cifdata += "_cell_angle_gamma " + lat[5].toFixed(4) + "\n\n";
              cifdata += "_symmetry_space_group_name_H-M     P1\n\n";

              cifdata += "loop_\n";
              cifdata += "_atom_site_type_symbol\n";
              cifdata += "_atom_site_fract_x\n";
              cifdata += "_atom_site_fract_y\n";
              cifdata += "_atom_site_fract_z\n";
              for (i=0; i<fracgeom.length; ++i) {
                 var symb = fracgeom[i][0];
                 var f1   = fracgeom[i][1];
                 var f2   = fracgeom[i][2];
                 var f3   = fracgeom[i][3];
                 x = f1*a1[0] + f2*a2[0] + f3*a3[0];
                 y = f1*a1[1] + f2*a2[1] + f3*a3[1];
                 z = f1*a1[2] + f2*a2[2] + f3*a3[2];
                 cifdata += symb + " " + f1.toFixed(6) + " " + f2.toFixed(6) + " " + f3.toFixed(6) + "\n";
                 fdata   += symb + " " + f1.toFixed(6) + " " + f2.toFixed(6) + " " + f3.toFixed(6) + "\n";
                 data    += symb + " " + x.toFixed(6) + " " + y.toFixed(6) + " " + z.toFixed(6) + "\n";
              }
              data  = data.trim() + "\n";
              fdata = fdata.trim() + "\n";
              data  += "end\n";
              fdata += "end\n";

           } else if (data.includes("geometry")) { //read nwchem data
              reading = 2;
              n = lines.length;
              x = false;
              y = false;
              z = 999;
              data  = "";
              fdata = "";
              cifdata2 = "";
              cifdata = "data_emsl_arrows\n\n";
              cifdata += "_audit_creation_date " + dateTime + "\n";
              cifdata += "_audit_creation_method generated by Tiny Arrows\n";
              cifdata += "\n\n";
              for (i=0; i<n; i++) {
                 if (lines[i].includes("geometry")) {
                    x = true;
                    data += lines[i] + "\n";
                    fdata += lines[i] + "\n";
                 } else if (lines[i].includes("lattice_vectors")) {
                    fdata += lines[i] + "\n";
                    z = 1;
                 } else if (z==1) {
                    fdata += lines[i] + "\n";
                    tt = lines[i];
                    z = 2;
                 } else if (z==2) {
                    fdata += lines[i] + "\n";
                    tt +=  " " + lines[i];
                    z = 3;
                 } else if (z==3) {
                    fdata += lines[i] + "\n";
                    tt +=  " " + lines[i];
                    [[a1,a2,a3,b1,b2,b3,lat],haslattice]  =  xyzrow2_to_lattice(tt.trim().split(/[ ,]+/));
                    cifdata += "_cell_length_a     " + lat[0].toFixed(4) + "\n";
                    cifdata += "_cell_length_b     " + lat[1].toFixed(4) + "\n";
                    cifdata += "_cell_length_c     " + lat[2].toFixed(4) + "\n";
                    cifdata += "_cell_angle_alpha " + lat[3].toFixed(4) + "\n";
                    cifdata += "_cell_angle_beta  " + lat[4].toFixed(4) + "\n";
                    cifdata += "_cell_angle_gamma " + lat[5].toFixed(4) + "\n\n";
                    cifdata += "_symmetry_space_group_name_H-M     P1\n\n";

                    cifdata += "loop_\n";
                    cifdata += "_atom_site_type_symbol\n";
                    cifdata += "_atom_site_fract_x\n";
                    cifdata += "_atom_site_fract_y\n";
                    cifdata += "_atom_site_fract_z\n";
                    z = 4;
                 } else if (lines[i].includes("system crystal")) {
                    fdata += lines[i] + "\n";
                    y = true;
                 } else if ((lines[i].includes("end")) && (y) ) {
                    y = false;
                    fdata += lines[i] + "\n";
                 } else if (y) {
                    fdata += lines[i] + "\n";
                 } else if ((lines[i].includes("end")) && (x) ) {
                    x = false;
                    data += lines[i] + "\n";
                    fdata += lines[i] + "\n";
                 } else if (x) {
                    fdata += lines[i] + "\n";
                    if (lines[i].trim().length>0) {
                       data += lines[i] + "\n";
                       cifdata2 += lines[i] + "\n";
                       symbols.push(lines[i].trim().split(/[ ,]+/)[0]);
                       xyz.push(lines[i].trim().split(/[ ,]+/)[1]);
                       xyz.push(lines[i].trim().split(/[ ,]+/)[2]);
                       xyz.push(lines[i].trim().split(/[ ,]+/)[3]);
                    }
                 }
              }
           } else { // read xyz data 
              reading = 3;
              [[a1,a2,a3,b1,b2,b3,lat],haslattice] =  xyzrow2_to_lattice(lines[1].trim().split(/[ ,]+/));
              console.log("a1=",a1);
              console.log("a2=",a2);
              console.log("a3=",a3);
              console.log("b1=",b1);
              console.log("b2=",b2);
              console.log("b3=",b3);
              n = eval(lines[0].trim().split(" ")[0]);
              cifdata2 = "";
              cifdata = "data_emsl_arrows\n\n";
              cifdata += "_audit_creation_date " + dateTime + "\n";
              cifdata += "_audit_creation_method generated by Tiny Arrows\n";
              cifdata += "\n\n";
              cifdata += "_cell_length_a     " + lat[0].toFixed(4) + "\n";
              cifdata += "_cell_length_b     " + lat[1].toFixed(4) + "\n";
              cifdata += "_cell_length_c     " + lat[2].toFixed(4) + "\n";
              cifdata += "_cell_angle_alpha " + lat[3].toFixed(4) + "\n";
              cifdata += "_cell_angle_beta  " + lat[4].toFixed(4) + "\n";
              cifdata += "_cell_angle_gamma " + lat[5].toFixed(4) + "\n\n";
              cifdata += "_symmetry_space_group_name_H-M     P1\n\n";

              cifdata += "loop_\n";
              cifdata += "_atom_site_type_symbol\n";
              cifdata += "_atom_site_fract_x\n";
              cifdata += "_atom_site_fract_y\n";
              cifdata += "_atom_site_fract_z\n";
     
              fdata = "geometry noautoz nocenter noautosym\n";
              if ((haslattice) && (geomlattice)) {
                 fdata += "system crystal\n"
                 fdata += "   lattice_vectors\n";
                 fdata += "     " + a1[0].toFixed(6) + " " + a1[1].toFixed(6) + " " + a1[2].toFixed(6) + "\n";
                 fdata += "     " + a2[0].toFixed(6) + " " + a2[1].toFixed(6) + " " + a2[2].toFixed(6) + "\n";
                 fdata += "     " + a3[0].toFixed(6) + " " + a3[1].toFixed(6) + " " + a3[2].toFixed(6) + "\n";
                 fdata += "end\n\n";
              }
              data = "geometry\n";
              n += 2;
              for (i=2; i<n; i++) {
                 data += lines[i] + "\n";
                 if ((haslattice) && (geomlattice)) {
                    symbol = lines[i].trim().split(/[ ,]+/)[0];
                    x = eval(lines[i].trim().split(/[ ,]+/)[1]);
                    y = eval(lines[i].trim().split(/[ ,]+/)[2]);
                    z = eval(lines[i].trim().split(/[ ,]+/)[3]);
                    var f1 = x*b1[0] + y*b1[1] + z*b1[2];
                    var f2 = x*b2[0] + y*b2[1] + z*b2[2];
                    var f3 = x*b3[0] + y*b3[1] + z*b3[2];
                    fdata += symbol + " " + f1.toFixed(6) + " " + f2.toFixed(6) + " " + f3.toFixed(6) + "\n";
                 } else {
                    fdata += lines[i] + "\n";
                 }
                 cifdata2 += lines[i] + "\n";
                 symbols.push(lines[i].trim().split(/[ ,]+/)[0]);
                 xyz.push(lines[i].trim().split(/[ ,]+/)[1]);
                 xyz.push(lines[i].trim().split(/[ ,]+/)[2]);
                 xyz.push(lines[i].trim().split(/[ ,]+/)[3]);
              }
              data  = data.trim() + "\n";
              fdata = fdata.trim() + "\n";
              data  += "end\n";
              fdata += "end\n";
           }

 
           
           // Add Header
           var katom    = jmvar("{*}.find(\"MF\")").replace(/[0-9]/g,'').trim().split(/[ ,]+/);
           var mformula = jmvar("{*}.find(\"MF\")").replace(/ /g,'');
           var theory  = theory_arrowsdata();
           var basis   = basis_arrowsdata();
           var basisHZ = basisHZ_arrowsdata();
           var xc      = xc_arrowsdata();
           var charge  = charge_arrowsdata();
           var mult    = mult_arrowsdata();
           var calculation_type = calculation_type_arrowsdata();
           var solvation_type   = solvation_type_arrowsdata();
           var jobname = theory + "_" + xc + "_" + mformula;

           if (calculation_type.includes("a")) {
               data = "";
               fdata = "";
               mformula += "-neb";
           }

           x =  "#nwchem_input  " + mformula + ".nw\n";
           x += "#nwchem_output " + mformula + ".out00\n";
           x += "#nwchem_done   " + mformula + ".done\n";
           x += "#\n";
           x += "#mformula_off\n";
           x += "#\n";
           x += "#transfer_files *.nw *.xyz *.ion_motion *.emotion *.fei *.cif *.hist *.gr *.dat *.meta_gaussians *.cube *.neb_epath *.neb_final_epath\n";
           x += "#bad_files md_xs\n";
           x += "#\n";
           x += "#\n";
           x += "#permdir " + mformula + permdir_tag + "\n";
           x += "#deletescratch no\n";
           x += "#queuesave no\n"
           x += "#\n";
           x += "#machine " + machine + "\n";
           x += "#cputime 18:05:00\n";
           x += "#ncpus " + ncpus + "\n";
           x += "#queue regular\n";
           x += "#\n";

           x += "title \"swnc: " + calculation_type;
           x += " theory=" + theory;
           x += " xc=" + xc;
           x += " formula=" + mformula;
           x += " charge=" + charge.toString();
           x += " mult=" + mult.toString();
           x += " machinejob:expert" 
           x += "\" \n\n";
           x += "echo\n\n"
           x += "start " + jobname + "\n\n";
           x += "memory 1900 mb\n\n"
           x += "charge " + charge.toString() + "\n\n";
           if ((theory=="pspw") || (theory=="paw") || (theory=="band")) {
              data = x + fdata + "\n\n";
           } else {
              data = x + data + "\n\n";
           }

           // Add theory
           x = "";
           if ((theory=="pspw") || (theory=="pspw4") || (theory=="paw") || (theory=="paw4") || (theory=="band")) {
              x = "nwpw\n";
              if (!geomlattice) {
                 x += "   simulation_cell\n"
                 x += "      lattice_vectors\n";
                 x += "        " + a1[0].toFixed(6) + " " + a1[1].toFixed(6) + " " + a1[2].toFixed(6) + "\n";
                 x += "        " + a2[0].toFixed(6) + " " + a2[1].toFixed(6) + " " + a2[2].toFixed(6) + "\n";
                 x += "        " + a3[0].toFixed(6) + " " + a3[1].toFixed(6) + " " + a3[2].toFixed(6) + "\n";
                 x += "   end\n\n";

              }
              if ((theory=="paw")||(theory=="paw4")) {
                 x += "pseudopotentials\n";
                 x += " *  library paw_default\n";
                 x += "end\n";
              }
              if (basis=="default") {
                 x += "  cutoff 50.0\n";
              }
              else {
                 x += "  cutoff " + basis + "\n";
              }
              x += "  mult " + mult.toString() + "\n";
              if (xc=="lda")    {x += "  xc vosko";}
              if (xc=="pbe")    {x += "  xc pbe96";}
              if (xc=="blyp")   {x += "  xc blyp";}
              if (xc=="b3lyp")  {x += "  xc b3lyp";}
              if (xc=="pbe0")   {x += "  xc pbe0";}
              if (xc=="m06-2x") {x += "  xc m06-2x";}
              x += "\n";
              x += "  lmbfgs\n\n";
              x += gen_spin_penalty("atomlist1","penalty1a","penalty1b","penalty1c");
              x += gen_spin_penalty("atomlist2","penalty2a","penalty2b","penalty2c");
              x += gen_spin_penalty("atomlist3","penalty3a","penalty3b","penalty3c");
              x += gen_spin_penalty("atomlist4","penalty4a","penalty4b","penalty4c");
              if ((theory=="band")) {
                 var monkhorststr = prompt("Please Enter Monk-Horst pack gridding:", "1 1 1");
                 x += "  monkhorst-pack " + monkhorststr + "\n";
              }
              x += "end\n\n";

              if ((theory=="pspw4")||(theory=="paw4")) {
                 x += "nwpw\n";
                 x += "  simulation_cell\n";
                 //x += "    fcc 38.0\n";
                 x += "    boundary_conditions aperiodic\n";
                 x += "  end\n";
                 x += "end\n"; 
              }
              x += "set nwpw:cif_filename " + mformula + "\n\n";

              data += x;
      
           } else if (theory=="dft") {

              x = makegaussianbasis(basis,basisHZ,katom);

              x += "dft\n";
              x += "  direct\n";
              x += "  noio\n"; 
              x += "  grid nodisk\n";
              x += "  mult " + mult.toString() + "\n";
              if (xc.includes("pbe0")) { 
                 x += "  xc pbe";
              } else if (xc.includes("pbe")) {
                 x += "  xc xpbe96 cpbe96";
              }
              if (xc.includes("blyp"))   {x += "  xc becke88 lyp";}
              if (xc.includes("b3lyp"))  {x += "  xc b3lyp";}
              if (xc.includes("m06-2x")) {x += "  xc m06-2x";}
              x += "\n";
              if (xc.includes("coarse")) {x += "  grid coarse";}
              if (xc.includes("fine"))   {x += "  grid fine";}
              if (xc.includes("xfine"))  {x += "  grid xfine";}
              x += "\n";
              x += "  iterations 5001\n";
              x += "end\n";

              data += x;

           } else if ((theory=="hf") || (theory=="uhf")) {
              x  = makegaussianbasis(basis,basisHZ,katom);
              if (mult==1) { 
                 x += "scf\n";
                 if (theory=='uhf') {x += "   uhf\n";}
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult==2) { 
                 x += "scf\n";
                 if (theory=='uhf') {x += "   uhf\n";}
                 x += "   doublet\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult==3) { 
                 x += "scf\n";
                 if (theory=='uhf') {x += "   uhf\n";}
                 x += "   triplet\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult==4) { 
                 x += "scf\n";
                 if (theory=='uhf') {x += "   uhf\n";}
                 x += "   quartet\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult==5) { 
                 x += "scf\n";
                 if (theory=='uhf') {x += "   uhf\n";}
                 x += "   quintet\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }

              data += x;

           } else if (theory=="mp2") {
              x  = makegaussianbasis(basis,basisHZ,katom);
              if (mult==1) { 
                 x += "scf\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult==2) { 
                 x += "scf\n";
                 x += "   uhf\n";
                 x += "   doublet\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult==3) { 
                 x += "scf\n";
                 x += "   uhf\n";
                 x += "   triplet\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult==4) { 
                 x += "scf\n";
                 x += "   uhf\n";
                 x += "   quartet\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult==5) { 
                 x += "scf\n";
                 x += "   uhf\n";
                 x += "   quintet\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              x += "mp2\n"; 
              x += "   freeze atomic\n"; 
              x += "end\n";
              x += "set cphf:maxiter 1500\n";

              data += x;

           } else if (theory=="ccsd(t)") {
              x  = makegaussianbasis(basis,basisHZ,katom);
              if (mult==1) {
                 x += "scf\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult==2) {
                 x += "scf\n";
                 x += "   rohf\n";
                 x += "   doublet\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult==3) {
                 x += "scf\n";
                 x += "   rohf\n";
                 x += "   triplet\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult==4) {
                 x += "scf\n";
                 x += "   rohf\n";
                 x += "   quartet\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult==5) {
                 x += "scf\n";
                 x += "   rohf\n";
                 x += "   quintet\n";
                 x += "   maxiter 501\n";
                 x += "end\n";
              }
              if (mult>1) { 
                 x += "tce\n";
                 x += "   freeze atomic\n"; 
                 x += "   ccsd(t)\n"; 
                 x += "   io ga\n"; 
                 x += "   2eorb\n"; 
                 x += "   2emet 13\n"; 
                 x += "   tilesize 20\n"; 
                 x += "end\n";
              } else {
                 x += "ccsd\n"; 
                 x += "   freeze atomic\n";
                 x += "   maxiter 51\n";
                 x += "end\n";
              } 

              data += x;
           }

           // define cosmo radii
           var radii=[];
           var j,xx,yy,zz,r,dsigma;
           for (i=0; i<symbols.length; i++) {radii.push(0.0); }
           for (i=0; i<symbols.length; i++) {
              if (symbols[i]=='H') {radii[i] = 1.172; } 
              else if (symbols[i]=='N') {radii[i] = 2.126;}
              else if (symbols[i]=='O') {radii[i] = 1.576;}
              else if (symbols[i]=='F') {radii[i] = 1.28;}
              else if (symbols[i]=='P') {radii[i] = 2.279;}
              else if (symbols[i]=='S') {radii[i] = 2.023;}
              else if (symbols[i]=='Cl'){radii[i] = 1.75;}
              else if (symbols[i]=='Al'){radii[i] = 1.404;}
              else if (symbols[i]=='Si'){radii[i] = 2.457;}
              else if (symbols[i]=='Br'){radii[i] = 2.16;}
              else if (symbols[i]=='I') {radii[i] = 2.32;}
              else if (symbols[i]=='C') { 
                dsigma = true;
                for (j=0; j<symbols.length; j++) {
                   if ((symbols[j]=='C') && (j!=i)) {
                     xx=xyz[3*i]-xyz[3*j]; yy=xyz[3*i+1]-xyz[3*j+1]; zz=xyz[3*i+2]-xyz[3*j+2];
                     r = Math.sqrt(xx*xx + yy*yy + zz*zz);
                     if (r<=1.46) {dsigma = false;}
                   }
                }
                if (dsigma) {
                   radii[i] = 2.096;
                } else {
                   radii[i] = 1.635;
                }
              } else {
                radii[i] = 2.223;
              }
           }


           // Add tasks
           var svnt,nup,ndn;
           var ncharge = symbols_ncharge(symbols,charge);
           var tasks = calculation_type.split("");
           if ((theory=="pspw4") || (theory=="paw") || (theory=="paw4")) {theory="pspw";}
           x = "";
           for (i=0; i<tasks.length; i++) {
              if (tasks[i]=="e") {x += "task "+ theory + " energy ignore\n";}
              if (tasks[i]=="g") {x += "task "+ theory + " gradient\n";}
              if (tasks[i]=="o") {
                 x += "\ndriver; default; maxiter 50; clear; end\n";
                 x += "task "+ theory + " optimize ignore\n";
              }
              if (tasks[i]=="v") {x += "task "+ theory + " freq numerical\n";}
              if (tasks[i]=="w") {x += "task "+ theory + " freq\n";}
              if (tasks[i]=="a") {
                 x += makegeom_neb((theory=="pspw") || (theory=="paw") || (theory=="band"));
                 x += "neb\n";
                 x += "   impose\n";
                 x += "   algorithm 0\n";
                 x += "   maxiter 10\n";
                 x += "   nbeads 10\n";
                 x += "   stepsize 1.0\n";
                 x += "   kbeads 0.001\n";
                 x += "end\n";
                 x += "task " + theory + " neb ignore\n";
              }

              if (tasks[i]=="c") { 
                 if (solvation_type.includes("COSMO-SMD")) { 
                    if (solvation_type.includes(":")) { 
                       svnt = solvation_type.split(":")[1];
                    } else {
                       svnt = "h2o";
                    }
                    x += "cosmo\n"
                    x += "   do_cosmo_smd .true.\n";
                    x += "   solvent " + svnt + "\n";
                    x += "\nend\n"
                    x += "task " + theory + " energy ignore\n";
                 } else if (solvation_type=='COSMO') { 
                    x += "unset dft:converged\n";
                    x += "unset scf:converged\n";
                    x += "cosmo\n";
                    x += "   do_gasphase .true.\n";
                    x += "   rsolv  0.0\n";
                    x += "   ifscrn 2\n";
                    x += "   minbem 3\n";
                    x += "   maxbem 3\n";
                    x += "   radius ";
                    for (j=0; j<radii.length; j++) {
                      x +=  radii[j].toString() + " ";
                    }
                    x += "\nend\n";
                    x += "task " + theory + " energy ignore\n";
                 }
              }
              if (tasks[i]=="b") { 
                 if ((theory=="pspw") && (mult==1)) {
                    x += "\n\n### Generating HOMO and LUMO Gaussian cube files ###\n";
                    x += "nwpw\n";
                    x += "   virtual 8\n";
                    x += "   dplot\n";
                    x += "      orbital 1 homo-restricted.cube\n";
                    x += "      density total density.cube\n";
                    x += "   end\n";
                    x += "end\n";
                    x += "task pspw energy ignore\n";
                    x += "task pspw pspw_dplot\n\n";
                    x +=  "nwpw\n";
                    x += "   dplot\n";
                    x += "      vectors " + jobname + ".emovecs\n";
                    x += "      orbital 1 lumo-restricted.cube\n";
                    x += "   end\n";
                    x += "end\n";
                    x += "task pspw pspw_dplot\n\n";
                 }
                 if ((theory=="pspw") && (mult>1)) {
                    ndn = (ncharge-mult+1)/2;
                    nup = ndn + mult - 1;
                    x += "\n\n### Generating HOMO and LUMO Gaussian cube files ###\n";
                    x +=  "nwpw\n";
                    x += "   virtual 8\n";
                    x += "   dplot\n";
                    x += "      orbital 1         homo-alpha.cube\n";
                    if (ndn>0) {
                       x += "      orbital 123456789 homo-beta.cube\n";
                    } else {
                       x += "      orbital 1 homo-beta.cube\n";
                    }
                    x += "      density total density.cube\n";
                    x += "   end\n";
                    x += "end\n";
                    x += "task pspw energy ignore\n";
                    x += "task pspw pspw_dplot\n\n";
                    x +=  "nwpw\n";
                    x += "   dplot\n";
                    x += "      vectors " + jobname + ".emovecs\n";
                    x += "      orbital 1 lumo-alpha.cube\n";
                    x += "      orbital 123456789 lumo-beta.cube\n";
                    x += "   end\n";
                    x += "end\n";
                    x += "task pspw pspw_dplot\n\n";
                 }
                 if (((theory=="dft")||(theory=="hf")) && (mult==1)) {
                    nup = ncharge/2;
                    ndn = nup+1;
                    x += "\n\n### Generating HOMO and LUMO Gaussian cube files ###\n";
                    x += "dplot\n";
                    x += "   TITLE HOMO_Orbital\n";
                    x += "   vectors " + jobname + ".movecs\n" 
                    x += "   LimitXYZ\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   spin total\n";
                    x += "   orbitals view\n";
                    x += "   1\n";
                    x += "  " +  nup.toString() + "\n";
                    x += "   gaussian\n";
                    x += "   output homo-restricted.cube\n";
                    x += "end\n";
                    x += "task dplot\n";
                    x += "dplot\n";
                    x += "   TITLE LUMO_Orbital\n";
                    x += "   vectors " + jobname + ".movecs\n" 
                    x += "   LimitXYZ\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   spin total\n";
                    x += "   orbitals view\n";
                    x += "   1\n";
                    x += "   " + ndn.toString() + "\n";
                    x += "   gaussian\n";
                    x += "   output lumo-restricted.cube\n";
                    x += "end\n";
                    x += "task dplot\n";
                 }
                 if (((theory=="dft")||(theory=="hf")) && (mult>1)) {
                    ndn = (ncharge-mult+1)/2;
                    nup = ndn + mult - 1;
                    var nup1 = nup + 1;
                    var ndn1 = ndn + 1;
                    x += "\n\n### Generating HOMO and LUMO Gaussian cube files ###\n";
                    x += "dplot\n";
                    x += "   TITLE HOMO_Alpha_Orbital\n";
                    x += "   vectors " + jobname + ".movecs\n" ;
                    x += "   LimitXYZ\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   spin alpha\n";
                    x += "   orbitals view\n";
                    x += "   1\n";
                    x += "   " + nup.toString() + "\n";
                    x += "   gaussian\n";
                    x += "   output homo-alpha.cube\n";
                    x += "end\n";
                    x += "task dplot\n";
                    x += "dplot\n";
                    x += "   TITLE LUMO_Alpha_Orbital\n";
                    x += "   vectors " + jobname + ".movecs\n" ;
                    x += "   LimitXYZ\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   spin alpha\n";
                    x += "   orbitals view\n";
                    x += "   1\n";
                    x += "   " + nup1.toString() + "\n";
                    x += "   gaussian\n";
                    x += "   output lumo-alpha.cube\n";
                    x += "end\n";
                    x += "task dplot\n";
                    x += "dplot\n";
                    x += "   TITLE HOMO_Beta_Orbital\n";
                    x += "   vectors " + jobname + ".movecs\n";
                    x += "   LimitXYZ\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   spin beta\n";
                    x += "   orbitals view\n";
                    x += "   1\n";
                    if (ndn>0) {
                       x += "   " + ndn.toString() + "\n";
                    } else {
                       x += "   " + ndn1.toString() + "\n";
                    }
                    x += "   gaussian\n";
                    x += "   output homo-beta.cube\n";
                    x += "end\n";
                    x += "task dplot\n";
                    x += "dplot\n";
                    x += "   TITLE LUMO_Beta_Orbital\n";
                    x += "   vectors " + jobname + ".movecs\n";
                    x += "   LimitXYZ\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   -15.0 15.0 96\n";
                    x += "   spin beta\n";
                    x += "   orbitals view\n";
                    x += "   1\n";
                    x += "   " + ndn1.toString() + "\n";
                    x += "   gaussian\n";
                    x += "   output lumo-beta.cube\n";
                    x += "end\n";
                    x += "task dplot\n";
                 }

              }
           }
           data += x;

           if (iscif) {
              for (i=0; i<symbols.length; ++i) {
                 x = parseFloat(xyz[3*i]);
                 y = parseFloat(xyz[3*i+1]);
                 z = parseFloat(xyz[3*i+2]);
                 if (reading==2) {
                    var xx = x*a1[0] + y*a2[0] + z*a3[0];
                    var yy = x*a1[1] + y*a2[1] + z*a3[1];
                    var zz = x*a1[2] + y*a2[2] + z*a3[2];
                    x = xx;
                    y = zz;
                    z = zz;
                 } 
                 var f1 = x*b1[0] + y*b1[1] + z*b1[2];
                 var f2 = x*b2[0] + y*b2[1] + z*b2[2];
                 var f3 = x*b3[0] + y*b3[1] + z*b3[2];
                 cifdata += symbols[i] + " " + f1.toFixed(6) + " " + f2.toFixed(6) + " " + f3.toFixed(6) + "\n";
              }
              editor.setValue(cifdata);
           } else {
              editor.setValue(data);
           }

        }


	function clearSmiles() {
                document.form.smi.value = ""
	}

        function clearSmiles2() {
                document.form2.smi.value = ""
        }

        function emailSmiles() {
                var email=('arrows@emsl.pnnl.gov');
                var subject = (document.form.smi.value);
                var subjectEncoded = encodeURIComponent(subject);
                var body = ('I am the body of the feedback that you are sending.');
                var link = 'mailto:'+email+'?subject='+subjectEncoded;
                window.location.href = link;
                //document.write( '<a href="mailto:' + email +
                //                '?subject=' +subject+
                //                '">' + 'Click here to send email to arrows' + '<' + '/a>');
        }

	function getJMEstring() {
		var data = document.JME.jmeFile();
		document.getElementById("jme_output").value = data;
	}


        function entermult() {
           var rr;
           var mult0 = mult_arrowsdata();
           var mult = prompt("Please enter multiplicity:", mult0);
           if (document.form.smi.value.includes("mult{")) {
              rr = document.form.smi.value.split("mult{")[1].split("}")[0];
              rr = "mult{" + rr + "}";
              document.form.smi.value = document.form.smi.value.replace(rr,"");
           }
           document.form.smi.value += " mult{"+mult+"}";
        }
        function entercharge() {
           var rr;
           var charge0 = charge_arrowsdata();
           var charge = prompt("Please enter charge:", charge0);
           if (document.form.smi.value.includes("^{")) {
              rr = document.form.smi.value.split("^{")[1].split("}")[0];
              rr = "^{" + rr + "}";
              document.form.smi.value = document.form.smi.value.replace(rr,"");
           }
           document.form.smi.value += " ^{"+charge+"}";
        }


        function sleep(milliseconds) {
            var start = new Date().getTime();
            for (var i = 0; i < 1e7; i++) {
               if ((new Date().getTime() - start) > milliseconds){
                  break;
               }
            }
        }

        function Confirm(form){
            //alert("Record insert successfully!");
            //var mytext = "Your Arrows job for " + document.form.smi.value + " is running. Please be patient for it to finish.";
            var mytext = "Your Arrows job is running in a new tab. Please be patient for it to finish.";
            document.getElementById('runmebanner').innerHTML=mytext;
            document.getElementById('runmebanner2').innerHTML=mytext;

            //var node = document.getElementById('runmebanner');
            //while (node.firstChild) node.removeChild( node.firstChild);
            //node.appendChild(document.createTextNode(mytext)); 
            sleep(250);
            form.submit();
        }


        function txspressed(button0,num) {
           if (num==1) {
              var mystr = document.form.smi.value;
           } else {
              var mystr = document.form2.smi.value;
           }
           
           var headstr   = "";
           var tailstr   = "";
           var theorystr = "";
           var xcstr     = "";
           var solvstr   = "";
           var basisstr  = "";
           var monkhorststr = "";

           if (mystr.includes("theory{") || mystr.includes("xc{") || mystr.includes("solvation_type{") || mystr.includes("basis{")) {
              ss = mystr.trim().split(" ");
              sslen = ss.length;
              for (var i=0; i<sslen; ++i) {
                 if (ss[i].includes("theory{") || ss[i].includes("xc{") || ss[i].includes("solvation_type{") || ss[i].includes("basis{")) {
                    tailstr += ss[i] + " "
                 } 
                 else {
                    headstr += ss[i] + " "
                 }
              }
              headstr = headstr.trim();
              tailstr = tailstr.trim();
           }
           else {
              headstr = mystr.trim();
           }

           if (tailstr.includes("theory{")) {
              theorystr = tailstr.split("theory{")[1].split("}")[0].trim();
           }

           if (tailstr.includes("xc{")) {
              xcstr = tailstr.split("xc{")[1].split("}")[0].trim();
           }

           if (tailstr.includes("solvation_type{")) {
              solvstr = tailstr.split("solvation_type{")[1].split("}")[0].trim();
           }

           if (tailstr.includes("basis{")) {
               basisstr = tailstr.split("basis{")[1].split("}")[0].trim();
           }

           if (button0=="band")    { 
               theorystr = "band"; 
               monkhorststr = prompt("Please Enter Monk-Horst pack gridding:", "1 1 1");
           }
           if (button0=="pspw")    { theorystr = "pspw"; }
           if (button0=="pspw4")   { theorystr = "pspw4"; }
           if (button0=="dft")     { theorystr = "dft"; }
           if (button0=="mp2")     { theorystr = "mp2"; }
           if (button0=="ccsd(t)") { theorystr = "ccsd(t)"; }
           if (button0=="pm3")     { theorystr = "pm3"; }

           if (button0=="6-31G*")          { basisstr = "6-31G*"; }
           if (button0=="6-311++G(2d,2p)") { basisstr = "6-311++G(2d,2p)"; }

           if (button0=="lda")    { xcstr = "lda"; }
           if (button0=="pbe")    { xcstr = "pbe"; }
           if (button0=="pbe0")   { xcstr = "pbe0"; }
           if (button0=="blyp")   { xcstr = "blyp"; }
           if (button0=="b3lyp")  { xcstr = "b3lyp"; }
           if (button0=="m06-2x") { xcstr = "m06-2x"; }

           if (button0=="COSMO")     { solvstr = "COSMO"; }
           if (button0=="COSMO-SMD") { 
              if (num==1) {
                 solvstr = document.getElementById("COSMO-SMD").value.split("{")[1].split("}")[0]; 
              } else {
                 solvstr = document.getElementById("COSMO-SMD_2").value.split("{")[1].split("}")[0]; 
              }
           }
           if (button0=="None")      { solvstr = "None"; }

           // remove conflicting options
           if ((theorystr=="mp2") || (theorystr=="ccsd(t)"))  { xcstr = ""; }
           if (((theorystr=="band")||(theorystr=="pspw") || (theorystr=="pspw4")) && (xcstr=="m06-2x")) { xcstr = ""; }
           if (((theorystr=="band")||(theorystr=="pspw") || (theorystr=="pspw4")) && (solvstr=="COSMO")) { solvstr = ""; }
           if (((theorystr=="band")||(theorystr=="pspw") || (theorystr=="pspw4")) && (solvstr.includes("COSMO-SMD"))) { solvstr = ""; }
           if (((theorystr=="band")||(theorystr=="pspw") || (theorystr=="pspw4")) && (basisstr=="6-31G*")) { basisstr = ""; }
           if (((theorystr=="band")||(theorystr=="pspw") || (theorystr=="pspw4")) && (basisstr=="6-311++G(2d,2p)")) { basisstr = ""; }
           if (theorystr=="pm3") { 
              xcstr = ""; 
              basisstr = ""; 
              if (solvstr.includes("COSMO-SMD")) { solvstr="";}
           }

           // set the button colors
           var color1="background-color:#f8f8ff; color:#298DB4;";
           var color2="background-color:#f8f8ff; color:#74A52B;";
           if (theorystr=="dft") {
               document.getElementById("lda").style     = color1;
               document.getElementById("pbe").style     = color1;
               document.getElementById("pbe0").style    = color1;
               document.getElementById("blyp").style    = color1;
               document.getElementById("b3lyp").style   = color1;
               document.getElementById("m06-2x").style  = color1;
               document.getElementById("COSMO").style     = color1;
               document.getElementById("COSMO-SMD").style = color1;
               document.getElementById("None").style      = color1;
               document.getElementById("6-31G*").style          = color1;
               document.getElementById("6-311++G(2d,2p)").style = color1;
           } else if ((theorystr=="band")||(theorystr=="pspw")||(theorystr=="pspw4")) {
               document.getElementById("lda").style     = color1;
               document.getElementById("pbe").style     = color1;
               document.getElementById("pbe0").style    = color1;
               document.getElementById("blyp").style   = color1;
               document.getElementById("b3lyp").style   = color1;
               document.getElementById("m06-2x").style  = color2;
               document.getElementById("COSMO").style     = color2;
               document.getElementById("COSMO-SMD").style = color2;
               document.getElementById("None").style      = color1;
               document.getElementById("6-31G*").style          = color2;
               document.getElementById("6-311++G(2d,2p)").style = color2;
           } else if ((theorystr=="mp2")||(theorystr=="ccsd(t)")) {
               document.getElementById("lda").style     = color2;
               document.getElementById("pbe").style     = color2;
               document.getElementById("pbe0").style    = color2;
               document.getElementById("blyp").style   = color2;
               document.getElementById("b3lyp").style   = color2;
               document.getElementById("m06-2x").style  = color2;
               document.getElementById("COSMO").style     = color1;
               document.getElementById("COSMO-SMD").style = color1;
               document.getElementById("None").style      = color1;
               document.getElementById("6-31G*").style          = color1;
               document.getElementById("6-311++G(2d,2p)").style = color1;
           } else if (theorystr=="pm3") {
               document.getElementById("lda").style     = color2;
               document.getElementById("pbe").style     = color2;
               document.getElementById("pbe0").style    = color2;
               document.getElementById("blyp").style   = color2;
               document.getElementById("b3lyp").style   = color2;
               document.getElementById("m06-2x").style  = color2;
               document.getElementById("COSMO").style     = color1;
               document.getElementById("COSMO-SMD").style = color2;
               //document.getElementById("None").style      = color2;
               document.getElementById("6-31G*").style          = color2;
               document.getElementById("6-311++G(2d,2p)").style = color2;
           }

           // set the esmiles string
           if (num==1) {
              document.form.smi.value  = headstr;
              //if ((theorystr!="") || (xcstr!="") || (solvstr!="")) {document.form.smi.value += " ~ "; }
              if ((headstr.includes("-->") || headstr.includes("==>"))  && (!headstr.includes("~"))) {document.form.smi.value += " ~ "; }
              if (theorystr!="") {document.form.smi.value += " theory{" + theorystr + "}"; }
              if (xcstr!="")     {document.form.smi.value += " xc{" + xcstr + "}"; }
              if (solvstr!="")   {document.form.smi.value += " solvation_type{" + solvstr + "}"; }
              if (basisstr!="")  {document.form.smi.value += " basis{" + basisstr + "}"; }
              if (monkhorststr!="")  {document.form.smi.value += " monkhorst_pack{" + monkhorststr + "}"; }
           } else {
              document.form2.smi.value  = headstr;
              //if ((theorystr!="") || (xcstr!="") || (solvstr!="")) {document.form2.smi.value += " ~ "; }
              if ((headstr.includes("-->") || headstr.includes("==>"))  && (!headstr.includes("~"))) {document.form2.smi.value += " ~ "; }
              if (theorystr!="") {document.form2.smi.value += " theory{" + theorystr + "}"; }
              if (xcstr!="")     {document.form2.smi.value += " xc{" + xcstr + "}"; }
              if (solvstr!="")   {document.form2.smi.value += " solvation_type{" + solvstr + "}"; }
              if (basisstr!="")  {document.form2.smi.value += " basis{" + basisstr + "}"; }
              if (monkhorststr!="")  {document.form2.smi.value += " monkhorst_pack{" + monkhorststr + "}"; }
           }

        }




        // ****************************
        // *                          *
        // *     changebandpspw       *
        // *                          *
        // ****************************
        function changebandpspw() {
           var ispspw  = document.getElementById("bandpspw").value == "PSPW calculation";
           var isband  = document.getElementById("bandpspw").value == "BAND calculation";
           var isdft   = document.getElementById("bandpspw").value == "DFT calculation";
           if (ispspw) {
              document.getElementById("bandpspw").value = "BAND calculation";
           } else if (isband) {
              document.getElementById("bandpspw").value = "DFT calculation";
           } else if (isdft) {
              document.getElementById("bandpspw").value = "MP2 calculation";
           } else {
              document.getElementById("bandpspw").value = "PSPW calculation";
           }
        }


        // ********************************
        // *                              *
        // *     changelatticelocation    *
        // *                              *
        // ********************************
        function changelatticelocation() {
           var ispspw = document.getElementById("latticelocation").value == "Lattice in geometry block";
           if (ispspw) {
              document.getElementById("latticelocation").value = "Lattice in NWPW block";
           } else {
              document.getElementById("latticelocation").value = "Lattice in geometry block";
           }
        }


        // ****************************
        // *                          *
        // *        addenergy         *
        // *                          *
        // ****************************
        function addenergy() {
           var data  = editor.getValue(); // or session.getValue
           data += "\n\n";
           data += "### restart here ###\n";
           if (data.contains("pspspin") && (!data.contains("pspspin off"))) {
              data += "nwpw\n   pspspin off\nend\n";
           }

           var pspw = theory_arrowsdata2();
           if (pspw=="band") {
              var monkhorststr = prompt("Please Enter Monk-Horst pack gridding:", "1 1 1");
              data += "nwpw\n";
              data += "  monkhorst-pack " + monkhorststr + "\n";
              data += "end\n";
           }
           data += "task " + pspw + " energy\n";

           editor.setValue(data);
        }

        // ****************************
        // *                          *
        // *      addoptimization     *
        // *                          *
        // ****************************
        function addoptimization(saddle) {
           var data  = editor.getValue(); // or session.getValue
           var maxiter =  parseInt(prompt("Geometry Optimization - Please enter maximum iterations:", 30));

           data += "\n\n";
           data += "### restart here ###\n";
           
           var pspw = theory_arrowsdata2();
           data += "driver\n";
           data += "   clear\n";
           data += "   maxiter " + maxiter.toString() + "\n";
           data += "end\n";
           if (saddle) {
              data += "task " + pspw + " saddle ignore\n";
           } else {
              data += "task " + pspw + " optimize ignore\n";
           }
           
           editor.setValue(data);
        }

        // ****************************
        // *                          *
        // *      addfrequency        *
        // *                          *
        // ****************************
        function addfrequency() {
           var data  = editor.getValue(); // or session.getValue
           data += "\n\n";
           data += "### restart here ###\n";
           var pspw = theory_arrowsdata2();
           data += "task " + pspw + " freq numerical\n"

           editor.setValue(data);
        }

        // ****************************
        // *                          *
        // *         addneb           *
        // *                          *
        // ****************************
        function addneb() {
           var pspw = theory_arrowsdata2();

           var data  = editor.getValue(); // or session.getValue
           data += "\n\n";
           data += "### restart here ###\n";

           var definegeom  = !data.includes("neb_end");
           if (definegeom) {
              var geom2  =  parseInt(prompt("NEB Optimization - Please enter product model number:", 2));
              var xyzcell = window.xyzframes[geom2-1];
              var nsize  = xyzcell[0].split("\n").length;
              var xyz = xyzcell[0].split("\n").slice(2,nsize).join("\n");
              data += "geometry neb_end noautosym noautoz nocenter\n"
              data +=  xyzcell[0].split("\n").slice(2,nsize).join("\n");
              data += "end\n\n"
           }

           var nbeads   =  parseInt(prompt("NEB Optimization - Please enter number of NEB geometry images:", 5));
           var kbeads   =  parseFloat(prompt("NEB Optimization - Please enter number of NEB spring constant:", 0.1));
           var stepsize =  parseFloat(prompt("NEB Optimization - Please enter number of NEB stepsize:", 1.0));
           var maxiter  =  parseInt(prompt("NEB Optimization - Please enter maximum iterations:", 30));
           var nhist    =  parseInt(prompt("NEB Optimization - Please enter number of quasinewton histories:", 5));

           data += "neb\n";
           data += "   impose\n";
           data += "   print_shift 1\n";
           data += "   nhist    " + nhist.toString() + "\n";
           data += "   nbeads   " + nbeads.toString() + "\n";
           data += "   maxiter  " + maxiter.toString() + "\n";
           data += "   stepsize " + stepsize.toFixed(6) + "\n";
           data += "   kbeads   " + kbeads.toFixed(6) + "\n";
           data += "end\n";
           data += "task " + pspw + " neb ignore\n";

           editor.setValue(data);
        }




        // ****************************
        // *                          *
        // *        genexafs          *
        // *                          *
        // ****************************
        function genexafs(tag,feff9,ion_motion) {
           var ion_motion = "tequil.ion_motion";
           var feffdic  = {'K':1, 'L1':2, 'L2':3, 'L3':4};
           var absorber =  editor.getValue().split("geometry")[1].split("\n")[1].trim().split(/[ ,]+/)[0];
           var absorber =  prompt(tag+"EXAFS Input - Please enter absorber atom:", absorber);
           var edge     =  prompt(tag+"EXAFS Input - Please enter absorber edge:", "K");
           var rmax     =  parseFloat(prompt(tag+"EXAFS Input - Please enter absorber rmax (au):", 8.5));
           var e0       =  parseFloat(prompt(tag+"EXAFS Input - Please enter e0:", 0.0));
           var s0       =  parseFloat(prompt(tag+"EXAFS Input - Please enter s0:", 1.0));
           var start    =  parseInt(prompt(tag+"EXAFS Input - Please enter start:", 1));
           var stride   =  parseInt(prompt(tag+"EXAFS Input - Please enter stride:", 25));
           var center = 1;
           var rcut = 6.0;

           var data  = "";
           if (!feff9) {
              var center   =  parseInt(prompt(tag+"EXAFS Input - Please enter cluster center:", center));
              var rcut     =  parseFloat(prompt(tag+"EXAFS Input - Please enter cluster rcut (angstroms):", rcut));
           }

           if (feff9) {
              data += "#submit_exafs -a " + absorber + " -i " + feffdic[edge] + " -e " + e0.toFixed(1);
              data += " -s " + s0.toFixed(1);
              data += " -r " + rmax.toFixed(1);
              data += " -m " + start.toString();
              data += " -n " + stride.toString();
              data += " " + ion_motion + "\n";
           } else {
              var fname = "chi_avg_"+absorber+"_h_"+edge+"_de_"+e0.toFixed(1)+"_s02_"+s0.toFixed(1)+"_rc_"+rmax.toFixed(1)+".dat"
              var fnamer = "chir_avg_"+absorber+"_h_"+edge+"_de_"+e0.toFixed(1)+"_s02_"+s0.toFixed(1)+"_rc_"+rmax.toFixed(1)+".dat"
              data += "\n\n";
              data += "set md_xs:chi_filename " + fname + "\n";
              data += "set md_xs:chi_r_filename " + fnamer + "\n";
              data += "nwpw\n";
              data += "   md_xs\n";
              data += "      absorber " + absorber + "\n";
                 data += "      edge     " + edge + "\n";
              data += "      rmax     " + rmax.toFixed(3) + "\n";
              data += "      e0       " + e0.toFixed(3) + "\n";
              data += "      s0       " + s0.toFixed(3) + "\n";
              data += "      center   " + center.toString() + "\n";
              data += "      rcut     " + rcut.toFixed(3) + "\n";
              data += "      stride   " + stride.toString() + "\n";
              data += "   end\n";
              data += "   cpmd_properties on\n";
              data += "end\n\n";
           }
           return data;
        }




        // ****************************
        // *                          *
        // *        addcpmd           *
        // *                          *
        // ****************************
        function addcpmd(feff9,header) {
           var ispspw = document.getElementById("bandpspw").value == "PSPW calculation";
           var pspw = "pspw";
           if (!ispspw) {pspw="band";}
           
           var temp   =  parseFloat(prompt("CPMD Input - Please enter temperature:", 300.0));
           var fake_mass  =  parseFloat(prompt("CPMD Input - Please enter fake_mass:", 750.0));
           var time_step  =  parseFloat(prompt("CPMD Input - Please enter time_step:", 5.0));
           var iloop      =  parseInt(prompt("CPMD Input - Please enter inner loop:", 10));
           var oloop      =  parseInt(prompt("CPMD Input - Please enter outer loop:", 1000));
           var stime0     =  parseFloat(prompt("CPMD Input - Please enter total simulation time (ps):", 10.0));
           var stime      =  1.0e-12*stime0;
           var itime      = iloop*oloop*time_step*2.41889e-17;
           var nsteps     = parseInt((stime/itime))+1;

           var tequil     =  prompt("CPMD Input - Please enter motion files label:", "tequil");
           var xyz_filename = tequil + ".xyz";
           var emotion_filename = tequil + ".emotion";
           var ion_motion_filename = tequil + ".ion_motion";
           var fei_filename = tequil + ".fei";
           var data  = editor.getValue(); // or session.getValue

           data += "\n\n";
           data += "### restart here ###\n";
           data += header;
           data += "\n#### equilibrating: temperature=" + temp.toFixed(1) + "K over " + stime0.toFixed(2) + " ps ####\n";
           data += "nwpw\n";
           data += "   Car-Parrinello\n";
           if (temp>0.0) {
              data += "      temperature " + temp.toFixed(1) + " start\n";
           }
           data += "      time_step " + time_step.toFixed(1) + "\n";
           data += "      fake_mass " + fake_mass.toFixed(1) + "\n";
           data += "      loop " + iloop.toString() + " " + oloop.toString() + "\n";
           data += "      xyz_filename        " + xyz_filename + "\n";
           data += "      emotion_filename    " + emotion_filename + "\n";
           data += "      ion_motion_filename " + ion_motion_filename + "\n";
           data += "      fei                 " + fei_filename + "\n";
           data += "   end\n";
           data += "end\n";
           for (var i=0; i<nsteps; ++i) {
              data += "task " + pspw + " car-parrinello\n";
              if (i<(nsteps-1)) {
                 data += "\n### restart here ###\n";
                 if (feff9) { data += header; }
              }
           }
           editor.setValue(data);
        }


        // ****************************
        // *                          *
        // *         addexafs         *
        // *                          *
        // ****************************
        function addexafs(iscpmd) {
           var feff9      =  prompt("EXAFS Input - Please feff6 or feff9:", "feff6").includes("feff9");
           var ion_motion = "";
           var nfeff = 1;
           if (feff9) {
              ion_motion =  prompt("EXAFS Input - Please ion_motion filename:", "tequil.ion_motion");
              nfeff      =  parseInt(prompt("EXAFS Input - Please enter number of feff analysis:", 1));
           } 
           var header = "";
           for (var i=1; i<=nfeff; ++i) {
              alert("Now adding feff analysis " + i.toString());
              header += genexafs("Analysis " + i.toString() + ": ",feff9,ion_motion);
           }
           if (iscpmd) {
              addcpmd(feff9,header);
           } else {
              var data = editor.getValue();
              data += header;
              editor.setValue(data);
           }
        }


        // ****************************
        // *                          *
        // *        addannealing      *
        // *                          *
        // ****************************
        function addannealing() {
           var ispspw = document.getElementById("bandpspw").value == "PSPW calculation";
           var pspw = "pspw";
           if (!ispspw) {pspw="band";}

           var temp   =  parseFloat(prompt("Simulated Annealing - Please enter initial (maximum) temperature:", 2500.0));
           var mintemp   =  parseFloat(prompt("Simulated Annealing - Please enter final (minimum) temperature:", 300.0));
           var fake_mass  =  parseFloat(prompt("Simulated Annealing - Please enter fake_mass:", 750.0));
           var time_step  =  parseFloat(prompt("Simulated Annealing - Please enter time_step:", 5.0));
           var iloop      =  parseInt(prompt("Simulated Annealing - Please enter inner loop:", 10));
           var oloop      =  parseInt(prompt("Simulated Annealing - Please enter outer loop:", 1000));
           var itime      = iloop*oloop*time_step*2.41889e-17;
          
           var data  = editor.getValue(); // or session.getValue

           var stime0 = parseFloat(prompt("Simulated Annealing - Please enter cooling simulation time (ps):", 10.0));
           var stime  = 1.0e-12*stime0;
           var nsteps = parseInt((stime/itime))+1;
           var tau    = -(stime/2.41889e-17)/Math.log(mintemp/temp);
           tequil     =  prompt("Simulated Annealing - Please enter annealing motion files label:", "annealing");
           xyz_filename = tequil + ".xyz";
           emotion_filename = tequil + ".emotion";
           ion_motion_filename = tequil + ".ion_motion";
           fei_filename = tequil + ".fei";

           data += "\n\n";
           data += "### restart here ###\n";
           data += "\n#### cooling schedule: intial temperature=" + temp.toFixed(1) + "K, final temperature=" + mintemp.toFixed(1) + "K over " + stime0.toFixed(2) + " ps ####\n";
           data += "nwpw\n";
           data += "   Car-Parrinello\n";
           data += "      SA_decay "+ tau.toFixed(4) + " " + tau.toFixed(4) + "\n";
           if (temp>0.0) {   
              data += "      temperature " + temp.toFixed(1) + " start\n";
           }
           data += "      time_step " + time_step.toFixed(1) + "\n";
           data += "      fake_mass " + fake_mass.toFixed(1) + "\n";
           data += "      loop " + iloop.toString() + " " + oloop.toString() + "\n";
           data += "      xyz_filename        " + xyz_filename + "\n";
           data += "      emotion_filename    " + emotion_filename + "\n";
           data += "      ion_motion_filename " + ion_motion_filename + "\n";
           data += "      fei                 " + fei_filename + "\n";
           data += "   end\n";
           data += "end\n";
           for (var i=0; i<nsteps; ++i) {
              data += "task " + pspw + " car-parrinello\n";
              if (i<(nsteps-1)) {data += "\n### restart here ###\n";}
           }
           data += "\n\n#### unset cooling/heating decays ####\n";
           data += "unset cpmd:sa_decay\n\n";

           editor.setValue(data);
        }



        // **********************************
        // *                                *
        // *        addreactionconstraint   *
        // *                                *
        // **********************************
        function addreactionconstraint() {
           var rtype    = document.getElementById("reaction_type").value;
           var rgamma   = document.getElementById("reaction_gamma").value;
           var rindexes = document.getElementById("reaction_indexes").value;
           var rkappa = 1.0;
           var bondings =  document.getElementById("reaction_bondings").value.split("gamma")[1].trim();
           var data  = editor.getValue(); // or session.getValue
           data += "\n### Adding reaction ###\n";
           data += "# reaction_type    = " +rtype +"\n";
           data += "# reaction_indexes = " +rindexes +"\n";
           data += "# reaction_gamma   = " +rgamma +"\n";

           data += "##### current gamma="+rgamma+" ######\n";
           data += "constraints\n";
           data += "   clear\n";
           data += "   spring bondings " + rkappa.toFixed(1) + " " + rgamma  + " " +  bondings + "\n";
           data += "end\n";

           editor.setValue(data);
        }

        function isPositiveInteger(n) {
            return n >>> 0 === parseFloat(n);
        } 

        function expand_atomlist(atomlist) {
           var atomlist1 = atomlist.trim().split(/[ ,]+/);
           var xyzdat = jmvar("data({1.1},\"xyz\")");
           var xyz = xyzdat.trim().split("\n");
           var nion = xyz.length;
           var symb = []
           var newlist = ''
           var line,i,k,x,nion,line;
           for (i=0; i<nion; ++i) {
              line = xyz[i].trim().split(/[ ,]+/);
              symb.push(line[0]);
           }
           for (k=0; k<atomlist1.length; ++k) {
              x = atomlist1[k];
              if (isPositiveInteger(x)) {
                 newlist += x + " ";
              } else {
                 for (i=0; i<nion; ++i) {
                    if (symb[i]==x) {
                       newlist += (i+1).toString() + " ";
                    }
                 }
              }
           }
           return newlist;
        }



        function set_color_penalty(alist,ctype,pena,penb,penc) {
           var atomlist1 = expand_atomlist(document.getElementById(alist).value).trim().split(/[ ,]+/);
           var color1    = document.getElementById(ctype).value;
           var penalty1a  = document.getElementById(pena).value;
           var penalty1b  = document.getElementById(penb).value;
           var penalty1c  = document.getElementById(penc).value;

           if (penalty1a.contains("polyhedra")) {
              jms("delete $" + alist + "*;");
              set_polyhedra(alist,ctype,pena,penb,penc);
           } else {
              for (var i=0; i<atomlist1.length; ++i) {
                 jms("select atomno="+atomlist1[i]+"; color " +color1 + ";");
              }
           }
        }
        function supercell_atomlist_color_penalty(alist,ctype,pena,penb,penc,nion,n1,n2,n3) {
           var ii,kk,newatomlist1;
           //var atomlist1 = expand_atomlist(document.getElementById(alist).value).trim();
           var atomlist1 = document.getElementById(alist).value.trim();
           if (atomlist1.length>1) {
              atomlist1 = atomlist1.split(/[ ,]+/);
              console.log("atomlist1=",atomlist1.length);
              newatomlist1 = '';
              for (var i=0; i<atomlist1.length; ++i) {
                 if (isPositiveInteger(atomlist1[i])) { 
                    ii = parseInt(atomlist1[i]);
                    for (var j=0; j<(n1*n2*n3); ++j) {
                       kk = ii + j*nion;
                       newatomlist1 += kk.toString() + " ";
                    }
                 } else {
                    newatomlist1 += atomlist1[i] + " ";
                 }
              }
              document.getElementById(alist).value = newatomlist1.trim();
              set_color_penalty(alist,ctype,pena,penb,penc);
           }
        }

        function set_polyhedra(alist,ctype,pena,penb,penc) {
           var atomlist1 = expand_atomlist(document.getElementById(alist).value).trim().split(/[ ,]+/);
           console.log("ATOMlist1=",atomlist1);
           var color1    = document.getElementById(ctype).value;
           var penalty1a  = document.getElementById(pena).value;
           var penalty1b  = document.getElementById(penb).value;
           var penalty1c  = document.getElementById(penc).value;
           var num_neighbors = parseInt(penalty1c);

           var ucell = jmsfetchucell();
           var xyzdat = jmvar("data({1.1},\"xyz\")");
           var xyz = xyzdat.trim().split("\n");
           var nion = xyz.length;
           var symb = []
           var rion = []
           var line,x,y,z,i,j,ii,xcm,ycm,zcm,dist2,dist2b,r2,tstr,it;
           var n,r,i1,i2,i3;
           var tcount = 0;
           for (i=0; i<nion; ++i) {
              line = xyz[i].trim().split(/[ ,]+/);
              x = parseFloat(line[1]);
              y = parseFloat(line[2]);
              z = parseFloat(line[3]);
              symb.push(line[0]);
              rion.push(x);
              rion.push(y);
              rion.push(z);
           }
           
           console.log("atomlist1=",atomlist1);
           console.log("ucell=",ucell);
           console.log("xyzdat=",xyzdat);
           console.log("num_neighbbors=",num_neighbors);
           var istart = -1;
           var iend   =  1;
           var vol = a1a2a3_to_volume(ucell[1],ucell[2],ucell[3]);
           console.log("vol=",vol);
           if (vol<2.0) {
              istart = 0;
              iend   =  0;
           }
           console.log("rion=",rion);

           tstr = "";
           for (i=0; i<atomlist1.length; ++i) {
              j = parseInt(atomlist1[i])-1;
              console.log("i=",i,"  j=",j);
              xcm = rion[3*j];
              ycm = rion[3*j+1];
              zcm = rion[3*j+2];
              console.log("rcm=",xcm,ycm,zcm);
              
              dist2 =[];
              for (ii=0; ii<nion; ++ii) {
                 if ((!symb[ii].includes("H")) && (ii!=i)) {
                    for (i3=istart; i3<=iend; ++i3) {
                    for (i2=istart; i2<=iend; ++i2) {
                    for (i1=istart; i1<=iend; ++i1) {
                       x = rion[3*ii]   + i1*ucell[1][0] + i2*ucell[2][0] + i3*ucell[3][0];
                       y = rion[3*ii+1] + i1*ucell[1][1] + i2*ucell[2][1] + i3*ucell[3][1];
                       z = rion[3*ii+2] + i1*ucell[1][2] + i2*ucell[2][2] + i3*ucell[3][2];
                       r2 = (x-xcm)*(x-xcm) + (y-ycm)*(y-ycm) + (z-zcm)*(z-zcm);
                       r = Math.sqrt(r2);
                       n  = [(x-xcm)/r,(y-ycm)/r,(z-zcm)/r];
                       dist2.push([r2,ii,n,[x,y,z]]);
                    }}}
                 }
              }
              dist2.sort((a,b) => (a[0] > b[0]) ? 1 : -1);
              dist2b = dist2.slice(0,num_neighbors+1);
              console.log("dist2=",dist2);
              console.log("dist2b=",dist2b);
              triangles = generate_triangles(dist2b);

              console.log("triangles=",triangles);

              for (it=0; it<triangles.length; ++it) {
                 tstr += "draw ID " + alist + tcount.toString() + " polygon 3";
                 tstr += " {" + triangles[it][0][0].toString() + " "; 
                 tstr +=        triangles[it][0][1].toString() + " "; 
                 tstr +=        triangles[it][0][2].toString() + "} "; 
                 tstr += " {" + triangles[it][1][0].toString() + " "; 
                 tstr +=        triangles[it][1][1].toString() + " "; 
                 tstr +=        triangles[it][1][2].toString() + "} "; 
                 tstr += " {" + triangles[it][2][0].toString() + " "; 
                 tstr +=        triangles[it][2][1].toString() + " "; 
                 tstr +=        triangles[it][2][2].toString() + "} "; 
                 tstr += "  mesh " + color1 + "; ";
                 tcount += 1;
              }
           }
           if (tstr.length>1) { jms(tstr);}
        }

        function generate_triangles(dist2) {
           var triangles = [];
           var num_neighbors = dist2.length;
           for (var i=0; i<num_neighbors; ++i) {
              for (var j=i+1; j<num_neighbors; ++j) {
                 for (var k=j+1; k<num_neighbors; ++k) {
                    vol = a1a2a3_to_volume(dist2[i][2],dist2[j][2],dist2[k][2]);
                    console.log("i,j,k,vol=",i,j,k,vol);
                    if (vol>0.4) {
                       triangles.push([dist2[i][3],dist2[j][3],dist2[k][3]]);
                    }
                 }
              }
           }
           return triangles;
        }

        function gen_spin_penalty(alist,pena,penb,penc) {
           var atomlist = expand_atomlist(document.getElementById(alist).value).trim();
           var penaltya = document.getElementById(pena).value.trim();
           var penaltyb = document.getElementById(penb).value.trim();
           var penaltyc = document.getElementById(penc).value.trim();
           var x = "";
           if (atomlist.length>0) {
              if (penaltya.includes("up") || penaltya.includes("down")) {
                 x += "   pspspin " + penaltya + " " + penaltyb + " " + penaltyc.toString() + " " + atomlist + "\n";
              }
           }
           return x;
        }



        function set_color_reaction(indx) {
           var colorlist = ['[xF75444]','[xF3C04E]','[xC3F058]','[x6FED62]','[x6BEAAC]','[x74D9E7]'];
           jms("select all; color cpk;");
           for (var i=0; i<indx.length; ++i) {
              jms("select atomno="+indx[i]+"; color translucent cpk;");
           }
        }

        function gen_reactions1() {
           var arrows_post_url = "{{ arrows_api }}upload/";
           var arrows_get_url  = "{{ arrows_api }}genhash/";
           var mol = exMod().replace('{','').replace('}','');
           var reaction_hash0 = document.getElementById("reaction_hash").value;
           var mollist = mol.split("\n");
           mollist[2] = "reaction_hash{" + reaction_hash0 + "}";
           mol =  mollist.join("\n");
           if (reaction_hash0.trim().length>6) {
              var textToSaveAsBlob = new Blob([mol], {type:"text/plain"});
              var textToSaveAsURL  = window.URL.createObjectURL(textToSaveAsBlob);

              var ii = Math.floor(Math.random() * 1000) + 1;
              var filenameguess = "nwchem-" + ii +".mol";
              var fileNameToSaveAs =  filenameguess;

              var formD = new FormData();
              formD.append('file', textToSaveAsBlob,fileNameToSaveAs);
              formD.append('title', fileNameToSaveAs);

              document.getElementById("reaction_hash2").value = "Processing request";
              document.getElementById('runmebanner4').innerHTML= "Processing request";
              set_color_reaction([]);
              var xhr = new XMLHttpRequest();
              xhr.open("POST", arrows_post_url, true);
              xhr.send(formD);
              sleep(2000.0);

              var request = new XMLHttpRequest();
              request.onreadystatechange = function() {
                 if (request.readyState == 4 && request.status == 200) {
                    var textFromUrl = request.responseText;
                    document.getElementById('runmebanner4').innerHTML= "";
                    document.getElementById("reaction_hash2").value = textFromUrl + "\n";
                    document.getElementById("reaction_type").value = textFromUrl.split("\n")[0];
                    var rlist = eval(textFromUrl.split("\n")[1]);
                    if (rlist.length>0) {
                       var irxn = rlist[0][0];
                       var grxn = rlist[0][2];
                       document.getElementById("reaction_gamma").value = grxn.toFixed(6);
                       document.getElementById("reaction_indexes").value = irxn.join(" ");
                       set_color_reaction(irxn);
                       for (var j=0; j<rlist.length; ++j) {
                          document.getElementById("reaction_hash2").value += "reaction "+(j+1)+":   ";
                          document.getElementById("reaction_hash2").value += " reaction_indexes = " + rlist[j][0].join(" ");
                          document.getElementById("reaction_hash2").value += " transition state=" + rlist[j][1].join("-");
                          document.getElementById("reaction_hash2").value += " reaction_gamma=" + rlist[j][2] + "\n";
                       }
                    }
                  }
              };
              request.open('GET', arrows_get_url+fileNameToSaveAs, true);
              request.send();
           } else {
             document.getElementById('runmebanner4').innerHTML= "The reaction_hash is not defined!";
           }
        }



        function check_rgamma() {
           var arrows_post_url = "{{ arrows_api }}upload/";
           var arrows_get_url  = "{{ arrows_api }}genhash/";
           var mol = exMod().replace('{','').replace('}','');
           var reaction_hash0 = document.getElementById("reaction_hash").value;
           var check_indexes  = document.getElementById("reaction_indexes").value.split(" ");
           var mollist = mol.split("\n");
           mollist[2] = "reaction_hash{" + reaction_hash0 + "}";
           mol =  mollist.join("\n");
           if ((reaction_hash0.trim().length>6) && (check_indexes.length>1)) {
              var textToSaveAsBlob = new Blob([mol], {type:"text/plain"});
              var textToSaveAsURL  = window.URL.createObjectURL(textToSaveAsBlob);

              var ii = Math.floor(Math.random() * 1000) + 1;
              var filenameguess = "nwchem-" + ii +".mol";
              var fileNameToSaveAs =  filenameguess;

              var formD = new FormData();
              formD.append('file', textToSaveAsBlob,fileNameToSaveAs);
              formD.append('title', fileNameToSaveAs);

              document.getElementById("reaction_hash2").value = "Processing request";
              document.getElementById('runmebanner4').innerHTML= "Processing request";
              set_color_reaction([]);
              var xhr = new XMLHttpRequest();
              xhr.open("POST", arrows_post_url, true);
              xhr.send(formD);
              sleep(2000.0);

              var request = new XMLHttpRequest();
              request.onreadystatechange = function() {
                 if (request.readyState == 4 && request.status == 200) {
                    var textFromUrl = request.responseText;
                    document.getElementById('runmebanner4').innerHTML= "";
                    document.getElementById("reaction_hash2").value = textFromUrl + "\n";
                    document.getElementById("reaction_type").value = textFromUrl.split("\n")[0];
                    var rlist = eval(textFromUrl.split("\n")[1]);
                    for (var i=0; i<rlist.length; ++i) {
                       var irxn = rlist[i][0];
                       var grxn = rlist[i][2];
                       var same = false;
                       if (irxn.length==check_indexes.length) {
                          same = true;
                          for (var j=0; j<irxn.length; ++j) {
                             if (irxn[j]!=check_indexes[j]) { same = false;}
                          }
                       }
                       if (same) { document.getElementById("reaction_gamma").value = grxn.toFixed(6);}
                       if (same) { set_color_reaction(check_indexes); }
                       if (same) { 
                          document.getElementById("reaction_hash2").value += "reaction "+(i+1)+":   ";
                          document.getElementById("reaction_hash2").value += " reaction_indexes = " + rlist[i][0].join(" ");
                          document.getElementById("reaction_hash2").value += " transition state=" + rlist[i][1].join("-");
                          document.getElementById("reaction_hash2").value += " reaction_gamma=" + rlist[i][2] + "\n";
                       }
                    }
                 }
              };
              request.open('GET', arrows_get_url+fileNameToSaveAs, true);
              request.send();
           } else {
             document.getElementById('runmebanner4').innerHTML= "The reaction_hash and/or reaction_indexes are not defined!";
           }

           gen_bondings();
        }

        function gen_rhash1() {
           var arrows_post_url = "{{ arrows_api }}upload/";
           var arrows_get_url  = "{{ arrows_api }}genhash/";
           var mol = exMod().replace('{','').replace('}','');
           var reaction_type = document.getElementById("reaction_type").value;
           var reaction_indexes = document.getElementById("reaction_indexes").value;
           var mollist = mol.split("\n");
           mollist[2] = "reaction_genhash reaction_type{" + reaction_type + "} reaction_indexes{" + reaction_indexes + "}";
           mol =  mollist.join("\n");
           if ((reaction_type!="None") && (reaction_indexes.trim().length>2)) {
              var textToSaveAsBlob = new Blob([mol], {type:"text/plain"});
              var textToSaveAsURL  = window.URL.createObjectURL(textToSaveAsBlob);

              var ii = Math.floor(Math.random() * 1000) + 1;
              var filenameguess = "nwchem-" + ii +".mol";
              var fileNameToSaveAs =  filenameguess;

              var formD = new FormData();
              formD.append('file', textToSaveAsBlob,fileNameToSaveAs);
              formD.append('title', fileNameToSaveAs);

              document.getElementById("reaction_hash").value = "Processing request";
              set_color_reaction([]);
              var xhr = new XMLHttpRequest();
              xhr.open("POST", arrows_post_url, true);
              xhr.send(formD);
              sleep(2000.0);

              var request = new XMLHttpRequest();
              request.onreadystatechange = function() {
                 if (request.readyState == 4 && request.status == 200) {
                    var textFromUrl = request.responseText;
                    document.getElementById("reaction_hash").value = textFromUrl;
                    check_rgamma();
                  }
              };
              request.open('GET', arrows_get_url+fileNameToSaveAs, true);
              request.send();
           }
        }

        function gen_rhash2() {
           var arrows_post_url0 = "{{ arrows_api }}upload/";
           var arrows_get_url  = "{{ arrows_api }}genhash/";
           var reaction = document.getElementById("reaction_genhash00").value;
           if (reaction.trim().length>5) {
              var mol = "reaction_genhash{"+reaction+"}\n";
              var textToSaveAsBlob = new Blob([mol], {type:"text/plain"});
              var textToSaveAsURL  = window.URL.createObjectURL(textToSaveAsBlob);

              var ii = Math.floor(Math.random() * 1000) + 1;
              var filenameguess = "nwchem-" + ii +".mol";
              var fileNameToSaveAs =  filenameguess;

              //console.log(fileNameToSaveAs);
              //console.log(mol);

              var formD = new FormData();
              formD.append('file', textToSaveAsBlob,fileNameToSaveAs);
              formD.append('title', fileNameToSaveAs);
              //console.log(formD);

              document.getElementById("reaction_hash").value = "Processing request";
              set_color_reaction([]);
              var xhr = new XMLHttpRequest();
              xhr.open("POST", arrows_post_url0, true);
              xhr.send(formD);
              sleep(2000.0);

              var request = new XMLHttpRequest();
              request.onreadystatechange = function() {
                 if (request.readyState == 4 && request.status == 200) {
                    var textFromUrl = request.responseText;
                    document.getElementById("reaction_hash").value = textFromUrl;
                  }
              };
              request.open('GET', arrows_get_url+fileNameToSaveAs, true);
              request.send();

           }
        }

        function gen_bondings() {
           var arrows_post_url = "{{ arrows_api }}upload/";
           var arrows_get_url  = "{{ arrows_api }}genhash/";
           var mol = exMod().replace('{','').replace('}','');
           var reaction_type    = document.getElementById("reaction_type").value;
           var reaction_indexes = document.getElementById("reaction_indexes").value;
           var mollist = mol.split("\n");
           mollist[2] = "generate_bonding reaction_type{" + reaction_type + "} reaction_indexes{" + reaction_indexes + "}";
           mol =  mollist.join("\n");
           if ((reaction_type!="None") && (reaction_indexes.trim().length>2)) {
              var textToSaveAsBlob = new Blob([mol], {type:"text/plain"});
              var textToSaveAsURL  = window.URL.createObjectURL(textToSaveAsBlob);

              var ii = Math.floor(Math.random() * 1000) + 1;
              var filenameguess = "nwchem-" + ii +".mol";
              var fileNameToSaveAs =  filenameguess;

              var formD = new FormData();
              formD.append('file', textToSaveAsBlob,fileNameToSaveAs);
              formD.append('title', fileNameToSaveAs);

              set_color_reaction([]);
              var xhr = new XMLHttpRequest();
              xhr.open("POST", arrows_post_url, true);
              xhr.send(formD);
              sleep(2000.0);

              document.getElementById("reaction_bondings").value = "Processing request";
              var request = new XMLHttpRequest();
              request.onreadystatechange = function() {
                 if (request.readyState == 4 && request.status == 200) {
                    var textFromUrl = request.responseText;
                    document.getElementById("reaction_bondings").value = "spring " + textFromUrl.split("spring")[1];
                  }
              };
              request.open('GET', arrows_get_url+fileNameToSaveAs, true);
              request.send();
           }
        }



</script>

</head>


<body onload="jmolOnLoad();">


<!--div class="linkbanner">
   <a href="https://arrows.emsl.pnnl.gov/api"><img src="https://dl.dropboxusercontent.com/s/s5fof263qwxzcaq/EMSLArrows2019.png" alt="Copyright Arrows Logo" width="180" height="90" align="middle"></a>
<a href="https://arrows.emsl.pnnl.gov/api/periodic">3D Periodic Editor</a> &nbsp;
   <a href="https://arrows.emsl.pnnl.gov/api/3dbuilder">3D Molecular And Reaction Editor</a>  &nbsp; <a href="https://arrows.emsl.pnnl.gov/api/expert">Expert Editor</a> &nbsp;   <a href="https://arrows.emsl.pnnl.gov/api/qsharp_chem">Microsoft Quantum Editor</a> &nbsp;  <a href="https://arrows.emsl.pnnl.gov/api/aerosol">EMSL Aerosol Workshop Editor</a> &nbsp; <a href="https://nwchemgit.github.io/EMSL_Arrows#">Manual</a>
</div-->

<div class="linkbanner">
   <a href="{{ arrows_api }}"><img src="{{url_for('static', filename='arrows-static/TinyArrows2019.png')}}" alt="Copyright Arrows Logo" width="180" height="90" align="middle"></a>
<a href="{{ arrows_api }}periodic">Expert Periodic and Molecular Editor</a> &nbsp;
   <a href="{{ arrows_api }}3dbuilder">3D Molecular And Reaction Editor</a>  &nbsp; <a href="{{ arrows_api }}expert"> Molecular Combo Editor</a> &nbsp;  <a href="{{ arrows_api }}qsharp_chem">Microsoft Quantum Editor</a> &nbsp;  <a href="{{ arrows_api }}aerosol">EMSL Aerosol Workshop Editor</a> &nbsp;  <a href="{{ arrows_api }}ssh_tunnel">SSH Tunneling</a> &nbsp; <a href="https://ebylaska.github.io/TinyArrows/">Manual</a>                                          
</div>


	<!-- RECOMMENDED if your web app will not function without JavaScript enabled -->
    <noscript>
	<div style="width: 22em; position: absolute; left: 50%; margin-left: -11em; color: red; background-color: white; border: 1px solid red; padding: 4px; font-family: sans-serif">
   Your web browser must have JavaScript enabled in order for this
    application to display correctly.</div>
    </noscript>


<!-- Tab links -->
<div class="tab">
  <button class="tablinks" onclick="openCity(event, 'Arrows Periodic 3D Builder')" id="defaultOpen">Arrows Periodic 3D Builder</button>
  <button class="tablinks" onclick="openCity(event, 'NWChem Input Editor')">NWChem Input Editor</button>
  <button class="tablinks" onclick="openCity(event, 'Arrows Entry')">Arrows Entry</button>
  <button class="tablinks" onclick="openCity(event, 'Arrows Entry - 2D Builder')">Arrows Entry - 2D Builder (not periodic)</button>
  <button class="tablinks" onclick="openCity(event, 'SpreadSheet')">SpreadSheet</button>
  <button class="tablinks" onclick="openCity(event, 'Instructions')">Instructions</button>
</div>




<div id="Arrows Entry" class="tabcontent">

    <h2>Enter an <a href="https://nwchemgit.github.io/EMSL_Arrows#introduction-to-esmiles-how-to-change-calculation-theories">esmiles</a>, <a href="https://nwchemgit.github.io/EMSL_Arrows#esmiles-reactions-how-to-calculate-reaction-energies"> esmiles reaction</a>, or other Arrows input, then push the "Run Arrows" button.</h2>


    <form action="." name="form" target="_blank" method="POST">
       <table>
          <tr>
             <!--td> <input type="text" name="smi" SIZE=120> </td-->
             <td> <textarea  name="smi" rows="10" cols="140"></textarea></td>
             <!--td> <input type="submit" name="JSME-arrows" value="Run Arrows" style="font-family: sans-serif; font-size: 20px;"></td-->
             <td> <input type="button" name="JSME-arrows" value="Run Arrows" style="font-family: sans-serif; font-size: 20px;" onClick="Confirm(this.form)"></td>
          </tr>
          <tr>
             <td>
                  <INPUT TYPE="button" VALUE="Append xyzdata{} from JSMol Editor" onClick="appendXYZ2()"> &nbsp;
                  <INPUT TYPE="button" VALUE="Append SMILES from JSMol Editor" onClick="appendSmiles2()"> &nbsp;
                  <input type="button" class="button" name="jmolreactionplane3" id="jmolreactionplane3" 
                          value="Reaction on" onClick="jmreactionplane()"/>
                  <INPUT TYPE="button" VALUE="no html5" 
                          onClick="document.form.smi.value+=' nohtml5'" >
                  <INPUT TYPE="button" VALUE="Clear" onClick="clearSmiles()"> </td>
             <td> <INPUT TYPE="button" VALUE="Email Submit" onClick="emailSmiles()"> </td>
          </tr>
       </table>
    </form>
    <section class="blink" style="color: red"> <b id="runmebanner"> </b> </section>
    <br>
    <FORM METHOD="POST" ONSUBMIT="return false;">
       <INPUT TYPE="button" VALUE="theory{band}" id="dft"
              onClick="txspressed('band',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="theory{pspw}" id="pspw"
              onClick="txspressed('pspw',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="theory{pspw4}" id="pspw4"
              onClick="txspressed('pspw4',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="theory{dft}" id="dft"
              onClick="txspressed('dft',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="theory{mp2}" id="mp2"
              onClick="txspressed('mp2',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="theory{ccsd(t)}" id="ccsd(t)"
              onClick="txspressed('ccsd(t)',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="theory{pm3}" id="pm3"
              onClick="txspressed('pm3',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="basis{6-31G*}" id="6-31G*"
              onClick="txspressed('6-31G*',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="basis{6-311++G(2d,2p)}" id="6-311++G(2d,2p)"
              onClick="txspressed('6-311++G(2d,2p)',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <br>
       <INPUT TYPE="button" VALUE="xc{lda}" id="lda"
              onClick="txspressed('lda',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="xc{pbe}" id="pbe"
              onClick="txspressed('pbe',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="xc{pbe0}" id="pbe0"
              onClick="txspressed('pbe0',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="xc{blyp}" id="blyp"
              onClick="txspressed('blyp',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="xc{b3lyp}" id="b3lyp"
              onClick="txspressed('b3lyp',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="xc{m06-2x}" id="m06-2x"
              onClick="txspressed('m06-2x',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="solvation_type{None}" id="None"
              onClick="txspressed('None',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="solvation_type{COSMO}"  id="COSMO"
              onClick="txspressed('COSMO',1)"
              onClick="document.form.smi.value+=' solvation_type{COSMO}'" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="solvation_type{COSMO-SMD}"  id="COSMO-SMD"
              onClick="txspressed('COSMO-SMD',1)"
              style="background-color:#f8f8ff; color:#298DB4;">
      <select id="SMD_solvent" onChange="document.getElementById('COSMO-SMD').value = document.getElementById('SMD_solvent').value;" >
                 <option value="solvation_type{COSMO-SMD}">water (default)</option>
                 <option value="solvation_type{COSMO-SMD:acetacid}">acetic acid</option>
                 <option value="solvation_type{COSMO-SMD:acetone}">acetone</option>
                 <option value="solvation_type{COSMO-SMD:acetntrl}">acetonitrile</option>
                 <option value="solvation_type{COSMO-SMD:acetphen}">acetophenone</option>
                 <option value="solvation_type{COSMO-SMD:aniline}">aniline</option>
                 <option value="solvation_type{COSMO-SMD:anisole}">anisole</option>
                 <option value="solvation_type{COSMO-SMD:benzaldh}">benzaldehyde</option>
                 <option value="solvation_type{COSMO-SMD:benzene}">benzene</option>
                 <option value="solvation_type{COSMO-SMD:benzntrl}">benzonitrile</option>
                 <option value="solvation_type{COSMO-SMD:benzylcl}">benzyl chloride</option>
                 <option value="solvation_type{COSMO-SMD:brisobut}">1-bromo-2-methylpropane</option>
                 <option value="solvation_type{COSMO-SMD:brbenzen}">bromobenzene</option>
                 <option value="solvation_type{COSMO-SMD:brethane}">bromoethane</option>
                 <option value="solvation_type{COSMO-SMD:bromform}">bromoform</option>
                 <option value="solvation_type{COSMO-SMD:broctane}">1-bromooctane</option>
                 <option value="solvation_type{COSMO-SMD:brpentan}">1-bromopentane</option>
                 <option value="solvation_type{COSMO-SMD:brpropa2}">2-bromopropane</option>
                 <option value="solvation_type{COSMO-SMD:brpropan}">1-bromopropane</option>
                 <option value="solvation_type{COSMO-SMD:butanal}">butanal</option>
                 <option value="solvation_type{COSMO-SMD:butacid}">butanoic acid</option>
                 <option value="solvation_type{COSMO-SMD:butanol}">1-butanol</option>
                 <option value="solvation_type{COSMO-SMD:butanol2}">2-butanol</option>
                 <option value="solvation_type{COSMO-SMD:butanone}">butanone</option>
                 <option value="solvation_type{COSMO-SMD:butantrl}">butanonitrile</option>
                 <option value="solvation_type{COSMO-SMD:butile}">butyl acetate</option>
                 <option value="solvation_type{COSMO-SMD:nba}">butylamine</option>
                 <option value="solvation_type{COSMO-SMD:nbutbenz}">n-butylbenzene</option>
                 <option value="solvation_type{COSMO-SMD:sbutbenz}">sec-butylbenzene</option>
                 <option value="solvation_type{COSMO-SMD:tbutbenz}">tert-butylbenzene</option>
                 <option value="solvation_type{COSMO-SMD:cs2}">carbon disulfide</option>
                 <option value="solvation_type{COSMO-SMD:carbntet}">carbon tetrachloride</option>
                 <option value="solvation_type{COSMO-SMD:clbenzen}">chlorobenzene</option>
                 <option value="solvation_type{COSMO-SMD:secbutcl}">sec-butyl chloride</option>
                 <option value="solvation_type{COSMO-SMD:chcl3}">chloroform</option>
                 <option value="solvation_type{COSMO-SMD:clhexane}">1-chlorohexane</option>
                 <option value="solvation_type{COSMO-SMD:clpentan}">1-chloropentane</option>
                 <option value="solvation_type{COSMO-SMD:clpropan}">1-chloropropane</option>
                 <option value="solvation_type{COSMO-SMD:ocltolue}">o-chlorotoluene</option>
                 <option value="solvation_type{COSMO-SMD:m-cresol}">m-cresol</option>
                 <option value="solvation_type{COSMO-SMD:o-cresol}">o-cresol</option>
                 <option value="solvation_type{COSMO-SMD:cychexan}">cyclohexane</option>
                 <option value="solvation_type{COSMO-SMD:cychexon}">cyclohexanone</option>
                 <option value="solvation_type{COSMO-SMD:cycpentn}">cyclopentane</option>
                 <option value="solvation_type{COSMO-SMD:cycpntol}">cyclopentanol</option>
                 <option value="solvation_type{COSMO-SMD:cycpnton}">cyclopentanone</option>
                 <option value="solvation_type{COSMO-SMD:declncis}">cis-decalin</option>
                 <option value="solvation_type{COSMO-SMD:declntra}">trans-decalin</option>
                 <option value="solvation_type{COSMO-SMD:declnmix}">decalin (cis/trans mixture)</option>
                 <option value="solvation_type{COSMO-SMD:decane}">n-decane</option>
                 <option value="solvation_type{COSMO-SMD:decanol}">1-decanol</option>
                 <option value="solvation_type{COSMO-SMD:edb12}">1,2-dibromoethane</option>
                 <option value="solvation_type{COSMO-SMD:dibrmetn}">dibromomethane</option>
                 <option value="solvation_type{COSMO-SMD:butyleth}">dibutyl ether</option>
                 <option value="solvation_type{COSMO-SMD:odiclbnz}">o-dichlorobenzene</option>
                 <option value="solvation_type{COSMO-SMD:edc12}">1,2-dichloroethane</option>
                 <option value="solvation_type{COSMO-SMD:c12dce}">cis-dichloroethylene</option>
                 <option value="solvation_type{COSMO-SMD:t12dce}">trans-dichloroethylene</option>
                 <option value="solvation_type{COSMO-SMD:dcm}">dichloromethane</option>
                 <option value="solvation_type{COSMO-SMD:ether}">diethyl ether</option>
                 <option value="solvation_type{COSMO-SMD:et2s}">diethyl sulfide</option>
                 <option value="solvation_type{COSMO-SMD:dietamin}">diethylamine</option>
                 <option value="solvation_type{COSMO-SMD:mi}">diiodomethane</option>
                 <option value="solvation_type{COSMO-SMD:dipe}">diisopropyl ether</option>
                 <option value="solvation_type{COSMO-SMD:dmds}">dimethyl disulfide</option>
                 <option value="solvation_type{COSMO-SMD:dmso}">dimethyl sulfoxide</option>
                 <option value="solvation_type{COSMO-SMD:dma}">N,N-dimethylacetamide</option>
                 <option value="solvation_type{COSMO-SMD:cisdmchx}">cis-1,2-dimethylcyclohexane</option>
                 <option value="solvation_type{COSMO-SMD:dmf}">N,N-dimethylformamide</option>
                 <option value="solvation_type{COSMO-SMD:dmepen24}">2,4-dimethylpentane</option>
                 <option value="solvation_type{COSMO-SMD:dmepyr24}">2,4-dimethylpyridine</option>
                 <option value="solvation_type{COSMO-SMD:dmepyr26}">2,6-dimethylpyridine</option>
                 <option value="solvation_type{COSMO-SMD:dioxane}">1,4-dioxane</option>
                 <option value="solvation_type{COSMO-SMD:phoph}">diphenyl ether</option>
                 <option value="solvation_type{COSMO-SMD:dproamin}">dipropylamine</option>
                 <option value="solvation_type{COSMO-SMD:dodecan}">n-dodecane</option>
                 <option value="solvation_type{COSMO-SMD:meg}">1,2-ethanediol</option>
                 <option value="solvation_type{COSMO-SMD:etsh}">ethanethiol</option>
                 <option value="solvation_type{COSMO-SMD:ethanol}">ethanol</option>
                 <option value="solvation_type{COSMO-SMD:etoac}">ethyl acetate</option>
                 <option value="solvation_type{COSMO-SMD:etome}">ethyl formate</option>
                 <option value="solvation_type{COSMO-SMD:eb}">ethylbenzene</option>
                 <option value="solvation_type{COSMO-SMD:phenetol}">ethyl phenyl ether</option>
                 <option value="solvation_type{COSMO-SMD:c6h5f}">fluorobenzene</option>
                 <option value="solvation_type{COSMO-SMD:foctane}">1-fluorooctane</option>
                 <option value="solvation_type{COSMO-SMD:formamid}">formamide</option>
                 <option value="solvation_type{COSMO-SMD:formacid}">formic acid</option>
                 <option value="solvation_type{COSMO-SMD:heptane}">n-heptane</option>
                 <option value="solvation_type{COSMO-SMD:heptanol}">1-heptanol</option>
                 <option value="solvation_type{COSMO-SMD:heptnon2}">2-heptanone</option>
                 <option value="solvation_type{COSMO-SMD:heptnon4}">4-heptanone</option>
                 <option value="solvation_type{COSMO-SMD:hexadecn}">n-hexadecane</option>
                 <option value="solvation_type{COSMO-SMD:hexane}">n-hexane</option>
                 <option value="solvation_type{COSMO-SMD:hexnacid}">hexanoic acid</option>
                 <option value="solvation_type{COSMO-SMD:hexanol}">1-hexanol</option>
                 <option value="solvation_type{COSMO-SMD:hexanon2}">2-hexanone</option>
                 <option value="solvation_type{COSMO-SMD:hexene}">1-hexene</option>
                 <option value="solvation_type{COSMO-SMD:hexyne}">1-hexyne</option>
                 <option value="solvation_type{COSMO-SMD:c6h5i}">iodobenzene</option>
                 <option value="solvation_type{COSMO-SMD:iobutane}">1-iodobutane</option>
                 <option value="solvation_type{COSMO-SMD:c2h5i}">iodoethane</option>
                 <option value="solvation_type{COSMO-SMD:iohexdec}">1-iodohexadecane</option>
                 <option value="solvation_type{COSMO-SMD:ch3i}">iodomethane</option>
                 <option value="solvation_type{COSMO-SMD:iopentan}">1-iodopentane</option>
                 <option value="solvation_type{COSMO-SMD:iopropan}">1-iodopropane</option>
                 <option value="solvation_type{COSMO-SMD:cumene}">isopropylbenzene</option>
                 <option value="solvation_type{COSMO-SMD:p-cymene}">p-isopropyltoluene</option>
                 <option value="solvation_type{COSMO-SMD:mesityln}">mesitylene</option>
                 <option value="solvation_type{COSMO-SMD:methanol}">methanol</option>
                 <option value="solvation_type{COSMO-SMD:egme}">2-methoxyethanol</option>
                 <option value="solvation_type{COSMO-SMD:meacetat}">methyl acetate</option>
                 <option value="solvation_type{COSMO-SMD:mebnzate}">methyl benzoate</option>
                 <option value="solvation_type{COSMO-SMD:mebutate}">methyl butanoate</option>
                 <option value="solvation_type{COSMO-SMD:meformat}">methyl formate</option>
                 <option value="solvation_type{COSMO-SMD:mibk}">4-methyl-2-pentanone</option>
                 <option value="solvation_type{COSMO-SMD:mepropyl}">methyl propanoate</option>
                 <option value="solvation_type{COSMO-SMD:isobutol}">2-methyl-1-propanol</option>
                 <option value="solvation_type{COSMO-SMD:terbutol}">2-methyl-2-propanol</option>
                 <option value="solvation_type{COSMO-SMD:nmeaniln}">N-methylaniline</option>
                 <option value="solvation_type{COSMO-SMD:mecychex}">methylcyclohexane</option>
                 <option value="solvation_type{COSMO-SMD:nmfmixtr}">N-methylformamide (E/Z mixture)</option>
                 <option value="solvation_type{COSMO-SMD:isohexan}">2-methylpentane</option>
                 <option value="solvation_type{COSMO-SMD:mepyrid2}">2-methylpyridine</option>
                 <option value="solvation_type{COSMO-SMD:mepyrid3}">3-methylpyridine</option>
                 <option value="solvation_type{COSMO-SMD:mepyrid4}">4-methylpyridine</option>
                 <option value="solvation_type{COSMO-SMD:c6h5no2}">nitrobenzene</option>
                 <option value="solvation_type{COSMO-SMD:c2h5no2}">nitroethane</option>
                 <option value="solvation_type{COSMO-SMD:ch3no2}">nitromethane</option>
                 <option value="solvation_type{COSMO-SMD:ntrprop1}">1-nitropropane</option>
                 <option value="solvation_type{COSMO-SMD:ntrprop2}">2-nitropropane</option>
                 <option value="solvation_type{COSMO-SMD:ontrtolu}">o-nitrotoluene</option>
                 <option value="solvation_type{COSMO-SMD:nonane}">n-nonane</option>
                 <option value="solvation_type{COSMO-SMD:nonanol}">1-nonanol</option>
                 <option value="solvation_type{COSMO-SMD:nonanone}">5-nonanone</option>
                 <option value="solvation_type{COSMO-SMD:octane}">n-octane</option>
                 <option value="solvation_type{COSMO-SMD:octanol}">1-octanol</option>
                 <option value="solvation_type{COSMO-SMD:octanon2}">2-octanone</option>
                 <option value="solvation_type{COSMO-SMD:pentdecn}">n-pentadecane</option>
                 <option value="solvation_type{COSMO-SMD:pentanal}">pentanal</option>
                 <option value="solvation_type{COSMO-SMD:npentane}">n-pentane</option>
                 <option value="solvation_type{COSMO-SMD:pentacid}">pentanoic acid</option>
                 <option value="solvation_type{COSMO-SMD:pentanol}">1-pentanol</option>
                 <option value="solvation_type{COSMO-SMD:pentnon2}">2-pentanone</option>
                 <option value="solvation_type{COSMO-SMD:pentnon3}">3-pentanone</option>
                 <option value="solvation_type{COSMO-SMD:pentene}">1-pentene</option>
                 <option value="solvation_type{COSMO-SMD:e2penten}">E-2-pentene</option>
                 <option value="solvation_type{COSMO-SMD:pentacet}">pentyl acetate</option>
                 <option value="solvation_type{COSMO-SMD:pentamin}">pentylamine</option>
                 <option value="solvation_type{COSMO-SMD:pfb}">perfluorobenzene</option>
                 <option value="solvation_type{COSMO-SMD:benzalcl}">phenylmethanol</option>
                 <option value="solvation_type{COSMO-SMD:propanal}">propanal</option>
                 <option value="solvation_type{COSMO-SMD:propacid}">propanoic acid</option>
                 <option value="solvation_type{COSMO-SMD:propanol}">1-propanol</option>
                 <option value="solvation_type{COSMO-SMD:propnol2}">2-propanol</option>
                 <option value="solvation_type{COSMO-SMD:propntrl}">propanonitrile</option>
                 <option value="solvation_type{COSMO-SMD:propenol}">2-propen-1-ol</option>
                 <option value="solvation_type{COSMO-SMD:propacet}">propyl acetate</option>
                 <option value="solvation_type{COSMO-SMD:propamin}">propylamine</option>
                 <option value="solvation_type{COSMO-SMD:pyridine}">pyridine</option>
                 <option value="solvation_type{COSMO-SMD:c2cl4}">tetrachloroethene</option>
                 <option value="solvation_type{COSMO-SMD:thf}">tetrahydrofuran</option>
                 <option value="solvation_type{COSMO-SMD:sulfolan}">tetrahydrothiophene-S,S-dioxide</option>
                 <option value="solvation_type{COSMO-SMD:tetralin}">tetralin</option>
                 <option value="solvation_type{COSMO-SMD:thiophen}">thiophene</option>
                 <option value="solvation_type{COSMO-SMD:phsh}">thiophenol</option>
                 <option value="solvation_type{COSMO-SMD:toluene}">toluene</option>
                 <option value="solvation_type{COSMO-SMD:tbp}">tributyl phosphate</option>
                 <option value="solvation_type{COSMO-SMD:tca111}">1,1,1-trichloroethane</option>
                 <option value="solvation_type{COSMO-SMD:tca112}">1,1,2-trichloroethane</option>
                 <option value="solvation_type{COSMO-SMD:tce}">trichloroethene</option>
                 <option value="solvation_type{COSMO-SMD:et3n}">triethylamine</option>
                 <option value="solvation_type{COSMO-SMD:tfe222}">2,2,2-trifluoroethanol</option>
                 <option value="solvation_type{COSMO-SMD:tmben124}">1,2,4-trimethylbenzene</option>
                 <option value="solvation_type{COSMO-SMD:isoctane}">2,2,4-trimethylpentane</option>
                 <option value="solvation_type{COSMO-SMD:undecane}">n-undecane</option>
                 <option value="solvation_type{COSMO-SMD:m-xylene}">m-xylene</option>
                 <option value="solvation_type{COSMO-SMD:o-xylene}">o-xylene</option>
                 <option value="solvation_type{COSMO-SMD:p-xylene}">p-xylene</option>
                 <option value="solvation_type{COSMO-SMD:xylenemx}">xylene (mixture)</option>
       </select> <br>

       <INPUT TYPE="button" VALUE="calculation_type{a}" id="neb"
              onClick="document.form.smi.value+=' calculation_type{a}'" 
              style="background-color:#f8f8ff; color:#298DB4;"> <br>

       <INPUT TYPE="button" VALUE="-->" 
              onClick="document.form.smi.value+=' --> '" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="+" 
              onClick="document.form.smi.value+=' + '" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="~" 
              onClick="document.form.smi.value+=' ~ '" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="1" 
              onClick="document.form.smi.value+='1'" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="2" 
              onClick="document.form.smi.value+='2'" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="3" 
              onClick="document.form.smi.value+='3'" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="4" 
              onClick="document.form.smi.value+='4'" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="5" 
              onClick="document.form.smi.value+='5'" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="6" 
              onClick="document.form.smi.value+='6'" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="7" 
              onClick="document.form.smi.value+='7'" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="8" 
              onClick="document.form.smi.value+='8'" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="9" 
              onClick="document.form.smi.value+='9'" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="0" 
              onClick="document.form.smi.value+='0'" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE=" " 
              onClick="document.form.smi.value+=' '" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="charge" 
              onClick="entercharge()" 
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="mult" 
              onClick="entermult()" 
              style="background-color:#f8f8ff; color:#298DB4;">
    </FORM>
    <br>

</div>






<div id="NWChem Input Editor" class="tabcontent">

    <input type="button" VALUE="JSMol to Editor &#8600;" onClick="jmoltoeditor()" style="background-color:#f8f8ff; color:#0000ff; font-size: 14px; font-weight:bold"/>
    <input type="button" VALUE="&#8598; Editor to JSMol" onClick="jmloadxyz()" style="background-color:#f8f8ff; color:#0000ff; font-size: 14px; font-weight:bold"/>
    <input type="button" VALUE="&#8599; Editor append to JSMol" onClick="jmappendxyz()" style="background-color:#f8f8ff; color:#0000ff; font-size: 14px; font-weight:bold"/>
    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
    <input type="button" VALUE="Previous input" onClick="previnput2editor();" style="background-color:#f8f8ff; color:#FF5733; font-size: 14px; font-weight:bold"/>
    <input type="button" VALUE="Next input" onClick="loadinput2editor(false);" style="background-color:#f8f8ff; color:#FF5733; font-size: 14px; font-weight:bold"/>
    <input type="button" VALUE="New input" onClick="loadinput2editor(true);" style="background-color:#f8f8ff; color:#FF5733; font-size: 14px; font-weight:bold"/>
    <b style="color:#FF5733; font-size: 14px;" id="input_label">Input 1 out of 1</b>
    <br>
    <!--div id="editor" style="position: relative; top: 85px; z-index: 1000; height: 560px; width: 1000px">some text is here </div-->
    <!--div id="editor" style="height: 560px; width: 1000px">some text is here </div-->
    <div id="editor" style="height: 560px; width: 1075px">some text is here </div>

    <script>
       var editor = ace.edit("editor");
       editor.setTheme("ace/theme/gob");
       editor.session.setMode("ace/mode/fortran");
    </script>
    
    <input type="button" VALUE="NWChem Format" onClick="convert2geometry(false)" style="background-color:#f8f8ff; color:#00000f; font-size: 14px; font-weight:bold"/>
    <input type="button" VALUE="XYZ Format" onClick="convert2XYZ()" style="background-color:#f8f8ff; color:#00000f; font-size: 14px; font-weight:bold"/>
    <input type="button" VALUE="CIF Format" onClick="convert2geometry(true)" style="background-color:#f8f8ff; color:#00000f; font-size: 14px; font-weight:bold"/>
   <input type="button" VALUE="Queue Header" onClick="prepend_header()" title="Add Header" style="background-color:#f8f8ff; color:#00000f; font-size: 14px; font-weight:bold"/>
    <input type="button" VALUE="vim" onClick="editor.setKeyboardHandler('ace/keyboard/vim');" style="background-color:#f8f8ff; color:#00000f; font-size: 14px; font-weight:bold"/>
    <input type="button" VALUE="emacs" onClick="editor.setKeyboardHandler('ace/keyboard/emacs');" style="background-color:#f8f8ff; color:#00000f; font-size: 14px; font-weight:bold"/>
    <input type="button" VALUE="ace" onClick="editor.setKeyboardHandler('');" style="background-color:#f8f8ff; color:#00000f; font-size: 14px; font-weight:bold"/>
    <!--Secret Code: <input type="text" name="Label" id="queue_secret_code"-->
    Machine: <select id="machine">
                <option value="aerosol1">aerosol1</option>
                <option value="aerosol2">aerosol2</option>
                <option value="aerosol3">aerosol3</option>
                <option value="aerosol4">aerosol4</option>
                <option value="aerosol5">aerosol5</option>
                <option value="aerosol6">aerosol6</option>
    </select>
    permdir tag: <input type="text" name="Label9" id="permdir_tag">
    <br>
    Queue Label: <input type="text" name="Label" id="queue_nwchem_label" size=45> 
    QWAIT:: <input type="text" name="Label" id="queue_wait_label">
    <input type="button" VALUE="Submit NWChem" onClick="submit_nwchemjob2()" title="Submit NWChem" style="background-color:#f8f8ff; color:#0000ff; font-size: 14px; font-weight:bold"/>
    <a href="{{ arrows_api }}queue_nwchem_check/nwchem">Check submited NWChem jobs</a>
    <br>
    <section class="marquee" style="color: red"> <b id="runmebanner3"> </b> </section>
    <section class="marquee" style="color: black"> <b id="runmebanner3b"> </b> </section>
    <br>
    <input type="button" VALUE="Save to file" onClick="editorsave()" style="background-color:#f8f8ff; color:#298DB4; font-size: 14px; font-weight:bold"/>
    <input type="button" VALUE="Load selected file" onClick="loadfiletoeditor()" style="background-color:#f8f8ff; color:#298DB4; font-size: 14px; font-weight:bold"/>
    <input type="file" id="fileToLoad" style="background-color:#f8f8ff; color:#298DB4; font-size: 14px; font-weight:bold"><br>
    <input type="button" VALUE="Load from url" onClick="loadurltoeditor()" title="Load data from url into editor" style="background-color:#f8f8ff; color:#298DB4; font-size: 14px; font-weight:bold"/>
    <input type="url" id="urlToLoad" SIZE=60  style="background-color:#f8f8ff; color:#298DB4; font-size: 14px; font-weight:bold"><br>
   <input type="button" value="example 1" onClick="document.getElementById('urlToLoad').value='https://arrows.emsl.pnnl.gov/api/eric_view/raw=we31869:/media/seagate2/Projects/EMSL-Aerosols/opt_ch3hf.nw'" style="background-color:#f8f8ff; color:#298DB4;">
   <input type="button" value="example 2" onClick="document.getElementById('urlToLoad').value='https://arrows.emsl.pnnl.gov/api/eric_view/raw=we31869:/media/seagate2/Projects/EMSL-Aerosols/sad_ch3hf.nw'" style="background-color:#f8f8ff; color:#298DB4;">
   <input type="button" value="example 3" onClick="document.getElementById('urlToLoad').value='https://arrows.emsl.pnnl.gov/api/eric_view/raw=we31869:/media/seagate2/Projects/EMSL-Aerosols/co_core.nw'" style="background-color:#f8f8ff; color:#298DB4;">
   <input type="button" value="example 4" onClick="document.getElementById('urlToLoad').value='https://arrows.emsl.pnnl.gov/api/eric_view/raw=we31869:/media/seagate2/Projects/EMSL-Aerosols/h2o-tddft.nw'" style="background-color:#f8f8ff; color:#298DB4;">

    <h4> Simulation Generation Scripts </h4>
    <table>
       <tr>
          <!--td> <input type="button" class="button4" id="bandpspw" value="PSPW calculation" onClick="changebandpspw()"/>  </td-->
          <td> <select id="bandpspw">
                <option value="PSPW calculation">PSPW calculation</option>
                <option value="PSPW4 calculation">PSPW4 calculation</option>
                <option value="DFT calculation">DFT calculation</option>
                <option value="HF calculation">HF calculation</option>
                <option value="MP2 calculation">MP2 calculation</option>
                <option value="BAND calculation">BAND calculation</option>
              </select>
          </td>
          <td> <select id="basis_type">
                <option value="default">default</option>
                <option value="def2-svp spherical">def2-svp spherical</option>
                <option value="def2-tzvp spherical">def2-tzvp spherical</option>
                <option value="6-31G* cartesian">6-31G* cartesian</option>
                <option value="6-311++G(2d,2p) cartesian">6-311++G(2d,2p) cartesian</option>
                <option value="30 Ry">30 Ry</option>
                <option value="60 Ry">60 Ry</option>
                <option value="100 Ry">100 Ry</option>
              </select>
          </td>
          <td> <select id="xc_type">
                <option value="default">default</option>
                <option value="lda">lda</option>
                <option value="pbe">pbe</option>
                <option value="pbe0">pbe0</option>
                <option value="blyp">blyp</option>
                <option value="b3lyp">b3lyp</option>
                <option value="m06-2x">m06-2x</option>
              </select>
          </td>
          <td> <input type="button" class="button4" id="latticelocation" value="Lattice in geometry block" onClick="changelatticelocation()"/>  </td>
          <td> <input type="button" class="button4" id="springconstraint" value="Add reaction constraint" onClick="addreactionconstraint()"/>  </td>
          <td> <input type="button" class="button4" id="springconstraint" value="Split NWChem calculation" onClick="nwinputsplit()"/>  </td>
       </tr>
       <tr>
          <td> <input type="button" class="button4" value="Add Energy task" onClick="addenergy()"</td>
          <td> <input type="button" class="button4" value="Add Optimization task" onClick="addoptimization(false)"</td>
          <td> <input type="button" class="button4" value="Add Frequency task" onClick="addfrequency()"</td>
          <td> <input type="button" class="button4" value="Add Saddle task" onClick="addoptimization(true)"</td>
          <td> <input type="button" class="button4" value="Add NEB task" onClick="addneb()"</td>
       </tr>
       <tr>
          <td> <input type="button" class="button4" value="Add Car-Parrinello task" onClick="addcpmd(false,'')"</td>
          <td> <input type="button" class="button4" value="Simulated Annealing" onClick="addannealing()"</td>
       </tr>
    </table>


</div>

<div id="Arrows Periodic 3D Builder" class="tabcontent">

    <!--  end of jsmol table -->
    <table> 
       <!--  start of jsmol block -->
       <tr>
          <td>
             <input type="button" VALUE="&#8599; JSMol to Editor" onClick="jmoltoeditor()" style="background-color:#f8f8ff; color:#0000ff; font-size: 14px; font-weight:bold"/>
             <input type="button" VALUE="Editor to JSMol &#8601;" onClick="jmloadxyz()" style="background-color:#f8f8ff; color:#0000ff; font-size: 14px; font-weight:bold"/>
             <input type="button" VALUE="Editor append to JSMol &#8601;" onClick="jmappendxyz()" style="background-color:#f8f8ff; color:#0000ff; font-size: 14px; font-weight:bold"/>
          </td>
       </tr> 
       <tr> 
            <td align="left" id="jsmoldiv"></td>
            <td>
               <table>
                   <tr><td align="center"> JSMol Builder Options </td> </tr>
                   <tr> <td id="jsmolbtns"></td></tr>
                   <tr>
                      <td>
                         <input type="button" value="Center atom"  onClick="jmcenteratom()"/> 
                         <input type="button" value="Origin"  onClick="jmcenterorigin()"/> 
                         <input type="button" value="Console" onClick="jms0('console;')"/> 
                         <input type="button" value="Reset pointer"  onClick="jmresetPointer()"/> 
                      </td>
                   </tr>
                   <tr>
                      <td>
                         <table>
                            <tr>
                               <td>
                                  <table align="center">
                                     <tr>
                                        <td> <input type="button" value="H " onClick="jmpickatom('H')" style="background-color:#f8f8ff; color:#606f7d; font-weight:bold"/> </td>
                                        <td> <input type="button" value="B " onClick="jmpickatom('B')" style="background-color:#f8f8ff; color:#ff6699; font-weight:bold"/> </td>
                                        <td> <input type="button" value="C " onClick="jmpickatom('C')" style="background-color:#f8f8ff; color:#000000; font-weight:bold"/> </td>
                                        <td> <input type="button" value="N " onClick="jmpickatom('N')" style="background-color:#f8f8ff; color:#1f2bd5; font-weight:bold"/> </td>
                                     </tr>
                                     <tr>
                                        <td> <input type="button" value="O " onClick="jmpickatom('O')"  style="background-color:#f8f8ff; color:#e6000d; font-weight:bold"/> </td>
                                        <td> <input type="button" value="F " onClick="jmpickatom('F')"  style="background-color:#f8f8ff; color:#7ed83d; font-weight:bold"/> </td>
                                        <td> <input type="button" value="Al" onClick="jmpickatom('Al')" style="background-color:#f8f8ff; color:#a08c8c; font-weight:bold"/> </td>
                                        <td> <input type="button" value="Si" onClick="jmpickatom('Si')" style="background-color:#f8f8ff; color:#dcaf82; font-weight:bold"/> </td>
                                     </tr>
                                     <tr>
                                        <td> <input type="button" value="P " onClick="jmpickatom('P')"  style="background-color:#f8f8ff; color:#e6640a; font-weight:bold"/> </td>
                                        <td> <input type="button" value="S " onClick="jmpickatom('S')"  style="background-color:#f8f8ff; color:#cccc00; font-weight:bold"/> </td>
                                        <td> <input type="button" value="Cl" onClick="jmpickatom('Cl')" style="background-color:#f8f8ff; color:#23c814; font-weight:bold"/> </td>
                                        <td> <input type="button" value="Br" onClick="jmpickatom('Br')" style="background-color:#f8f8ff; color:#8c191e; font-weight:bold"/> </td>
                                     </tr>
                                     <tr>
                                        <td> <input type="button" name="atomX1" id="atomX1" value="??" onClick="jmpickatom('X1')"/> </td>
                                        <td> <input type="button" name="atomX2" id="atomX2" value="??" onClick="jmpickatom('X2')"/> </td>
                                        <td> <input type="button" name="atomX3" id="atomX3" value="??" onClick="jmpickatom('X3')"/> </td>
                                        <td> <input type="button" name="atomX4" id="atomX4" value="??" onClick="jmpickatom('X4')"/> </td>
                                     </tr>
                                     <tr>
                                        <td> <input type="button" name="atomX5" id="atomX5" value="??" onClick="jmpickatom('X5')"/> </td>
                                        <td> <input type="button" name="atomX6" id="atomX6" value="??" onClick="jmpickatom('X6')"/> </td>
                                        <td> <input type="button" name="atomX7" id="atomX7" value="??" onClick="jmpickatom('X7')"/> </td>
                                        <td> <input type="button" value="Xx" onClick="jmpickatom('Xx')"/> </td>
                                     </tr>
                                     <tr>
                                        <td> <input type="button" value="Q+" onClick="jms('set picking assignAtom_pl')"</td>
                                        <td> <input type="button" value="Q-" onClick="jms('set picking assignAtom_mi')"</td>
                                        <td> <input type="button" value="e-" onClick="jmaddsmiles('SHE')"</td>
                                        <td> <input type="button" name="insertatom" id="insertatom" value="^^" onClick="jminsertatom(true)"</td>
                                     </tr>
                                  </table>
                               <td/>
                               <td>
                                  <table align="center">
                                     <tr>
                                     </tr>
                                     <tr>
                                        <td> <input type="button" class="button2" value="Move atom"  onClick="jmmoveatom()"/> </td>
                                        <td> <input type="button" class="button2" value="Move mol."  onClick="jmmovemolecule()"/> </td>
                                     </tr>
                                     <!--tr>
                                        <td> <input type="button" class="button2" value="Drag atom" onClick="jms('set picking dragMinimize')"/> </td>
                                        <td> <input type="button" class="button2" value="Docking" onClick="jms('set picking dragMinimizeMolecule')"/> </td>
                                     </tr-->
                                     <tr>
                                        <td> <input type="button" class="button2" value="Rotate bond"  onClick="jmrotatebond()"/> </td>
                                        <td> <input type="button" class="button2" value="Rotate mol."  onClick="jmrotatemolecule()"/> </td>
                                     </tr>
                                     <tr>
                                        <td> <input type="button" class="button2" value="Corr. H" onClick="jms('delete hydrogen;calculate hydrogens')"/> </td>
                                        <td> <input type="button" class="button2" value="Corr. H mol." onClick="jmhcleanmolecule()"/> </td>
                                     </tr>
                                     <tr>
                                        <td> <input type="button" class="button2" value="Opt. all" onClick="jms('select nonmetal;minimize steps 100; select *; wireframe 0.15; spacefill 23%; boundbox {*}; centerat boundbox; zoom 0; javascript echo(globalVar)')"/> </td>
                                        <td> <input type="button" class="button2" value="Opt. mol." onClick="jmminimizemolecule()"/> </td>
                                     </tr>
                                     <tr>
                                        <td> <input type="button" class="button2" value="Undo" onClick="jm_cmdlist_undo()"/> </td>
                                        <td> <input type="button" class="button2" value="Redo" onClick="jm_cmdlist_redo()"/> </td>
                                     </tr>
                                  </table>
                               </td>
                            <tr/>
                         </table>
                      </td>
                   </tr>
                   <tr>
                      <td>
                         <table>
                            <tr>
                               <td> <input type="button" class="button3" value="Add H2O" onClick="jmaddsmiles('H2O')"</td>
                               <td> <input type="button" class="button3" value="Add CH4" onClick="jmaddsmiles('CH4')"</td>
                               <td> <input type="button" class="button3" value="Add smiles" onClick="jmaddsmiles('Xx')"</td>
                            </tr>
                            <tr>
                               <td> <input type="button" class="button3" name="smilesX1" id="smilesX1" value="smiles?" onClick="jmaddsmiles('X1')"</td>
                               <td> <input type="button" class="button3" name="smilesX2" id="smilesX2" value="smiles?" onClick="jmaddsmiles('X2')"</td>
                               <td> <input type="button" class="button3" name="smilesX3" id="smilesX3" value="smiles?" onClick="jmaddsmiles('X3')"</td>
                            </tr>
                            <tr>
                               <td> <input type="button" class="button3" value="Single" onClick="jms('hover on; set picking assignBond_1; hover off')"/> </td>
                               <td> <input type="button" class="button3" value="Double" onClick="jms('hover on; set picking assignBond_2; hover off')"/> </td>
                               <td> <input type="button" class="button3" value="Triple" onClick="jms('hover on; set picking assignBond_3; hover off')"/> </td>
                            </tr>
                            <tr>
                               <td> <input type="button" class="button3" value="Delete atom" onClick="jms('set picking off; set picking on; set atomPicking true;set picking DELETEATOM')"/> </td>
                               <td> <input type="button" class="button3" value="Delete bond" onClick="jms('hover on; set picking assignBond_0; hover off')"/> </td>
                               <td> <input type="button" class="button3" value="Delete mol." onClick="jmdeletemolecule()"/> </td>
                            </tr>
                            <tr> <td> </td> </tr>
                            <tr> <td> </td> </tr>
                            <tr>
                               <td> <input type="button" class="button3" value="Length" onClick="jms0('set picking off;set picking on;set pickingstyle MEASURE; set picking MEASURE DISTANCE')"/> </td>
                               <td> <input type="button" class="button3" value="Angle" onClick="jms0('set picking off;set picking on;set pickingstyle MEASURE; set picking MEASURE ANGLE')"/> </td>
                               <td> <input type="button" class="button3" value="Torsion" onClick="jms0('set picking off;set picking on; set pickingstyle MEASURE; set picking MEASURE TORSION')"/> </td>
                            </tr>
                            <tr>
                               <td> <input type="button" class="button3" name="jmolspin" id="jmolspin" value="Spin on" onClick="jmspin()"/> </td>
                               <td> <input type="button" class="button3" name="jmolaxes" id="jmolaxes" value="Axes on" onClick="jmaxes()"/>  </td>
                               <td> <input type="button" class="button3" name="jmollabel" id="jmollabel" value="Labels on" onClick="jmlabel()"/>  </td>
                            </tr>
                            <tr>
                               <td> <input type="button" class="button3" name="jmlblcolor" id="jmlblcolor" value="Label black" onClick="jmlabelcolor()"/>  </td>
                               <td> <input type="button" class="button3" name="jmbackcolor" id="jmbackcolor" value="Bckgrnd black" onClick="jmbackground()"/>  </td>
                               <td> <input type="button" class="button3" value="Redraw" onClick="jmredrawMolecule()"/>  </td>
                            </tr>
                            <tr>
                               <td> <input type="button" class="button3" name="jmolreactionplane2" id="jmolreactionplane2" value="Reaction on" onClick="jmreactionplane()"/> </td>
                               <td> <input type="button" class="button3" name="jmolmodelkit" id="jmolmodelkit" value="ModelKit off"  onClick="jmmodelkit()"/>  </td>
                               <td> <input type="button" class="button3" value="Clean restart"  onClick="jmreset()"/>  </td>
                            </tr>
                         </table>
                         <br>
                         <input type="button" VALUE="Load esmiles" onClick="loadurltojsmol(false)" title="Load xyz data from url into jsmol"/>
                         <input type="button" VALUE="Append" onClick="loadurltojsmol(true)" title="Append xyz data from url into jsmol"/>
                         <input type="url" id="urlToLoad2" SIZE=21/>
                         <br>
                         <input type="button" VALUE="Solvate" onClick="solvateurltojsmol()" title="Load xyz data from url into jsmol"/>
                         <b style="color: blue; font-size: 14px;" id="runmebanner4b"></b>
                         <br><br>
                         <input type="button" value="Next model" onClick="loadframe2jsmol(false,false)" title="Load xyz data from url into jsmol"/>
                         <input type="button" value="New model" onClick="loadframe2jsmol(true,false)" title="Load xyz data from url into jsmol"/>
                         <br>
                         <input type="button" value="Append model" onClick="loadframe2jsmol(false,true)" title="Load xyz data from url into jsmol"/>
                         <b style="color: blue; font-size: 14px;" id="model_label">Model 1 out of 1</b>
                      </td>
                   </tr>

               </table>
            </td>
       </tr> 
       <!--  end of jsmol block -->
    </table>
    <!--  end of jsmol table -->

    <!-- crystal input -->
    <br>
    <button class="collapsible">Crystal Input</button>
    <div class="content">
    <input type="button" class="button" id="showcell"   value="Unit cell off" onClick="jmshowcell()"/>  
    <input type="button" class="button" id="centercell" value="Origin" onClick="jmscentercell()"/>  
    <input type="button" class="button" id="unitscell1" value="Scale lengths by 0.529177" onClick="jmschangecellunits(0.529177)"/>  
    <input type="button" class="button" id="unitscell2" value="Scale lengths by 1.889727" onClick="jmschangecellunits(1.88972687777)"/>  
    <input type="button" class="button" id="foldcell"   value="Fold unit cell" onClick="jmsfoldcell()"/>  
    <input type="button" class="button" id="supercell"  value="Supercell" onClick="jmssupercell()"/>  
    <br>
    <input type="button" class="button" id="promptshiftcell" value="shift cell" onClick="jmsshiftcell(prompt('Shift cell:','0.1 0.1 0.1'))"/> 
    <input type="button" class="button" id="da1shiftcell"  value="+df1" onClick="jmsshiftcell('0.1 0.0 0.0')"/>  
    <input type="button" class="button" id="da2shiftcell"  value="+df2" onClick="jmsshiftcell('0.0 0.1 0.0')"/>  
    <input type="button" class="button" id="da3shiftcell"  value="+df3" onClick="jmsshiftcell('0.0 0.0 0.1')"/>  
    <input type="button" class="button" id="dam1shiftcell" value="-df1" onClick="jmsshiftcell('-0.1  0.0  0.0')"/>  
    <input type="button" class="button" id="dam2shiftcell" value="-df2" onClick="jmsshiftcell(' 0.0 -0.1  0.0')"/> 
    <input type="button" class="button" id="dam3shiftcell" value="-df3" onClick="jmsshiftcell(' 0.0  0.0 -0.1')"/>  
    <br>
    <table>
       <tr>
          <td> Lattice Vectors </td>
          <td> Lattice Parameters </td>
          <td> Lattice Symmetry </td>
       </tr>
       <tr>
          <!-- crystal input - unit cell -->
          <td> 
              <table>
                 <tr> <td> a1: <input type="3array" id="lattice_a1"  size="35" value="10.000  0.000  0.000" onchange="jsmcellchange(0,1)"> </td> </tr>
                 <tr> <td> a2: <input type="3array" id="lattice_a2"  size="35" value=" 0.000 10.000  0.000" onchange="jsmcellchange(0,1)"> </td> </tr>
                 <tr> <td> a3: <input type="3array" id="lattice_a3"  size="35" value=" 0.000  0.000 10.000" onchange="jsmcellchange(0,1)"> </td> </tr>
                 <tr> <td> cell center: <input type="3array" id="lattice_center"  size="35" value=" 0.000 0.000 0.000" onchange="jsmcellchange(0,1)"> </td> </tr>
              </table>
          </td> 
          <td>
             <table>
                <tr>
                   <td> a: <input type="number" id="cell_a" size="9" min="0.500" max="100.000" step="0.01" value="10.000" onchange="jsmcellchange(1,1)"> </td>
                   <td> b: <input type="number" id="cell_b" size="9" min="0.500" max="100.000" step="0.01" value="10.000" onchange="jsmcellchange(1,1)"> </td>
                   <td> c: <input type="number" id="cell_c" size="9" min="0.500" max="100.000" step="0.01" value="10.000" onchange="jsmcellchange(1,1)"> </td>
                </tr>
                <tr>
                   <td> alpha: <input type="number" id="cell_alpha" size="9" min="0.000" max="180.000" step="0.01" value="90.000" onchange="jsmcellchange(1,1)"> </td>
                   <td> beta:  <input type="number" id="cell_beta"  size="9" min="0.000" max="180.000" step="0.01" value="90.000" onchange="jsmcellchange(1,1)"> </td>
                   <td> gamma: <input type="number" id="cell_gamma" size="9" min="0.000" max="180.000" step="0.01" value="90.000" onchange="jsmcellchange(1,1)"> </td>
                </tr>
             </table>
          </td>
          <td> 
             <table>
             <tr>
                 <td> symmetry: <input type="spacegroup" id="lattice_group"  size="15" value="P1" onchange="jsmcellchange(0,1)"> </td>
                 <td> setting: <input type="spacegroup" id="lattice_group_setting"  size="5" value="1" onchange="jsmcellchange(0,1)"> </td>
             </tr>
             <tr>
                <td> crystal system:
                  <select id="crystal_system">
                     <option value="Triclinic">Triclinic</option>
                     <option value="Monoclinic">Monoclinic</option>
                     <option value="Orthorhombic">Orthorhombic</option>
                     <option value="Tetragonal">Tetragonal</option>
                     <option value="Trigonal">Trigonal</option>
                     <option value="Hexagonal">Hexagonal</option>
                     <option value="Cubic">Cubic</option>
                   </select>
                </td>
                 <td> group number: <input type="spacegroup" id="lattice_group_number"  size="5" value="1" onchange="jsmcellchange(0,1)"> </td>
             </tr>
             </table>
          </td>
       </tr>
    </table>
    <br>    
    <table>
       <tr>
          <td>
             <input type="button" VALUE="Add simple bulk crystal" style="background-color:#f8f8ff;color:#0000ff" onClick="loadbulktojsmol()" title="Load xyz data from url into jsmol"/>
             name: <input type="text" id="bulk_name" SIZE=9 value="Pt"/>
             <select id="bulk_type">
                <option value="sc">Simple Cubic</option>
                <option value="fcc">Face-Centered Cubic</option>
                <option value="bcc">Body-Centered Cubic</option>
                <option value="hcp">Hexagonal Closed Packed</option>
                <option value="diamond">Diamond</option>
                <option value="zincblende">Zinc Blende</option>
                <option value="rocksalt">Rock Salt</option>
                <option value="cesiumchloride">Cesium Choride</option>
                <option value="fluorite">Fluorite</option>
                <option value="wurtzite">Wurtzite</option>
              </select>
              <br>
              a: <input type="number" id="bulk_a" size="9" min="0.500" max="30.000" step="0.01" value="4.000">
              c: <input type="number" id="bulk_c" size="9" min="0.000" max="30.000" step="0.01" value="0.000">
              u: <input type="number" id="bulk_u" size="9" min="0.000" max="30.000" step="0.01" value="0.000">
              primitive: <input type="radio" id="bulk_primitive" onClick="ClearRd(this,0)" title="Load xyz data from url into jsmol"/>
              cubic: <input type="radio" id="bulk_cubic" onClick="ClearRd(this,1)" title="Load xyz data from url into jsmol"/>
          </td>
          <td>
             <input type="button" VALUE="Generate surface" style="background-color:#f8f8ff;color:#0000ff" onClick="cutslab()" title="Load xyz data from url into jsmol"/>
             a: <input type="text" id="surface_a" SIZE=15 value="1.5 -1.5 0.0"/>
             b: <input type="text" id="surface_b" SIZE=15 value="0.0 1.5 -1.5"/>
             c: <input type="text" id="surface_c" SIZE=15 value="-1.0 -1.0 -1.0"/>
             <select id="surface_cut" onchange="defineslab()">
                <option value="sc100">SC100</option>
                <option value="sc001">SC001</option>
                <option value="sc111">SC111</option>
                <option value="fcc100">FCC100</option>
                <option value="fcc110">FCC110</option>
                <option value="fcc111" selected="selected">FCC111</option>
                <option value="fcc211">FCC211</option>
                <option value="bcc100">BCC100</option>
                <option value="bcc001">BCC001</option>
                <option value="bcc110">BCC110</option>
                <option value="bcc111">BCC111</option>
                <option value="hcp0001">hcp0001</option>
                <option value="diamond100">diamond100</option>
                <option value="diamond111">diamond111</option>
              </select>
             <br> vacuum: <input type="number" id="surface_vacuum" size="9" min="0.500" max="30.000" step="0.01" value="10.000" onchange="jsmcellchange(1,1)">
             origin: <input type="text" id="surface_origin" SIZE=15 value="0.0 0.0 0.0"/>
             scaling: <input type="text" id="surface_scaling" SIZE=15 value="1.0 1.0 1.0"/>
             tolerance: <input type="number" id="surface_tolerance" size="9" min="-3.000" max="3.000" step="0.001" value="0.0010" onchange="jsmcellchange(1,1)">
          </td>
       </tr>
    </table>
    <br>
    <table>
       <tr>
          <td> Cartesian Coordinates  </td>
          <td> Fractional Coordinates - locked: <input type="radio" id="lock_frac" onClick="ClearRd(this,2)" title="Load xyz data from url into jsmol"/> </td>
          <td> Symmetry Ops </td>
       </tr>
       <tr>
          <td> <textarea  id="cartesianCoords" rows="25" cols="40" onchange="jmsupdatecartbox()"></textarea> </td>
          <td> <textarea  id="fractionalCoords" rows="25" cols="40" onchange="jmsupdatefracbox()"></textarea> </td>
          <td> <textarea  id="symmetryops" rows="25" cols="40" onchange="jmsupdatefracbox()">+x,+y,+z</textarea></td>
       </tr>
    </table>
    </div>
    <br>
    <button class="collapsible">Polyhedra and Spin Penalty Input</button>
    <div class="content">
       <table>
          <tr> 
          <input type="button" class="button" id="redrawspin" value="Reset spin color" onClick="jms('select *; color cpk;');"/>  
          <input type="button" class="button" id="redrawpoly" value="Clear polyhedra" onClick="jms('delete $atomlist*;');"/>  
          </tr>
          <tr> 
             <td> <select id="colortype1" onchange="set_color_penalty('atomlist1','colortype1','penalty1a','penalty1b','penalty1c')">
                  <option value="translucent green" selected="selected">translucent green</option>
                  <option value="translucent yellow">translucent yellow</option>
                  <option value="translucent red">translucent red</option>
                  <option value="translucent blue">translucent blue</option>
                  <option value="translucent orange">translucent orange</option>
                  <option value="translucent grey">translucent grey</option>
                  </select>
             </td>
             <td> <select id="penalty1a">
                  <option value="up" selected="selected">up</option>
                  <option value="down">down</option>
                  <option value="polyhedra">polyhedra</option>
                  </select>
             </td>
             <td> <select id="penalty1b">
                  <option value="s">s</option>
                  <option value="p">p</option>
                  <option value="d" selected="selected">d</option>
                  <option value="f">f</option>
                  <option value="tetra">tetra</option>
                  <option value="penta">penta</option>
                  <option value="octa">octa</option>
                  <option value="other">other</option>
                  </select>
             </td>
              <td> <input type="number" id="penalty1c" size="9" min="-10.000" max="10.000" step="0.01" value="-1.00"> </td>
             <td> atoms: <input type="atomarray" id="atomlist1"  size="80" value="" onchange="set_color_penalty('atomlist1','colortype1','penalty1a','penalty1b','penalty1c')"> </td>
          </tr> 
          <tr> 
             <td> <select id="colortype2" onchange="set_color_penalty('atomlist2','colortype2','penalty2a','penalty2b','penalty2c')">
                  <option value="translucent green">translucent green</option>
                  <option value="translucent yellow" selected="selected">translucent yellow</option>
                  <option value="translucent red">translucent red</option>
                  <option value="translucent blue">translucent blue</option>
                  <option value="translucent orange">translucent orange</option>
                  <option value="translucent grey">translucent grey</option>
                  </select>
             </td>
             <td> <select id="penalty2a">
                  <option value="up">up</option>
                  <option value="down" selected="selected">down</option>
                  <option value="polyhedra">polyhedra</option>
                  </select>
             </td>
             <td> <select id="penalty2b">
                  <option value="s">s</option>
                  <option value="p">p</option>
                  <option value="d" selected="selected">d</option>
                  <option value="f">f</option>
                  <option value="tetra">tetra</option>
                  <option value="penta">penta</option>
                  <option value="octa">octa</option>
                  <option value="other">other</option>
                  </select>
             </td>
              <td> <input type="number" id="penalty2c" size="9" min="-10.000" max="10.000" step="0.01" value="-1.00"> </td>
             <td> atoms: <input type="atomarray" id="atomlist2"  size="80" value="" onchange="set_color_penalty('atomlist2','colortype2','penalty2a','penalty2b','penalty2c')"> </td>
          </tr> 
          <tr> 
             <td> <select id="colortype3" onchange="set_color_penalty('atomlist3','colortype3','penalty3a','penalty3b','penalty3c')">
                  <option value="translucent 0.3 green">translucent green</option>
                  <option value="translucent 0.3 yellow">translucent yellow</option>
                  <option value="translucent 0.3 red" selected="selected">translucent red</option>
                  <option value="translucent 0.3 blue">translucent blue</option>
                  <option value="translucent 0.3 orange">translucent orange</option>
                  <option value="translucent 0.3 grey">translucent grey</option>
                  </select>
             </td>
             <td> <select id="penalty3a">
                  <option value="up">up</option>
                  <option value="down">down</option>
                  <option value="polyhedra" selected="selected">polyhedra</option>
                  </select>
             </td>
             <td> <select id="penalty3b">
                  <option value="s">s</option>
                  <option value="p">p</option>
                  <option value="d">d</option>
                  <option value="f">f</option>
                  <option value="tetra">tetra</option>
                  <option value="penta">penta</option>
                  <option value="octa" selected="selected">octa</option>
                  <option value="other">other</option>
                  </select>
             </td>
              <td> <input type="number" id="penalty3c" size="9" min="-10.000" max="10.000" step="0.01" value="6"> </td>
             <td> atoms: <input type="atomarray" id="atomlist3"  size="80" value="" onchange="set_color_penalty('atomlist3','colortype3','penalty3a','penalty3b','penalty3c')"> </td>
          </tr> 
          <tr> 
             <td> <select id="colortype4" onchange="set_color_penalty('atomlist4','colortype4','penalty4a','penalty4b','penalty4c')">
                  <option value="translucent 0.3 green">translucent green</option>
                  <option value="translucent 0.3 yellow">translucent yellow</option>
                  <option value="translucent 0.3 red">translucent red</option>
                  <option value="translucent 0.3 blue" selected="selected">translucent blue</option>
                  <option value="translucent 0.3 orange">translucent orange</option>
                  <option value="translucent 0.3 grey">translucent grey</option>
                  </select>
             </td>
             <td> <select id="penalty4a">
                  <option value="up">up</option>
                  <option value="down">down</option>
                  <option value="polyhedra" selected="selected">polyhedra</option>
                  </select>
             </td>
             <td> <select id="penalty4b">
                  <option value="s">s</option>
                  <option value="p">p</option>
                  <option value="d">d</option>
                  <option value="f">f</option>
                  <option value="tetra">tetra</option>
                  <option value="penta">penta</option>
                  <option value="octa" selected="selected">octa</option>
                  <option value="other">other</option>
                  </select>
             </td>
              <td> <input type="number" id="penalty4c" size="9" min="-10.000" max="10.000" step="0.01" value="6"> </td>
             <td> atoms: <input type="atomarray" id="atomlist4"  size="80" value="" onchange="set_color_penalty('atomlist4','colortype4','penalty4a','penalty4b','penalty4c')"> </td>
          </tr> 
       </table>
    </div>
    <br>
    <button class="collapsible">Reaction Constraint Input</button>
    <div class="content">
    <section class="marquee" style="color: red"> <b id="runmebanner4"> </b> </section>
    <form style="font-size:14px; font-weight:bold">
       reaction_gamma{<input type="number" id="reaction_gamma" value="0.00" min="-100" max="+100">}
       <input type="button" VALUE="Update reaction gamma" onClick="check_rgamma()" title="generate reation_gamma using current geometry"/>
       <br>
       reaction_type{<select id="reaction_type">
                       <option> None </option>
                       <option>A + B --> AB</option>
                       <option>AB --> A + B</option>
                       <option>AB + C --> AC + B</option>
                       <option>AB + CD --> CABD</option>
                       <option>CABD --> AB + CD</option>
                       <option>AB + CD --> AD + BC</option>
                       <option>ABCD --> BCA + D</option>
                       <option>EA + BCD --> AB + CDE</option>
                       <option>ABC + DE --> DBE + AC</option>
                       <option>ABCD + E --> A + BC + DE</option>
                     </select>}
       reaction_indexes{<input type="text" id="reaction_indexes" SIZE=14>}
       <input type="button" VALUE="Generate reaction_hash" onClick="gen_rhash1()" title="generate reation_hash using current geometry"/>
       <br><br>
       reaction_hash text box <br>
       <textarea  name="reaction_hash" id="reaction_hash" rows="10" cols="120"></textarea>
       <br><br>
       <input type="button" VALUE="Search for reactions using reaction_hash" onClick="gen_reactions1()" title="Load xyz data from url into jsmol"/>
       <br>
       <textarea  name="reaction_hash2" id="reaction_hash2" rows="10" cols="120"></textarea>
       <br>
       <textarea  name="reaction_bondings" id="reaction_bondings" rows="2" cols="120"></textarea>
       <br>
       <input type="button" VALUE="Generate reaction_hash using chemical reaction" onClick="gen_rhash2()" title="Load xyz data from url into jsmol"/>
       <input type="text" id="reaction_genhash00" SIZE=57>
     </form>
    </div>

    <br>

</div>
<div id="Arrows Entry - 2D Builder" class="tabcontent">


   <h2>Enter an <a href="https://nwchemgit.github.io/EMSL_Arrows#introduction-to-esmiles-how-to-change-calculation-theories">esmiles</a>, <a href="https://nwchemgit.github.io/EMSL_Arrows#esmiles-reactions-how-to-calculate-reaction-energies"> esmiles reaction</a>, or other Arrows input, then push the "Run Arrows" button.</h2>
    <form action="." name="form2" target="_blank"  method="POST">
       <table>
          <tr>
             <td> <input type="text" name="smi" SIZE=120 onkeydown="if (event.keyCode == 13) Confirm(this.form)"> </td>
             <!--td> <input type="submit" name="JSME-arrows" value="Run Arrows" style="font-family: sans-serif; font-size: 20px;"></td-->
             <td> <input type="button" name="JSME-arrows" value="Run Arrows" style="font-family: sans-serif; font-size: 20px;" onClick="Confirm(this.form)"></td>
          </tr>
          <tr>
             <td> <INPUT TYPE="button" VALUE="Append SMILES from JSME Molecular Editor" onClick="appendSmiles()"> &nbsp;
                  <input type="button" class="button3" name="jmolreactionplane" id="jmolreactionplane" value="Reaction on" onClick="jmreactionplane()"/>
                  <INPUT TYPE="button" VALUE="no html5"
                          onClick="document.form2.smi.value+=' nohtml5'" >
                  <INPUT TYPE="button" VALUE="Clear" onClick="clearSmiles2()">
            </td>
             <td> <INPUT TYPE="button" VALUE="Email Submit" onClick="emailSmiles()"> </td>
          </tr>
       </table>
    </form>
    <section class="blink" style="color: red"> <b id="runmebanner2"> </b> </section>
    <br>


  <FORM METHOD="POST" ONSUBMIT="return false;">
       <INPUT TYPE="button" VALUE="theory{band}" id="dft"
              onClick="txspressed('band',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="theory{pspw}" id="pspw"
              onClick="txspressed('pspw',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="theory{pspw4}" id="pspw4"
              onClick="txspressed('pspw4',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="theory{dft}" id="dft"
              onClick="txspressed('dft',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="theory{mp2}" id="mp2"
              onClick="txspressed('mp2',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="theory{ccsd(t)}" id="ccsd(t)"
              onClick="txspressed('ccsd(t)',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="theory{pm3}" id="pm3"
              onClick="txspressed('pm3',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="basis{6-31G*}" id="6-31G*"
              onClick="txspressed('6-31G*',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="basis{6-311++G(2d,2p)}" id="6-311++G(2d,2p)"
              onClick="txspressed('6-311++G(2d,2p)',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
      <br>
       <INPUT TYPE="button" VALUE="xc{lda}" id="lda"
              onClick="txspressed('lda',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="xc{pbe}" id="pbe"
              onClick="txspressed('pbe',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="xc{pbe0}" id="pbe0"
              onClick="txspressed('pbe0',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="xc{blyp}" id="blyp"
              onClick="txspressed('blyp',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="xc{b3lyp}" id="b3lyp"
              onClick="txspressed('b3lyp',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="xc{m06-2x}" id="m06-2x"
              onClick="txspressed('m06-2x',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="solvation_type{None}" id="None"
              onClick="txspressed('None',2)"
              style="background-color:#f8f8ff; color:#298DB4;"> 
       <INPUT TYPE="button" VALUE="solvation_type{COSMO}"  id="COSMO_2"
              onClick="txspressed('COSMO',2)"
              onClick="document.form2.smi.value+=' solvation_type{COSMO}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="solvation_type{COSMO-SMD}"  id="COSMO-SMD_2"
              onClick="txspressed('COSMO-SMD',2)"
              style="background-color:#f8f8ff; color:#298DB4;">
       <select id="SMD_solvent_2" onChange="document.getElementById('COSMO-SMD_2').value = document.getElementById('SMD_solvent_2').value;" >
                 <option value="solvation_type{COSMO-SMD}">water (default)</option>
                 <option value="solvation_type{COSMO-SMD:acetacid}">acetic acid</option>
                 <option value="solvation_type{COSMO-SMD:acetone}">acetone</option>
                 <option value="solvation_type{COSMO-SMD:acetntrl}">acetonitrile</option>
                 <option value="solvation_type{COSMO-SMD:acetphen}">acetophenone</option>
                 <option value="solvation_type{COSMO-SMD:aniline}">aniline</option>
                 <option value="solvation_type{COSMO-SMD:anisole}">anisole</option>
                 <option value="solvation_type{COSMO-SMD:benzaldh}">benzaldehyde</option>
                 <option value="solvation_type{COSMO-SMD:benzene}">benzene</option>
                 <option value="solvation_type{COSMO-SMD:benzntrl}">benzonitrile</option>
                 <option value="solvation_type{COSMO-SMD:benzylcl}">benzyl chloride</option>
                 <option value="solvation_type{COSMO-SMD:brisobut}">1-bromo-2-methylpropane</option>
                 <option value="solvation_type{COSMO-SMD:brbenzen}">bromobenzene</option>
                 <option value="solvation_type{COSMO-SMD:brethane}">bromoethane</option>
                 <option value="solvation_type{COSMO-SMD:bromform}">bromoform</option>
                 <option value="solvation_type{COSMO-SMD:broctane}">1-bromooctane</option>
                 <option value="solvation_type{COSMO-SMD:brpentan}">1-bromopentane</option>
                 <option value="solvation_type{COSMO-SMD:brpropa2}">2-bromopropane</option>
                 <option value="solvation_type{COSMO-SMD:brpropan}">1-bromopropane</option>
                 <option value="solvation_type{COSMO-SMD:butanal}">butanal</option>
                 <option value="solvation_type{COSMO-SMD:butacid}">butanoic acid</option>
                 <option value="solvation_type{COSMO-SMD:butanol}">1-butanol</option>
                 <option value="solvation_type{COSMO-SMD:butanol2}">2-butanol</option>
                 <option value="solvation_type{COSMO-SMD:butanone}">butanone</option>
                 <option value="solvation_type{COSMO-SMD:butantrl}">butanonitrile</option>
                 <option value="solvation_type{COSMO-SMD:butile}">butyl acetate</option>
                 <option value="solvation_type{COSMO-SMD:nba}">butylamine</option>
                 <option value="solvation_type{COSMO-SMD:nbutbenz}">n-butylbenzene</option>
                 <option value="solvation_type{COSMO-SMD:sbutbenz}">sec-butylbenzene</option>
                 <option value="solvation_type{COSMO-SMD:tbutbenz}">tert-butylbenzene</option>
                 <option value="solvation_type{COSMO-SMD:cs2}">carbon disulfide</option>
                 <option value="solvation_type{COSMO-SMD:carbntet}">carbon tetrachloride</option>
                 <option value="solvation_type{COSMO-SMD:clbenzen}">chlorobenzene</option>
                 <option value="solvation_type{COSMO-SMD:secbutcl}">sec-butyl chloride</option>
                 <option value="solvation_type{COSMO-SMD:chcl3}">chloroform</option>
                 <option value="solvation_type{COSMO-SMD:clhexane}">1-chlorohexane</option>
                 <option value="solvation_type{COSMO-SMD:clpentan}">1-chloropentane</option>
                 <option value="solvation_type{COSMO-SMD:clpropan}">1-chloropropane</option>
                 <option value="solvation_type{COSMO-SMD:ocltolue}">o-chlorotoluene</option>
                 <option value="solvation_type{COSMO-SMD:m-cresol}">m-cresol</option>
                 <option value="solvation_type{COSMO-SMD:o-cresol}">o-cresol</option>
                 <option value="solvation_type{COSMO-SMD:cychexan}">cyclohexane</option>
                 <option value="solvation_type{COSMO-SMD:cychexon}">cyclohexanone</option>
                 <option value="solvation_type{COSMO-SMD:cycpentn}">cyclopentane</option>
                 <option value="solvation_type{COSMO-SMD:cycpntol}">cyclopentanol</option>
                 <option value="solvation_type{COSMO-SMD:cycpnton}">cyclopentanone</option>
                 <option value="solvation_type{COSMO-SMD:declncis}">cis-decalin</option>
                 <option value="solvation_type{COSMO-SMD:declntra}">trans-decalin</option>
                 <option value="solvation_type{COSMO-SMD:declnmix}">decalin (cis/trans mixture)</option>
                 <option value="solvation_type{COSMO-SMD:decane}">n-decane</option>
                 <option value="solvation_type{COSMO-SMD:decanol}">1-decanol</option>
                 <option value="solvation_type{COSMO-SMD:edb12}">1,2-dibromoethane</option>
                 <option value="solvation_type{COSMO-SMD:dibrmetn}">dibromomethane</option>
                 <option value="solvation_type{COSMO-SMD:butyleth}">dibutyl ether</option>
                 <option value="solvation_type{COSMO-SMD:odiclbnz}">o-dichlorobenzene</option>
                 <option value="solvation_type{COSMO-SMD:edc12}">1,2-dichloroethane</option>
                 <option value="solvation_type{COSMO-SMD:c12dce}">cis-dichloroethylene</option>
                 <option value="solvation_type{COSMO-SMD:t12dce}">trans-dichloroethylene</option>
                 <option value="solvation_type{COSMO-SMD:dcm}">dichloromethane</option>
                 <option value="solvation_type{COSMO-SMD:ether}">diethyl ether</option>
                 <option value="solvation_type{COSMO-SMD:et2s}">diethyl sulfide</option>
                 <option value="solvation_type{COSMO-SMD:dietamin}">diethylamine</option>
                 <option value="solvation_type{COSMO-SMD:mi}">diiodomethane</option>
                 <option value="solvation_type{COSMO-SMD:dipe}">diisopropyl ether</option>
                 <option value="solvation_type{COSMO-SMD:dmds}">dimethyl disulfide</option>
                 <option value="solvation_type{COSMO-SMD:dmso}">dimethyl sulfoxide</option>
                 <option value="solvation_type{COSMO-SMD:dma}">N,N-dimethylacetamide</option>
                 <option value="solvation_type{COSMO-SMD:cisdmchx}">cis-1,2-dimethylcyclohexane</option>
                 <option value="solvation_type{COSMO-SMD:dmf}">N,N-dimethylformamide</option>
                 <option value="solvation_type{COSMO-SMD:dmepen24}">2,4-dimethylpentane</option>
                 <option value="solvation_type{COSMO-SMD:dmepyr24}">2,4-dimethylpyridine</option>
                 <option value="solvation_type{COSMO-SMD:dmepyr26}">2,6-dimethylpyridine</option>
                 <option value="solvation_type{COSMO-SMD:dioxane}">1,4-dioxane</option>
                 <option value="solvation_type{COSMO-SMD:phoph}">diphenyl ether</option>
                 <option value="solvation_type{COSMO-SMD:dproamin}">dipropylamine</option>
                 <option value="solvation_type{COSMO-SMD:dodecan}">n-dodecane</option>
                 <option value="solvation_type{COSMO-SMD:meg}">1,2-ethanediol</option>
                 <option value="solvation_type{COSMO-SMD:etsh}">ethanethiol</option>
                 <option value="solvation_type{COSMO-SMD:ethanol}">ethanol</option>
                 <option value="solvation_type{COSMO-SMD:etoac}">ethyl acetate</option>
                 <option value="solvation_type{COSMO-SMD:etome}">ethyl formate</option>
                 <option value="solvation_type{COSMO-SMD:eb}">ethylbenzene</option>
                 <option value="solvation_type{COSMO-SMD:phenetol}">ethyl phenyl ether</option>
                 <option value="solvation_type{COSMO-SMD:c6h5f}">fluorobenzene</option>
                 <option value="solvation_type{COSMO-SMD:foctane}">1-fluorooctane</option>
                 <option value="solvation_type{COSMO-SMD:formamid}">formamide</option>
                 <option value="solvation_type{COSMO-SMD:formacid}">formic acid</option>
                 <option value="solvation_type{COSMO-SMD:heptane}">n-heptane</option>
                 <option value="solvation_type{COSMO-SMD:heptanol}">1-heptanol</option>
                 <option value="solvation_type{COSMO-SMD:heptnon2}">2-heptanone</option>
                 <option value="solvation_type{COSMO-SMD:heptnon4}">4-heptanone</option>
                 <option value="solvation_type{COSMO-SMD:hexadecn}">n-hexadecane</option>
                 <option value="solvation_type{COSMO-SMD:hexane}">n-hexane</option>
                 <option value="solvation_type{COSMO-SMD:hexnacid}">hexanoic acid</option>
                 <option value="solvation_type{COSMO-SMD:hexanol}">1-hexanol</option>
                 <option value="solvation_type{COSMO-SMD:hexanon2}">2-hexanone</option>
                 <option value="solvation_type{COSMO-SMD:hexene}">1-hexene</option>
                 <option value="solvation_type{COSMO-SMD:hexyne}">1-hexyne</option>
                 <option value="solvation_type{COSMO-SMD:c6h5i}">iodobenzene</option>
                 <option value="solvation_type{COSMO-SMD:iobutane}">1-iodobutane</option>
                 <option value="solvation_type{COSMO-SMD:c2h5i}">iodoethane</option>
                 <option value="solvation_type{COSMO-SMD:iohexdec}">1-iodohexadecane</option>
                 <option value="solvation_type{COSMO-SMD:ch3i}">iodomethane</option>
                 <option value="solvation_type{COSMO-SMD:iopentan}">1-iodopentane</option>
                 <option value="solvation_type{COSMO-SMD:iopropan}">1-iodopropane</option>
                 <option value="solvation_type{COSMO-SMD:cumene}">isopropylbenzene</option>
                 <option value="solvation_type{COSMO-SMD:p-cymene}">p-isopropyltoluene</option>
                 <option value="solvation_type{COSMO-SMD:mesityln}">mesitylene</option>
                 <option value="solvation_type{COSMO-SMD:methanol}">methanol</option>
                 <option value="solvation_type{COSMO-SMD:egme}">2-methoxyethanol</option>
                 <option value="solvation_type{COSMO-SMD:meacetat}">methyl acetate</option>
                 <option value="solvation_type{COSMO-SMD:mebnzate}">methyl benzoate</option>
                 <option value="solvation_type{COSMO-SMD:mebutate}">methyl butanoate</option>
                 <option value="solvation_type{COSMO-SMD:meformat}">methyl formate</option>
                 <option value="solvation_type{COSMO-SMD:mibk}">4-methyl-2-pentanone</option>
                 <option value="solvation_type{COSMO-SMD:mepropyl}">methyl propanoate</option>
                 <option value="solvation_type{COSMO-SMD:isobutol}">2-methyl-1-propanol</option>
                 <option value="solvation_type{COSMO-SMD:terbutol}">2-methyl-2-propanol</option>
                 <option value="solvation_type{COSMO-SMD:nmeaniln}">N-methylaniline</option>
                 <option value="solvation_type{COSMO-SMD:mecychex}">methylcyclohexane</option>
                 <option value="solvation_type{COSMO-SMD:nmfmixtr}">N-methylformamide (E/Z mixture)</option>
                 <option value="solvation_type{COSMO-SMD:isohexan}">2-methylpentane</option>
                 <option value="solvation_type{COSMO-SMD:mepyrid2}">2-methylpyridine</option>
                 <option value="solvation_type{COSMO-SMD:mepyrid3}">3-methylpyridine</option>
                 <option value="solvation_type{COSMO-SMD:mepyrid4}">4-methylpyridine</option>
                 <option value="solvation_type{COSMO-SMD:c6h5no2}">nitrobenzene</option>
                 <option value="solvation_type{COSMO-SMD:c2h5no2}">nitroethane</option>
                 <option value="solvation_type{COSMO-SMD:ch3no2}">nitromethane</option>
                 <option value="solvation_type{COSMO-SMD:ntrprop1}">1-nitropropane</option>
                 <option value="solvation_type{COSMO-SMD:ntrprop2}">2-nitropropane</option>
                 <option value="solvation_type{COSMO-SMD:ontrtolu}">o-nitrotoluene</option>
                 <option value="solvation_type{COSMO-SMD:nonane}">n-nonane</option>
                 <option value="solvation_type{COSMO-SMD:nonanol}">1-nonanol</option>
                 <option value="solvation_type{COSMO-SMD:nonanone}">5-nonanone</option>
                 <option value="solvation_type{COSMO-SMD:octane}">n-octane</option>
                 <option value="solvation_type{COSMO-SMD:octanol}">1-octanol</option>
                 <option value="solvation_type{COSMO-SMD:octanon2}">2-octanone</option>
                 <option value="solvation_type{COSMO-SMD:pentdecn}">n-pentadecane</option>
                 <option value="solvation_type{COSMO-SMD:pentanal}">pentanal</option>
                 <option value="solvation_type{COSMO-SMD:npentane}">n-pentane</option>
                 <option value="solvation_type{COSMO-SMD:pentacid}">pentanoic acid</option>
                 <option value="solvation_type{COSMO-SMD:pentanol}">1-pentanol</option>
                 <option value="solvation_type{COSMO-SMD:pentnon2}">2-pentanone</option>
                 <option value="solvation_type{COSMO-SMD:pentnon3}">3-pentanone</option>
                 <option value="solvation_type{COSMO-SMD:pentene}">1-pentene</option>
                 <option value="solvation_type{COSMO-SMD:e2penten}">E-2-pentene</option>
                 <option value="solvation_type{COSMO-SMD:pentacet}">pentyl acetate</option>
                 <option value="solvation_type{COSMO-SMD:pentamin}">pentylamine</option>
                 <option value="solvation_type{COSMO-SMD:pfb}">perfluorobenzene</option>
                 <option value="solvation_type{COSMO-SMD:benzalcl}">phenylmethanol</option>
                 <option value="solvation_type{COSMO-SMD:propanal}">propanal</option>
                 <option value="solvation_type{COSMO-SMD:propacid}">propanoic acid</option>
                 <option value="solvation_type{COSMO-SMD:propanol}">1-propanol</option>
                 <option value="solvation_type{COSMO-SMD:propnol2}">2-propanol</option>
                 <option value="solvation_type{COSMO-SMD:propntrl}">propanonitrile</option>
                 <option value="solvation_type{COSMO-SMD:propenol}">2-propen-1-ol</option>
                 <option value="solvation_type{COSMO-SMD:propacet}">propyl acetate</option>
                 <option value="solvation_type{COSMO-SMD:propamin}">propylamine</option>
                 <option value="solvation_type{COSMO-SMD:pyridine}">pyridine</option>
                 <option value="solvation_type{COSMO-SMD:c2cl4}">tetrachloroethene</option>
                 <option value="solvation_type{COSMO-SMD:thf}">tetrahydrofuran</option>
                 <option value="solvation_type{COSMO-SMD:sulfolan}">tetrahydrothiophene-S,S-dioxide</option>
                 <option value="solvation_type{COSMO-SMD:tetralin}">tetralin</option>
                 <option value="solvation_type{COSMO-SMD:thiophen}">thiophene</option>
                 <option value="solvation_type{COSMO-SMD:phsh}">thiophenol</option>
                 <option value="solvation_type{COSMO-SMD:toluene}">toluene</option>
                 <option value="solvation_type{COSMO-SMD:tbp}">tributyl phosphate</option>
                 <option value="solvation_type{COSMO-SMD:tca111}">1,1,1-trichloroethane</option>
                 <option value="solvation_type{COSMO-SMD:tca112}">1,1,2-trichloroethane</option>
                 <option value="solvation_type{COSMO-SMD:tce}">trichloroethene</option>
                 <option value="solvation_type{COSMO-SMD:et3n}">triethylamine</option>
                 <option value="solvation_type{COSMO-SMD:tfe222}">2,2,2-trifluoroethanol</option>
                 <option value="solvation_type{COSMO-SMD:tmben124}">1,2,4-trimethylbenzene</option>
                 <option value="solvation_type{COSMO-SMD:isoctane}">2,2,4-trimethylpentane</option>
                 <option value="solvation_type{COSMO-SMD:undecane}">n-undecane</option>
                 <option value="solvation_type{COSMO-SMD:m-xylene}">m-xylene</option>
                 <option value="solvation_type{COSMO-SMD:o-xylene}">o-xylene</option>
                 <option value="solvation_type{COSMO-SMD:p-xylene}">p-xylene</option>
                 <option value="solvation_type{COSMO-SMD:xylenemx}">xylene (mixture)</option>
       </select> <br>

       <INPUT TYPE="button" VALUE="-->"
              onClick="document.form2.smi.value+=' --> '"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="+"
              onClick="document.form2.smi.value+=' + '"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="~"
              onClick="document.form2.smi.value+=' ~ '"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="1"
              onClick="document.form2.smi.value+='1'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="2"
              onClick="document.form2.smi.value+='2'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="3"
              onClick="document.form2.smi.value+='3'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="4"
              onClick="document.form2.smi.value+='4'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="5"
              onClick="document.form2.smi.value+='5'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="6"
              onClick="document.form2.smi.value+='6'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="7"
              onClick="document.form2.smi.value+='7'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="8"
              onClick="document.form2.smi.value+='8'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="9"
              onClick="document.form2.smi.value+='9'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="0"
              onClick="document.form2.smi.value+='0'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE=" "
              onClick="document.form2.smi.value+=' '"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="charge"
              onClick="entercharge()"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="mult"
              onClick="entermult()"
              style="background-color:#f8f8ff; color:#298DB4;">
    </FORM>
    <br>

    <!--  start of ace-jsme table -->
    <br>
    <table>
         <tr>
            <td>
               <input type="button" VALUE="Arrows input to JSME &#8600;" onClick="esmiles2dWindow()" style="background-color:#f8f8ff; color:#de3e59; font-size: 14px; font-weight:bold"/>
               <input type="button" VALUE="JSMol to JSME &#8600;" onClick="readMolecule()" style="background-color:#f8f8ff; color:#0000ff; font-size: 14px; font-weight:bold"/>
               <input type="button" VALUE="JSMol append to JSME &#8600;" onClick="appendMolecule()" style="background-color:#f8f8ff; color:#0000ff; font-size: 14px; font-weight:bold"/>
               <input type="button" VALUE="&#8598; JSME to JSMol" onClick="jmsmiles()" style="background-color:#f8f8ff; color:#0000ff; font-size: 14px; font-weight:bold"/>
               <input type="button" VALUE="&#8598; JSME append to JSMol" onClick="jmasmiles()" style="background-color:#f8f8ff; color:#0000ff; font-size: 14px; font-weight:bold"/>
            </td>
         </tr>
         <tr>
             <!--td id="editor" style="height: 500px; width: 750px">some text is here </td-->
             <td id="appletContainer"></td>
        </tr>
    </table>
    <!--  end of ace-jsme table -->



    <font color="00008B">
    <h3>  The following are examples of input that can be used with Tiny Arrows. Clicking on a button places the command into the above entry box. </h3>
    <form method="POST" ONSUBMIT="return false;">
       <p><b> <font size="+1.5">Molecular calculations: </font> </b> &nbsp;
       <INPUT TYPE="button" VALUE="CN1C=NC2=C1C(=O)N(C(=O)N2C)C" onClick="document.form2.smi.value='CN1C=NC2=C1C(=O)N(C(=O)N2C)C'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="Pubchem=2519" onClick="document.form2.smi.value='Pubchem=2519'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="ChemSpider=2424" onClick="document.form2.smi.value='ChemSpider=2424'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="cas=58-08-2" onClick="document.form2.smi.value='cas=58-08-2'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="kegg=D00528" onClick="document.form2.smi.value='kegg=D00528'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="InChI=1S/C8H10N4O2/c1-10-4-9-6-5(10)7(13)12(3)8(14)11(6)2/h4H,1-3H3"
              onClick="document.form2.smi.value='InChI=1S/C8H10N4O2/c1-10-4-9-6-5(10)7(13)12(3)8(14)11(6)2/h4H,1-3H3'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="Caffeine" onClick="document.form2.smi.value='Caffeine'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="CHEMBL113" onClick="document.form2.smi.value='CHEMBL113'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="CN1C=NC2=C1C(=O)N(C(=O)N2C)C theory{pspw}" onClick="document.form2.smi.value='CN1C=NC2=C1C(=O)N(C(=O)N2C)C theory{pspw}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="CN1C=NC2=C1C(=O)N(C(=O)N2C)C xc{pbe}" onClick="document.form2.smi.value='CN1C=NC2=C1C(=O)N(C(=O)N2C)C xc{pbe}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="CN1C=NC2=C1C(=O)N(C(=O)N2C)C xc{m06-2x}" onClick="document.form2.smi.value='CN1C=NC2=C1C(=O)N(C(=O)N2C)C xc{m06-2x}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="CN1C=NC2=C1C(=O)N(C(=O)N2C)C theory{mp2}" onClick="document.form2.smi.value='CN1C=NC2=C1C(=O)N(C(=O)N2C)C theory{mp2}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       </p>
       <p><b><font size="+1.5">  Reaction calculations: </font> </b> &nbsp;
       <INPUT TYPE="button" VALUE="CC + hydrogen gas --> 2 methane" onClick="document.form2.smi.value='CC + hydrogen gas --> 2 methane'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="C=C + ClCl --> ClCCCl" onClick="document.form2.smi.value='C=C + ClCl --> ClCCCl'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="TNT + hydroxide --> TNT-2-OH + nitrite" onClick="document.form2.smi.value='TNT + hydroxide --> TNT-2-OH + nitrite'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="TNT + hydroxide --> TNT-2-OH + nitrite ~ xc{m06-2x}"
              onClick="document.form2.smi.value='TNT + hydroxide --> TNT-2-OH + nitrite ~ xc{m06-2x}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="TNT + hydroxide --> TNT-2-OH + nitrite ~ theory{pspw4}"
              onClick="document.form2.smi.value='TNT + hydroxide --> TNT-2-OH + nitrite ~ theory{pspw4}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="TNT + water --> TNT-2-OH + nitrous acid ~ theory{pspw}"
              onClick="document.form2.smi.value='TNT + water --> TNT-2-OH + nitrous acid ~ theory{pspw}'"
              style="background-color:#f8f8ff; color:#298DB4;">

       </p>
       <p><b> <font size="+1.5"> NMR calculations: </font> </b> &nbsp;
       <INPUT TYPE="button" VALUE="nmr for O=N(=O)c1cc(N(=O)=O)c(c(c1)N(=O)=O)C basis{6-31G*}"
              onClick="document.form2.smi.value='nmr for O=N(=O)c1cc(N(=O)=O)c(c(c1)N(=O)=O)C basis{6-31G*}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="nmr for O=N(=O)c1cc(N(=O)=O)c(c(c1)N(=O)=O)C basis{6-31G*} solvation_type{None}"
              onClick="document.form2.smi.value='nmr for O=N(=O)c1cc(N(=O)=O)c(c(c1)N(=O)=O)C basis{6-31G*} solvation_type{None}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="nmr for aspirin"
              onClick="document.form2.smi.value='nmr for aspirin'"
              style="background-color:#f8f8ff; color:#298DB4;">
       </p>
       <p><b><font size="+1.5">  Predict reactions: </font></b> &nbsp;
       <INPUT TYPE="button" VALUE="TNT + hydroxide -->"
              onClick="document.form2.smi.value='TNT + hydroxide -->'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="C=C + ClCl -->"
              onClick="document.form2.smi.value='C=C + ClCl -->'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="TNT + hydroxide --> ~ theory{pspw4}"
              onClick="document.form2.smi.value='TNT + hydroxide --> ~ theory{pspw4}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="predict for TNT + hydroxide"
              onClick="document.form2.smi.value='predict for TNT + hydroxide'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="predict for tetryl + hydroxide"
              onClick="document.form2.smi.value='predict for tetryl + hydroxide'"
              style="background-color:#f8f8ff; color:#298DB4;">
       </p>
       <p><b><font size="+1.5"> SMARTS searching: </font></b> &nbsp;
       <INPUT TYPE="button" VALUE="smarts cN(=O)=O  xc{m06-2x}"
              onClick="document.form2.smi.value='smarts cN(=O)=O  xc{m06-2x}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="smarts c1ccccc1 theory{pspw4}"
              onClick="document.form2.smi.value='smarts c1ccccc1 theory{pspw4}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="smarts [CX3H1](=O)[#6]"
              onClick="document.form2.smi.value='smarts [CX3H1](=O)[#6]'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="smarts [CX3](=[OX1])C theory{mp2}"
              onClick="document.form2.smi.value='smarts [CX3](=[OX1])C theory{mp2}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       </p>
       <p><b><font size="+1.5"> Generate NWChem input, Fetch NWChem output, Fetch XYZ and Fetch JSON: </font></b> &nbsp;
       <INPUT TYPE="button" VALUE="input deck for aspirin"
              onClick="document.form2.smi.value='input deck for aspirin'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="input deck for aspirin theory{pspw}"
              onClick="document.form2.smi.value='input deck for aspirin theory{pspw}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="input deck for aspirin theory{mp2}"
              onClick="document.form2.smi.value='input deck for aspirin theory{mp2}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="input deck for PubChem=2519 xc{pbe}"
              onClick="document.form2.smi.value='input deck for PubChem=2519 xc{pbe}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="output deck for aspirin"
              onClick="document.form2.smi.value='output deck for aspirin'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="nwoutput for aspirin theory{pspw}"
              onClick="document.form2.smi.value='nwoutput for aspirin theory{pspw}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="xyz for aspirin theory{pspw}"
              onClick="document.form2.smi.value='xyz for aspirin theory{pspw}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="json for aspirin theory{pspw}"
              onClick="document.form2.smi.value='json for aspirin theory{pspw}'"
              style="background-color:#f8f8ff; color:#298DB4;">
       </p>
        <p>
       <p><b><font size="+1.5"> Other Arrows commands: </font></b> &nbsp;
       <INPUT TYPE="button" VALUE="list all reactions"
              onClick="document.form2.smi.value='list all reactions'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="list all esmiles 100"
              onClick="document.form2.smi.value='list all esmiles 100'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="queue"
              onClick="document.form2.smi.value='queue'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="download fetch_nwchem_input"
              onClick="document.form2.smi.value='download fetch_nwchem_input'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="download upload_nwchem_outfiles"
              onClick="document.form2.smi.value='download upload_nwchem_outfiles'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="download arrows_esmiles2xyz"
              onClick="document.form2.smi.value='download arrows_esmiles2xyz'"
              style="background-color:#f8f8ff; color:#298DB4;">
       <INPUT TYPE="button" VALUE="submitesmiles for ethene theory{pspw}"
              onClick="document.form2.smi.value='submitesmiles for ethene theory{pspw}'"
              style="background-color:#f8f8ff; color:#298DB4;">
        </p>
    </form>
    </font>






</div>

<div id="SpreadSheet" class="tabcontent">

<div id="jspreadsheet"></div>


<script>

myspreadsheet = jexcel(document.getElementById('jspreadsheet'), {
    //data:data,
    search:true,
    rowResize:true,
    tableOverflow:true,
    tableHeight:'600px',
    //loadingSpin:true,
    //pagination:25,
    minDimensions: [10, 50],
    toolbar:[
        { type:'i', content:'undo', onclick:function() { myspreadsheet.undo(); } },
        { type:'i', content:'redo', onclick:function() { myspreadsheet.redo(); } },
        { type:'i', content:'download_for_offline', onclick:function () { savecsvfile(); } },
        { type:'i', content:'upload_file', onclick:function () { loadcsvfile(); } },
        { type:'i', content:'sentiment_satisfied_alt', onclick:function () { addjsmesmiles(); } },
        { type:'i', content:'3d_rotation', onclick:function () {pushesmilesjsmol();}},
        { type:'i', content:'table_chart', onclick:function () {addtable_spreadsheet();}},
        { type:'i', content:'filter_2', onclick:function () { setprecision(); } },
        { type:'select', k:'font-family', v:['Arial','Verdana'] },
        { type:'select', k:'font-size', v:['9px','10px','11px','12px','13px','14px','15px','16px','17px','18px','19px','20px'] },
        { type:'i', content:'format_align_left', k:'text-align', v:'left' },
        { type:'i', content:'format_align_center', k:'text-align', v:'center' },
        { type:'i', content:'format_align_right', k:'text-align', v:'right' },
        { type:'i', content:'format_bold', k:'font-weight', v:'bold' },
        { type:'color', content:'format_color_text', k:'color' },
        { type:'color', content:'format_color_fill', k:'background-color' },
    ], 
    columnSorting:false,
    columns: [
              {width:150},
              {width:150},
              {width:150},
              {width:150},
              {width:150},
              {width:150},
             ] ,
     updateTable:function(instance, cell, col, row, val, label, cellName) {
        // Number formating
        var v = parseFloat(label);
        var pp = hasprecision(row,col);
        if ((!isNaN(v)) && (pp>=0)) {
           cell.innerHTML = v.toFixed(pp);
        }
     }

});

function addjsmesmiles() {
   var smiles = document.JME.smiles();
   var re = /\./g;
   smiles = smiles.replace(re, " + ");
   smiles = smiles.replace(">>"," --> ");
  
   var xx = myspreadsheet.getSelectedRows(true);
   var yy = myspreadsheet.getSelectedColumns();
   var ff = myspreadsheet.getStyle();
   var data = myspreadsheet.getData();
   for (i=0; i<xx.length; ++i) {
      ii = xx[i];
      for (j=0; j<yy.length; ++j) {
         jj = yy[j];
         data[ii][jj] = smiles;
      }
   }
   myspreadsheet.setData(data);
   myspreadsheet.setStyle(ff);
}
function pushesmilesjsmol() {
   var rr,pp;
   var xx = myspreadsheet.getSelectedRows(true);
   var yy = myspreadsheet.getSelectedColumns();
   if ((xx.length>0) && (yy.length>0)) {
      var ii = xx[0];
      var jj = yy[0];
      var data = myspreadsheet.getData();
      var esmiles = data[ii][jj];
      if (esmiles.includes("-->")) {
         rr = esmiles.split("-->")[0].trim();
         pp = esmiles.split("-->")[1].trim();
         esmiles = rr + "\>\>" + pp;
         document.getElementById("jmolreactionplane").value = "Reaction on";
      } else {
         document.getElementById("jmolreactionplane").value = "Reaction off";
      }
      jmreactionplane()
      //esmiles = esmiles.split(" + ").join(".");
      var ss = esmiles.split(" + ");
      esmiles = "";
      for (var i=0; i<ss.length; ++i) {
         var tt = ss[i].trim().split(/[ ,]+/);
         if (!isNaN(parseFloat(tt[0]))) {
            for (var j=0; j<(parseInt(tt[0])); ++j) {
               esmiles += tt[1] + ".";
            }
         } else {
            esmiles += ss[i].trim() + ".";
         }
      }
      esmiles = esmiles.slice(0,esmiles.length-1);
      console.log("ESMILES=",esmiles);
      jmsmiles0(esmiles);
      alert("Uploaded " + data[ii][jj] + " to 3D Builder");
      
   }
}

function addtable_spreadsheet() {
   var xx = myspreadsheet.getSelectedRows(true);
   var yy = myspreadsheet.getSelectedColumns();
   if ((xx.length>0) && (yy.length>0)) {
      var ii = xx[0];
      var jj = yy[0];
      var tabletype = document.getElementById("tabletype").value.split(":")[0];
      var method    = document.getElementById("tabletype").value.split(":")[1];
      var theories  = document.getElementById("columntheories").value.split(":");
      var nrows     = document.getElementById("nrowstable").value.split(":");
      var ff = myspreadsheet.getStyle();
      var data = myspreadsheet.getData();
      data[ii][jj] = tabletype;
      for (var ix=0; ix<nrows; ++ix) {
        data[ii+ix+1][jj] = "esmiles or esmiles reaction";
      }
      for (var j=0; j<theories.length; ++j) {
         data[ii][jj+j+1] = theories[j].trim();
         for (var i=0; i<nrows; ++i) {
            data[ii+i+1][jj+j+1] = method;
         }
      }
      myspreadsheet.setData(data);
      myspreadsheet.setStyle(ff);
   }
}




var spreadformats = [];
var ni_spreadformats = 0;
var nj_spreadformats = 0;
function hasprecision(i,j) {
   var pp = -1;
   if ((i<window.ni_spreadformats) && (j<window.nj_spreadformats)) {
      pp = window.spreadformats[i][j];
   }
   return pp;
}

function setprecision() {
   var i,j,ii,jj,ff;
   var pp = parseInt(prompt("set precision=",2));
   var data = myspreadsheet.getData();
   var ni = data.length;
   var nj = data[0].length;
   var newdata = [];
   if ((ni!=window.ni_spreadformats) || (nj!=window.nj_spreadformats)) {
      for (i=0; i<ni; ++i) {
         var rr = [];
         for (j=0; j<nj; ++j) {
            if ((i<window.nj_spreadformats) && (j<window.nj_spreadformats)) {
               ff = window.spreadformats[i][j];
            } else {
               ff = -1;
            }
            rr.push(ff);
         }
         newdata.push(rr);
      }
      window.spreadformats = newdata;
      window.ni_spreadformats = ni;
      window.nj_spreadformats = nj;
   }

   var xx = myspreadsheet.getSelectedRows(true);
   var yy = myspreadsheet.getSelectedColumns();
   for (i=0; i<xx.length; ++i) {
      ii = xx[i];
      for (j=0; j<yy.length; ++j) {
         jj = yy[j];
         window.spreadformats[ii][jj] = pp;
      }
   }
   myspreadsheet.updateTable();
}

function loadcsvfile() {
   var data = [["Year","Performing artist(s)","Work"],
               [2006,"U2","How to Dismantle an Atomic Bomb"]];
   var fileToLoad = document.getElementById("csvToLoad").files[0];
   var fileReader = new FileReader();
   fileReader.onload = function(fileLoadedEvent) {
      var textFromFileLoaded = fileLoadedEvent.target.result;
      var ldata = textFromFileLoaded.split("\n");
      data = [];
      for (var i=0; i<ldata.length; ++i) {
         data.push(ldata[i].split(","));
      }
      myspreadsheet.setData(data);
   };
   fileReader.readAsText(fileToLoad, "UTF-8");
}

function savecsvfile() {
    myspreadsheet.download();
}

var computecells        = [];
var computecells_length = 0;
var computecells_cur    = 0;
function run_next_cell() {
   if (window.computecells_cur < window.computecells_length) {
      submit_cell(window.computecells[window.computecells_cur]);
      window.computecells_cur += 1;
   }
}

function finish_spreadsheet(cellstr,energy) {
   if (!isNaN(parseFloat(energy))) {
      //myspreadsheet.setValue('A1', energy);
      myspreadsheet.setValue(cellstr, energy);
   }
   run_next_cell();
   if (window.computecells_cur >= window.computecells_length) {
      document.getElementById('runmebanner4d').innerHTML= "";
   }
}

function submit_cell(cell) {
   var reaction_str = cell[1];
   //var arrows_get_url  = "https://arrows.emsl.pnnl.gov/api/reaction/'OC(O)C(O)OC(O)C(O)O --> OC1OC(O)C(O)OC1O + O ~ theory{pspw4} parse_output{hrxn(gas)}'";
   var arrows_get_url;
   if (reaction_str.includes("-->")) {
      reaction_str = reaction_str.replace(/#/gi,"!");
      //arrows_get_url  = "https://arrows.emsl.pnnl.gov/api/reaction/'" + reaction_str + "'";
      arrows_get_url  = "{{ arrows_api }}reaction/'" + reaction_str + "'";
   } else if (reaction_str.includes("submitesmiles")) {
      var tt = "parse_output{" + reaction_str.split("parse_output{")[1].split("}")[0] + "}";
      reaction_str = reaction_str.replace(tt,"");
      reaction_str = reaction_str.replace("submitesmiles","");
      reaction_str = reaction_str.replace("~","");
      reaction_str = reaction_str.replace(/#/gi,"!");
      //arrows_get_url  = "https://arrows.emsl.pnnl.gov/api/submitesmiles/'" + reaction_str + "'";
      arrows_get_url  = "{{ arrows_api }}submitesmiles/'" + reaction_str + "'";
   } else {
      reaction_str = reaction_str.replace("~","");
      reaction_str = reaction_str.replace(/#/gi,"!");
      //arrows_get_url  = "https://arrows.emsl.pnnl.gov/api/molecule/'" + reaction_str + "'";
      arrows_get_url  = "{{ arrows_api }}molecule/'" + reaction_str + "'";
   }
   document.getElementById('runmebanner4c').innerHTML= "Arrows calculation started for " + reaction_str + " at " + cell[0];
   console.log("Running Web API ", arrows_get_url);

   var ajax = new XMLHttpRequest();
   ajax.open('GET', arrows_get_url, true);
   ajax.onload = function (e) {
     if (ajax.readyState === 4) {
       if (ajax.status === 200) {
         var textFromUrl = ajax.responseText;
         document.getElementById('runmebanner4c').innerHTML= "Arrows Finished!";
         finish_spreadsheet(cell[0],textFromUrl);
       } else {
         console.error(ajax.statusText);
         document.getElementById('runmebanner4c').innerHTML= ajax.statusText;
       }
     }
   };
   ajax.onerror = function (e) {
      console.error(ajax.statusText);
      document.getElementById('runmebanner4c').innerHTML= ajax.statusText;
   };
   ajax.send();
}


function check_command(str) {
   var ok = false;
   if (typeof str === 'string' || str instanceof String) {
      var xstr = str.trim();
      if ( (xstr=="erxn(gas)") ||
           (xstr=="e(gas)") ||
           (xstr=="hrxn(gas)") ||
           (xstr=="h(gas)") ||
           (xstr=="grxn(gas)") ||
           (xstr=="g(gas)") ||
           (xstr=="grxn(aq)") ||
           (xstr=="g(aq)") ||
           (xstr=="solvation") ||
           (xstr=="delta_solvation") ||
           (xstr=="submitesmiles") ||
           (xstr=="homo") ||
           (xstr=="alpha_homo") ||
           (xstr=="beta_homo") ||
           (xstr=="lumo") ||
           (xstr=="alpha_lumo") ||
           (xstr=="beta_lumo") ) {
         ok = true;
      }
   }
   return ok; }

function check_float(str) {
   return (!isNaN(parseFloat(str))); // true
}

function check_not_commandorfloat(str) {
   var ok = false;
   if (isNaN(parseFloat(str))) {
      var xstr = str.trim();
      if  ((!check_command(xstr)) && (!check_float(xstr)) && (xstr.length>0)) {
         ok = true;
      }
   }
   return ok;
}

function gencellstr(i,j) {
   return String.fromCharCode(65+j) + i.toString();
}

function submit_spreadsheet() {
   var test = document.getElementById('runmebanner4d').innerHTML;
   if (!test.includes("Running Arrows")) {
      document.getElementById('runmebanner4d').innerHTML= "Running Arrows. Please be patient.";
      window.computecells = [];
      window.computecells_length = 0;
      window.computecells_cur    = 0;
      var xx = myspreadsheet.getData(false);
      for (var i=0; i<xx.length; ++i) {
         var yy = xx[i];
         for (var j=0; j<yy.length; ++j) {
            if (check_command(yy[j])) {
               var ii = i-1;
               var jj = j-1;
               var colfound = false;
               var rowfound = false;
               while ((jj>=0) && (!colfound)) {
                  if (check_not_commandorfloat(xx[i][jj])) {
                     colfound = true;
                  } else {
                     --jj;
                  }
               }
               while ((ii>=0) && (!rowfound)) {
                  if (check_not_commandorfloat(xx[ii][j])) {
                     rowfound = true;
                  } else {
                     --ii;
                  }
               }

               if (colfound && rowfound) {
                  window.computecells.push([gencellstr(i+1,j),xx[i][jj]+" ~ "+xx[ii][j]+" parse_output{"+xx[i][j].trim()+"}"]);
                  window.computecells_length += 1;
               }
            }
         }
      }
      run_next_cell();
   }
}

function savejsonfile() {
   var xx = [myspreadsheet.getData(),myspreadsheet.getStyle(),myspreadsheet.getWidth(),window.spreadformats];
   var textToSave = JSON.stringify(xx);
   var filenameguess = "arrows.json";
   var textToSaveAsBlob = new Blob([textToSave], {type:"text/plain"});
   var textToSaveAsURL  = window.URL.createObjectURL(textToSaveAsBlob);
   var fileNameToSaveAs =  prompt("Please enter filename:", filenameguess);
   var downloadLink = document.createElement("a");
   downloadLink.download = fileNameToSaveAs;
   downloadLink.innerHTML = "Download File";
   downloadLink.href = textToSaveAsURL;
   downloadLink.onclick = destroyClickedElement;
   downloadLink.style.display = "none";
   document.body.appendChild(downloadLink);
   downloadLink.click();
}

function loadjsonfile() {
   var fileToLoad = document.getElementById("csvToLoad").files[0];

   var fileReader = new FileReader();
   fileReader.onload = function(fileLoadedEvent) {
      var textFromFileLoaded = fileLoadedEvent.target.result;
      var xx = JSON.parse(textFromFileLoaded);
      window.spreadformats = xx[3];
      window.ni_spreadformats = xx[3].length;
      if (window.ni_spreadformats > 0) {
         window.nj_spreadformats = xx[3][0].length;
      } else {
         window.nj_spreadformats = 0;
      }
      myspreadsheet.setData(xx[0]);
      myspreadsheet.setStyle(xx[1]);
      for (var i=0; i<xx[2].length; ++i) {
         myspreadsheet.setWidth(i, parseInt(xx[2][i]));
      }
   };
   fileReader.readAsText(fileToLoad, "UTF-8");
}


function loadurltospread() {
   var corh = "https://cors-anywhere.herokuapp.com/";
   var url = corh + document.getElementById("urlToLoadspread").value;

   if (url.trim().length>9) {
      var ajax = new XMLHttpRequest();
      ajax.open("GET", url, false); // third parameter is async flag
      ajax.send();
      var textFromUrl = ajax.responseText;
      if (url.includes("json")) {
         var xx = JSON.parse(textFromUrl);
         window.spreadformats = xx[3];
         window.ni_spreadformats = xx[3].length;
         if (window.ni_spreadformats > 0) {
            window.nj_spreadformats = xx[3][0].length;
         } else {
            window.nj_spreadformats = 0;
         }
         myspreadsheet.setData(xx[0]);
         myspreadsheet.setStyle(xx[1]);
         for (var i=0; i<xx[2].length; ++i) {
            myspreadsheet.setWidth(i, parseInt(xx[2][i]));
         }
      } else {
         var ldata = textFromUrl.split("\n");
         var data = [];
         for (var i=0; i<ldata.length; ++i) {
            data.push(ldata[i].split(","));
         }
         myspreadsheet.setData(data);
      }
   }
}


</script>

<br>
table type: <select id="tabletype">
    <option value="Gas-Phase Energy (Hartrees):e(gas)">Gas-Phase Energy (Hartrees)</option>
    <option value="Gas-Phase Enthalpy (Hartrees):h(gas)">Gas-Phase Enthalpy (Hartrees)</option>
    <option value="Gas-Phase Free Energy (Hartrees):g(gas)">Gas-Phase Free Energy (Hartrees)</option>
    <option value="Solvation Free Energy (Hartrees):solvation">Solvation Free Energy (Hartrees)</option>
    <option value="Aqueous Free Energy (Hartrees):g(aq)">Aqueous Free Energy (Hartrees)</option>
    <option value="Gas-Phase Reaction Energy (Hartrees):erxn(gas)">Gas-Phase Reaction Energy (Hartrees)</option>
    <option value="Gas-Phase Reaction Enthalpy (Hartrees):hrxn(gas)" selected="selected">Gas-Phase Reaction Enthalpy (Hartrees)</option>
    <option value="Gas-Phase Reaction Free Energy (Hartrees):grxn(gas)">Gas-Phase Reaction Free Energy (Hartrees)</option>
    <option value="Solvation Reaction Free Energy (Hartrees):delta_solvation">Solvation Reaction Free Energy (Hartrees)</option>
    <option value="Aqueous Reaction Free Energy (Hartrees):grxn(aq)">Aqueous Reaction Free Energy (Hartrees)</option>
    <option value="Highest Occp. MO (eV):homo">HOMO Energy (eV)</option>
    <option value="Lowest Occp. MO (eV):lumo">LUMO Energy (eV)</option>
    <option value="Highest Occp. alpha MO (eV):alpha_homo">Alpha HOMO Energy (eV)</option>
    <option value="Lowest Occp. alpha MO (eV):alpha_lumo">Alpha LUMO Energy (eV)</option>
    <option value="Highest Occp. beta MO (eV):beta_homo">Beta HOMO Energy (eV)</option>
    <option value="Lowest Occp. beta MO (eV):beta_lumo">Beta LUMO Energy (eV)</option>
    <option value="SubmitEsmiles:submitesmiles">SubmitEsmiles</option>
</select>
column theories: <input type="theoryarray" id="columntheories"  size="55" value="theory{pspw4} : xc{pbe} : xc{b3lyp} : xc{m06-2x}">
number table rows: <input type="number" id="nrowstable" size="9" min="1" max="1000" step="1" value="5">
<br> <br>
<input type="button" VALUE="Submit Arrows" onClick="submit_spreadsheet()" title="Submit Arrows" style="background-color:#f8f8ff; color:#0000ff; font-size: 14px; font-weight:bold"/>
<input type="button" VALUE="Clear run" onClick="document.getElementById('runmebanner4d').innerHTML= ''" title="Clear run"/>
<b style="color: blue; font-size: 14px;" id="runmebanner4c"></b>
<br>
<b style="color: red; font-size: 14px;" id="runmebanner4d"></b>
<br>
<input type="button" VALUE="Save json file" onClick="savejsonfile()" style="background-color:#f8f8ff; color:#298DB4; font-size: 14px; font-weight:bold"/>
<input type="button" VALUE="Save to csv file" onClick="savecsvfile()" style="background-color:#f8f8ff; color:#298DB4; font-size: 14px; font-weight:bold"/>
<input type="button" VALUE="Load selected json file" onClick="loadjsonfile()" style="background-color:#f8f8ff; color:#298DB4; font-size: 14px; font-weight:bold"/>
<input type="button" VALUE="Load selected csv file" onClick="loadcsvfile()" style="background-color:#f8f8ff; color:#298DB4; font-size: 14px; font-weight:bold"/>
<input type="file" id="csvToLoad" style="background-color:#f8f8ff; color:#298DB4; font-size: 14px; font-weight:bold">
<br>
<input type="button" VALUE="Load from url" onClick="loadurltospread()" title="Load csv or json data from url into spreadsheet" style="background-color:#f8f8ff; color:#298DB4; font-size: 14px; font-weight:bold"/>
<input type="url" id="urlToLoadspread" SIZE=71  style="background-color:#f8f8ff; color:#298DB4; font-size: 14px; font-weight:bold"><br>
<br>
<input type="button" value="tutorial 1" onClick="document.getElementById('urlToLoadspread').value='https://arrows.emsl.pnnl.gov/api/eric_view/raw=we31869:/media/seagate2/Projects/EMSL-Aerosols/tutorial1.json'" style="background-color:#f8f8ff; color:#298DB4;">
<input type="button" value="tutorial 2" onClick="document.getElementById('urlToLoadspread').value='https://arrows.emsl.pnnl.gov/api/eric_view/raw=we31869:/media/seagate2/Projects/EMSL-Aerosols/tutorial2.json'" style="background-color:#f8f8ff; color:#298DB4;">
<input type="button" value="tutorial 3" onClick="document.getElementById('urlToLoadspread').value='https://arrows.emsl.pnnl.gov/api/eric_view/raw=we31869:/media/seagate2/Projects/EMSL-Aerosols/tutorial3.json'" style="background-color:#f8f8ff; color:#298DB4;">
<br>
<input type="button" value=" result 1 " onClick="document.getElementById('urlToLoadspread').value='https://arrows.emsl.pnnl.gov/api/eric_view/raw=we31869:/media/seagate2/Projects/EMSL-Aerosols/tutorial1-result.json'" style="background-color:#f8f8ff; color:#298DB4;">
<input type="button" value=" result 2 " onClick="document.getElementById('urlToLoadspread').value='https://arrows.emsl.pnnl.gov/api/eric_view/raw=we31869:/media/seagate2/Projects/EMSL-Aerosols/tutorial2-result.json'" style="background-color:#f8f8ff; color:#298DB4;">
<input type="button" value=" result 3 " onClick="document.getElementById('urlToLoadspread').value='https://arrows.emsl.pnnl.gov/api/eric_view/raw=we31869:/media/seagate2/Projects/EMSL-Aerosols/tutorial3-result.json'" style="background-color:#f8f8ff; color:#298DB4;">
<br>
<font color="443322" size="2"><p><a href="https://docs.google.com/spreadsheets/d/1FP1ahyibrMfthXuLE0exYGwHkCn1hs0pg7TrsLWet2Y/edit?usp=sharing">Kinetics example with Google Sheets</a></p></font>
</div>


<div id="Instructions" class="tabcontent">

<p> This webpage is not finished.</p>

<p> Tiny Arrows is a revolutionary approach to materials and chemical simulations that uses NWChem and chemical computational databases to make materials and chemical modeling accessible via a broad spectrum of digital communications.  With this webpage, a molecule can be entered into Tiny Arrows using either an <a href="https://nwchemgit.github.io/EMSL_Arrows#introduction-to-esmiles-how-to-change-calculation-theories">esmiles</a> string, a 2D molecular builder, a 3D molecular builder, or as a NWChem input deck.</p>

   <font color="443322" size="2"><p><a href="https://ace.c9.io">ACE: High Performance Code Editor for the Web</a></p></font>
    <font color="443322" size="2"><p><a href="http://wiki.jmol.org/index.php/JSmol">JSmol: an open-source HTML5 viewer for chemical structures in 3D</a></p></font>
    <font color="443322" size="2"><p> JSME Editor Citation: <a href="http://jcheminf.springeropen.com/articles/10.1186/1758-2946-5-24"> B. Bienfait and P. Ertl, JSME: a free molecule editor in JavaScript, J. Cheminformatics 5:24 (2013)</a> </p></font>
    <font color="443322" size="2"><p><a href="https://bossanova.uk/jspreadsheet/v4/">Jspreadsheet v4: The javascript spreadsheet</a></p></font>
    
    <table> <tr>
    <td> <font color="443322" size="2"> <p align="justify"> This software service and its documentation were developed at the Environmental Molecular Sciences Laboratory (EMSL) at Pacific Northwest National Laboratory, a multiprogram national laboratory, operated for the U.S. Department of Energy by Battelle under Contract Number DE-AC05-76RL01830. Support for this work was provided by the Department of Energy Office of Biological and Environmental Research, and Department of Defense environmental science and technology program (SERDP). THE SOFTWARE SERVICE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE SERVICE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE SERVICE. </p></font> </td>
    <td> <a href="https://dl.dropboxusercontent.com/s/chxhlvamd8ro356/ArrowsBeaker2.gif"><img src="https://dl.dropboxusercontent.com/s/chxhlvamd8ro356/ArrowsBeaker2.gif" alt="Arrows Movie"> </a> </td>
    </tr></table>
     Keywords: quantum chemistry calculations - quantum chemistry computations - quantum chemistry - molecular modeling calculations - molecular modeling computations - molecular modeling - chemical modeling - chemical reactions calculations - chemical reactions computations - chemical reactions - NWChem calculations - computational chemistry - NWChem 

<div align="right"><font color="298DB4"> Tiny Arrows API visited {{ visits }} times </font></div>

</div>



<script type="text/javascript">
function openCity(evt, cityName) {
    // Declare all variables
    var i, tabcontent, tablinks;

    // Get all elements with class="tabcontent" and hide them
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }

    // Get all elements with class="tablinks" and remove the class "active"
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }

    // Show the current tab, and add an "active" class to the button that opened the tab
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
}
document.getElementById("defaultOpen").click();
</script>

<script>
var coll = document.getElementsByClassName("collapsible");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.display === "block") {
      content.style.display = "none";
    } else {
      content.style.display = "block";
    }
  });
}
</script>


</body>
</html>
